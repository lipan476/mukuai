window.__require=function t(e,o,n){function i(c,a){if(!o[c]){if(!e[c]){var s=c.split("/");if(s=s[s.length-1],!e[s]){var l="function"==typeof __require&&__require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+c+"'")}c=s}var u=o[c]={exports:{}};e[c][0].call(u.exports,function(t){return i(e[c][1][t]||t)},u,u.exports,t,e,o,n)}return o[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<n.length;c++)i(n[c]);return i}({ADService:[function(t,e,o){"use strict";cc._RF.push(e,"1e8c3S9H5dMLbz/KDEKaFSe","ADService"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){}return t.ShowRewardedVideo=function(t){this.isAdsgramAvailable()?(console.log("[Adsgram] \u5c55\u793a\u89c6\u9891\u5e7f\u544a"),window.Adsgram.init({blockId:"10224"}).show().then(function(e){e.done&&t&&t(!0)}).catch(function(){t&&t(!1)})):t&&t(!1)},t.ShowInterstitial=function(t){this.isAdsgramAvailable()?(console.log("[Adsgram] \u5c55\u793a\u63d2\u9875\u5e7f\u544a"),window.Adsgram.init({blockId:"int-10223"}).show().then(function(e){e.done&&t&&t()}).catch(function(){t&&t()})):(console.warn("[Adsgram] \u5e7f\u544a\u672a\u52a0\u8f7d"),t&&t())},t.isAdsgramAvailable=function(){return"undefined"!=typeof window&&"object"==typeof window.Adsgram},t}();o.default=n,cc._RF.pop()},{}],AdapterCanvas:[function(t,e,o){"use strict";cc._RF.push(e,"28ec8glJwNLjLAgjJTg57Kh","AdapterCanvas");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.onLoad=function(){this.getComponent(cc.Canvas).fitHeight=!0,this.getComponent(cc.Canvas).fitWidth=!1},r([a],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],AppConfig:[function(t,e,o){"use strict";cc._RF.push(e,"e8891jQAudNgYXN+SYX5PxK","AppConfig"),Object.defineProperty(o,"__esModule",{value:!0}),o.AppConfig=void 0;var n=t("../GF/core");(function(t){var e=function(){function t(){}return t.LastGameKey=new n.gf.LocalStorageString("","a_gamekey"),t.LastNumberPuzzleLevelType=new n.gf.LocalStorageNumber(0,"a_np_level_type"),t}();t.LS=e})(o.AppConfig||(o.AppConfig={})),cc._RF.pop()},{"../GF/core":"core"}],AudioConfig:[function(t,e,o){"use strict";cc._RF.push(e,"e420c24zC5MCppxbeLYQ52T","AudioConfig"),Object.defineProperty(o,"__esModule",{value:!0}),o.HazelAudio=void 0,function(t){t.Audio={BOMB:"Base/Audio/bomb",PICK_UP:"Base/Audio/pick_up",PUT_DOWN:"Base/Audio/put_down",CLEAR_0:"Base/Audio/clear_0",LOSE:"Base/Audio/lose",CD:"Base/Audio/cd",PASS_BEST_SCORE:"Base/Audio/pass_best_score"},t.RegisterResources=function(e){e.AddAudio(t.Audio.BOMB),e.AddAudio(t.Audio.PICK_UP),e.AddAudio(t.Audio.PUT_DOWN),e.AddAudio(t.Audio.CLEAR_0)}}(o.HazelAudio||(o.HazelAudio={})),cc._RF.pop()},{}],BaseAD:[function(t,e,o){"use strict";cc._RF.push(e,"b3a77pspdRHzItV9tGzHnlm","BaseAD");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var r=t("./BaseSDK"),c=t("./BaseIAP"),a=t("../../core"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_AutoLoadInterstitial=!0,e.isRewardedVideoAvailableBV=new a.gf.BindableBoolean(!1),e.isInterstitialAvailableBV=new a.gf.BindableBoolean(!1),e.isLoadingBV=new a.gf.BindableBoolean(!1),e.m_IAP=null,e}return i(e,t),e.prototype.SetAutoLoadInterstitial=function(t){this.m_AutoLoadInterstitial=t},e.prototype.setIAP=function(t){this.m_IAP=t,this.m_IAP.on(c.default.EVENT.IAP_REMOVE_ADS,this.HandleEventRemoveADs,this)},e.prototype.IsADsRemoved=function(){return this.m_IAP.IsADsRemoved()},e.prototype.HandleEventRemoveADs=function(){console.log("\u76d1\u542c\u5230\u53bb\u5e7f\u544a >>>> \u9690\u85cf Banner"),this.ShowBanner(!1)},e}(r.default);o.default=s,cc._RF.pop()},{"../../core":"core","./BaseIAP":"BaseIAP","./BaseSDK":"BaseSDK"}],BaseChannel:[function(t,e,o){"use strict";cc._RF.push(e,"2524e/6TnpBgYhGeTHtkZa/","BaseChannel"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(t){this.m_ChannelName=null,this.m_SdkList=[],this.m_UserProxy=null,this.m_ADProxy=null,this.m_IAPProxy=null,this.m_ChannelName=t}return Object.defineProperty(t.prototype,"ChannelName",{get:function(){return this.m_ChannelName},enumerable:!1,configurable:!0}),t.prototype.AddSDK=function(t){return this.m_SdkList.push(t),t},Object.defineProperty(t.prototype,"UserProxy",{get:function(){return this.m_UserProxy},enumerable:!1,configurable:!0}),t.prototype.ProxyUser=function(t){this.m_UserProxy=t},Object.defineProperty(t.prototype,"ADProxy",{get:function(){return this.m_ADProxy},enumerable:!1,configurable:!0}),t.prototype.ProxyAD=function(t){this.m_ADProxy=t},Object.defineProperty(t.prototype,"IAPProxy",{get:function(){return this.m_IAPProxy},enumerable:!1,configurable:!0}),t.prototype.ProxyIAP=function(t){this.m_IAPProxy=t},t.prototype.OnInit=function(){this.m_SdkList.forEach(function(t){return t.OnInit()})},t.prototype.OnDestroy=function(){this.m_SdkList.forEach(function(t){return t.OnDestroy()})},t}();o.default=n,cc._RF.pop()},{}],BaseGameCenter:[function(t,e,o){"use strict";cc._RF.push(e,"975e4gUJ8dOlp5K6hy5qlDl","BaseGameCenter");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var r=t("./BaseSDK"),c=t("../../core"),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.CONST_GAME_TIME="GameTime",e.m_ls_gametime=new c.gf.LocalStorageNumber(0,"kGameCenterGameTime",255),e}return i(e,t),e.prototype.RandomSubmittime=function(){return 15+Math.floor(45*Math.random())},e.prototype.OnInit=function(){this.MakeAReport(0)},e.prototype.MakeAReport=function(t){var e=this;if(t>0){var o=this.m_ls_gametime.value+t;this.m_ls_gametime.value=o,this.ReportScore(this.CONST_GAME_TIME,o)}c.gf.SchedulerMgr.Ins.AddClock(this.RandomSubmittime(),function(t){return e.MakeAReport(t)})},e}(r.default);o.default=a,cc._RF.pop()},{"../../core":"core","./BaseSDK":"BaseSDK"}],BaseIAP:[function(t,e,o){"use strict";cc._RF.push(e,"fbee8VhNjpGo6mqLN2vihMj","BaseIAP");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var r=t("./BaseSDK"),c=t("../../core"),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.kRemoveADs="remove_ads",e.m_LSPurchasedList=new c.gf.LocalStorageObjectList("lsIAPPurchased",!0),e.m_LSRestored=new c.gf.LocalStorageBoolean(!1,"kNMLSRestored"),e}return i(e,t),e.prototype.IsADsRemoved=function(){return this.IsPurchased(this.kRemoveADs)},e.prototype.IsPurchased=function(t){return this.__IsPurchased(this.m_LSPurchasedList.value.list,t)},e.prototype.RemoveADs=function(){this.Purchase(this.kRemoveADs)},e.prototype.IsRestored=function(){return this.m_LSRestored.value},e.prototype.SaveRestore=function(){this.m_LSRestored.value=!0},e.prototype.SavePurchaseFromRestore=function(t,e){this.SavePurchase(t,e)},e.prototype.SavePurchase=function(t,e){if("non_consumable"==e.type){var o=this.m_LSPurchasedList.value;this.__IsPurchased(o.list,t)||(o.list.push({key:t,config:e}),this.m_LSPurchasedList.value=o,console.log("\u4fdd\u5b58\u8d2d\u4e70\u8bb0\u5f55 >>>> "+JSON.stringify(o))),t==this.kRemoveADs&&(console.log("\u5e7f\u64ad\u6d88\u606f\uff1a\u8d2d\u4e70\u53bb\u5e7f\u544a"),this.notify(r.default.EVENT.IAP_REMOVE_ADS))}this.notifyGlobal(r.default.EVENT.G_IAP_PURCHASED,t,e)},e.prototype.__IsPurchased=function(t,e){return t.reduce(function(t,o){return t||o.key==e},!1)},e.prototype.TestPurchaseAds=function(){this.SavePurchase(this.kRemoveADs,{type:"non_consumable",id:"id_dev_noads"})},e}(r.default);o.default=a,cc._RF.pop()},{"../../core":"core","./BaseSDK":"BaseSDK"}],BaseSDK:[function(t,e,o){"use strict";cc._RF.push(e,"d85c6C+nIFGzqTiww1AW5Ic","BaseSDK");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.OnInit=function(){},e.prototype.OnDestroy=function(){},e.EVENT={IAP_REMOVE_ADS:"EVENT_IAP_REMOVE_ADS",G_IAP_PURCHASED:"G_IAP_PURCHASED"},e}(t("../../core").gf.EventEntity);o.default=r,cc._RF.pop()},{"../../core":"core"}],BaseUIPop:[function(t,e,o){"use strict";cc._RF.push(e,"450d4NEBRxKQJIJ1sWO6zDG","BaseUIPop");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../GF/core"),a=cc._decorator,s=a.ccclass,l=a.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_Background=null,e.m_ActionNode=null,e.m_OriginActionNodePosition=null,e.m_OriginBackgroundOpacity=null,e}return i(e,t),e.prototype.EnterSpeedFactor=function(){return 1},e.prototype.EnterBackgroundSeconds=function(){return.6*this.EnterSpeedFactor()},e.prototype.EnterSeconds=function(){return.8*this.EnterSpeedFactor()},e.prototype.EnterDelaySeconds=function(){return.3*this.EnterSpeedFactor()},Object.defineProperty(e.prototype,"EnterActionSeconds",{get:function(){return this.EnterSeconds()+this.EnterDelaySeconds()},enumerable:!1,configurable:!0}),e.prototype.OnCreate=function(){this.ResizeToFullScreen(this.node),this.ResizeToFullScreen(this.m_Background),this.m_OriginActionNodePosition=this.m_ActionNode.position,this.m_OriginBackgroundOpacity=this.m_Background.opacity,this.m_Background.opacity=0},e.prototype.OnAllocate=function(){this.m_ActionNode.position=this.m_OriginActionNodePosition},e.prototype.OnEnter=function(){c.gf.action.In(this.m_Background,this.EnterBackgroundSeconds(),{opacity:this.m_OriginBackgroundOpacity}),c.gf.action.MoveWithEasing(this.m_ActionNode,!0,this.EnterSeconds(),this.m_OriginActionNodePosition,null,this.EnterDelaySeconds(),this.EnterActionType())},e.prototype.OnExit=function(){},e.prototype.ExitWithAction=function(t,e){var o=this;void 0===e&&(e=!1);var n=e?cc.v3(-this.m_OriginActionNodePosition.x,-this.m_OriginActionNodePosition.y,0):this.m_OriginActionNodePosition;c.gf.action.MoveWithEasing(this.m_ActionNode,!1,.3,n),c.gf.action.Out(this.m_Background,.3,{opacity:0},function(){o.Release(),t&&t()},.4)},r([l(cc.Node)],e.prototype,"m_Background",void 0),r([l(cc.Node)],e.prototype,"m_ActionNode",void 0),r([s],e)}(c.gf.ReusableView);o.default=u,cc._RF.pop()},{"../GF/core":"core"}],BlockPuzzle99DataConfig:[function(t,e,o){"use strict";cc._RF.push(e,"b241c1jkKNOZJ46sFfSji6f","BlockPuzzle99DataConfig"),Object.defineProperty(o,"__esModule",{value:!0}),o.BlockPuzzle99DataConfig=void 0,o.BlockPuzzle99DataConfig=[{kinds:[{width:1,height:1,tiles:[{col:0,row:0}]}]},{kinds:[{width:2,height:1,tiles:[{col:0,row:0},{col:1,row:0}]},{width:1,height:2,tiles:[{col:0,row:0},{col:0,row:1}]}]},{kinds:[{width:2,height:2,tiles:[{col:0,row:0},{col:1,row:1}]},{width:2,height:2,tiles:[{col:1,row:0},{col:0,row:1}]}]},{kinds:[{width:1,height:3,tiles:[{col:0,row:0},{col:0,row:1},{col:0,row:2}]},{width:3,height:1,tiles:[{col:0,row:0},{col:1,row:0},{col:2,row:0}]}]},{kinds:[{width:2,height:2,tiles:[{col:0,row:0},{col:1,row:0},{col:0,row:1}]},{width:2,height:2,tiles:[{col:0,row:0},{col:1,row:0},{col:1,row:1}]},{width:2,height:2,tiles:[{col:0,row:0},{col:0,row:1},{col:1,row:1}]},{width:2,height:2,tiles:[{col:1,row:0},{col:0,row:1},{col:1,row:1}]}]},{kinds:[{width:2,height:2,tiles:[{col:0,row:0},{col:1,row:0},{col:0,row:1},{col:1,row:1}]}]},{kinds:[{width:3,height:2,tiles:[{col:0,row:0},{col:1,row:0},{col:2,row:0},{col:1,row:1}]},{width:3,height:2,tiles:[{col:1,row:0},{col:0,row:1},{col:1,row:1},{col:2,row:1}]},{width:2,height:3,tiles:[{col:0,row:0},{col:0,row:1},{col:1,row:1},{col:0,row:2}]},{width:2,height:3,tiles:[{col:1,row:0},{col:0,row:1},{col:1,row:1},{col:1,row:2}]}]},{kinds:[{width:2,height:3,tiles:[{col:0,row:0},{col:1,row:0},{col:0,row:1},{col:0,row:2}]},{width:3,height:2,tiles:[{col:0,row:0},{col:1,row:0},{col:2,row:0},{col:2,row:1}]},{width:2,height:3,tiles:[{col:1,row:0},{col:1,row:1},{col:0,row:2},{col:1,row:2}]},{width:3,height:2,tiles:[{col:0,row:0},{col:0,row:1},{col:1,row:1},{col:2,row:1}]}]},{kinds:[{width:2,height:3,tiles:[{col:0,row:0},{col:1,row:0},{col:1,row:1},{col:1,row:2}]},{width:3,height:2,tiles:[{col:2,row:0},{col:0,row:1},{col:1,row:1},{col:2,row:1}]},{width:2,height:3,tiles:[{col:0,row:0},{col:0,row:1},{col:0,row:2},{col:1,row:2}]},{width:3,height:2,tiles:[{col:0,row:0},{col:1,row:0},{col:2,row:0},{col:0,row:1}]}]},{kinds:[{width:1,height:4,tiles:[{col:0,row:0},{col:0,row:1},{col:0,row:2},{col:0,row:3}]},{width:4,height:1,tiles:[{col:0,row:0},{col:1,row:0},{col:2,row:0},{col:3,row:0}]}]},{kinds:[{width:2,height:3,tiles:[{col:1,row:0},{col:0,row:1},{col:1,row:1},{col:0,row:2}]},{width:3,height:2,tiles:[{col:0,row:0},{col:1,row:0},{col:1,row:1},{col:2,row:1}]}]},{kinds:[{width:2,height:3,tiles:[{col:0,row:0},{col:0,row:1},{col:1,row:1},{col:1,row:2}]},{width:3,height:2,tiles:[{col:1,row:0},{col:2,row:0},{col:0,row:1},{col:1,row:1}]}]},{kinds:[{width:3,height:3,tiles:[{col:0,row:0},{col:1,row:0},{col:2,row:0},{col:0,row:1},{col:0,row:2}]},{width:3,height:3,tiles:[{col:0,row:0},{col:1,row:0},{col:2,row:0},{col:2,row:1},{col:2,row:2}]},{width:3,height:3,tiles:[{col:2,row:0},{col:2,row:1},{col:0,row:2},{col:1,row:2},{col:2,row:2}]},{width:3,height:3,tiles:[{col:0,row:0},{col:0,row:1},{col:0,row:2},{col:1,row:2},{col:2,row:2}]}]},{kinds:[{width:2,height:3,tiles:[{col:0,row:0},{col:1,row:0},{col:0,row:1},{col:0,row:2},{col:1,row:2}]},{width:3,height:2,tiles:[{col:0,row:0},{col:1,row:0},{col:2,row:0},{col:0,row:1},{col:2,row:1}]},{width:2,height:3,tiles:[{col:0,row:0},{col:1,row:0},{col:1,row:1},{col:0,row:2},{col:1,row:2}]},{width:3,height:2,tiles:[{col:0,row:0},{col:2,row:0},{col:0,row:1},{col:1,row:1},{col:2,row:1}]}]}],cc._RF.pop()},{}],BlockPuzzle99Scene:[function(t,e,o){"use strict";cc._RF.push(e,"6677f/A3DRMqZIZULz066X/","BlockPuzzle99Scene");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../GF/ADService"),a=t("../../GF/core"),s=t("../Base/AudioConfig"),l=t("../Base/GameSceneConfig"),u=t("../Base/PrefabConfig"),p=t("../Base/UI/UIRate"),h=t("../_Service/UIService"),f=t("./BlockPuzzle99"),d=t("./UI/UIBP99BoardManager"),_=t("./UI/UIBP99Continue"),m=t("./UI/UIBP99DockManager"),y=t("./UI/UIBP99GameOver"),S=t("./UI/UIBP99Goal"),v=t("./UI/UIBP99Win"),g=t("../_Service/GameCenterRankService"),b=t("../../GF/SDK/SDKMgr"),P=cc._decorator,w=P.ccclass,O=P.property,k=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dockManager=null,e.boardManager=null,e.m_ScoreLabel=null,e.m_StarLabel=null,e.m_StarSpriteNode=null,e.m_Game=null,e.m_StarBV=new a.gf.BindableNumber(0),e}return i(e,t),e.prototype.OnGameEvent=function(t,e,o){var n=this;switch(t){case f.BlockPuzzle99.GameEvent.Start:this.ShowUIGoal(this.m_Game.goal.Stars,function(){n.__SyncStarValue(),n.bindCallback(n.m_Game.score,function(t){return n.m_ScoreLabel.string=""+t},!0),n.boardManager.HandleStartEvent(e,n),n.dockManager.HandleStartEvent(e)});break;case f.BlockPuzzle99.GameEvent.Quit:this.boardManager.HandleQuitEvent(),this.dockManager.HandleQuitEvent();break;case f.BlockPuzzle99.GameEvent.Lose:c.default.ShowInterstitial(function(){n.ShowUIContinue()});break;case f.BlockPuzzle99.GameEvent.PreLose:this.dockManager.HandlePreLoseEvent();break;case f.BlockPuzzle99.GameEvent.Win:break;case f.BlockPuzzle99.GameEvent.CREATE_NEW_BLOCKS:this.dockManager.HandleCreateNewBlocksEvent();break;case f.BlockPuzzle99.GameEvent.DOCK_STATUS_UPDATED:this.dockManager.HandleDockStatusUpdatedEvent();break;case f.BlockPuzzle99.GameEvent.SCORE_CHANGED:this.HandleScoreChangedEvent(o)}},e.prototype.OnHomeButtonClick=function(){a.gf.audio.playDefaultEffect(),this.GoHome()},e.prototype.OnPauseButtonClick=function(){a.gf.audio.playDefaultEffect(),this.PauseGame()},e.prototype.__SyncStarValue=function(){this.m_StarBV.value=this.m_Game.remainStars.value},e.prototype.start=function(){var t=this;this.m_Game=f.BlockPuzzle99.Game.ReadOrCreate(),this.m_Game.BindListener(this),this.m_ScoreLabel.string="0",this.bindCallback(this.m_StarBV,function(e){return t.m_StarLabel.string=""+e},!0),this.m_Game.Start(),g.default.StartRecordGameTimeForGame(this,g.default.C_BLOCK_PUZZLE99_GAME_TIME),b.default.Ins.Channel.ADProxy.ShowBanner(!0)},e.prototype.onDestroy=function(){this.m_Game.UnbindListener(this),t.prototype.onDestroy.call(this)},e.prototype.HandleScoreChangedEvent=function(t){console.log("newScore >> "+t)},e.prototype.GoHome=function(){this.RecordScore(),this.m_Game.SaveToLS(),this.m_Game.Quit(),a.gf.Scene.loadScene("MenuScene")},e.prototype.ContinueOnWin=function(){var t=this;this.dockManager.RemoveAllBlocks(),this.boardManager.RemoveAllTilesWithAction(),this.m_Game.ContinueOnWin(),this.ShowUIGoal(this.m_Game.goal.Stars,function(){t.__SyncStarValue(),t.boardManager.CreateUITiles(),t.m_Game.UpdateDockStatus(),t.m_Game.SaveToLS()})},e.prototype.RestartGame=function(){var t=this;this.dockManager.RemoveAllBlocks(),this.boardManager.RemoveAllTilesWithAction(),this.m_Game.Restart(),this.ShowUIGoal(this.m_Game.goal.Stars,function(){t.__SyncStarValue(),t.boardManager.CreateUITiles(),t.m_Game.UpdateDockStatus(),t.m_Game.SaveToLS()})},e.prototype.NewGameOnLose=function(){var t=this;this.dockManager.RemoveAllBlocks(),this.boardManager.RemoveAllTilesWithAction(),this.m_Game.NewGameOnLose(),this.ShowUIGoal(this.m_Game.goal.Stars,function(){t.__SyncStarValue(),t.boardManager.CreateUITiles(),t.m_Game.UpdateDockStatus(),t.m_Game.SaveToLS()})},e.prototype.PauseGame=function(){var t=this;h.default.OpenUIPause(l.default.Name.BlockPuzzle99,function(){return t.RestartGame()})},e.prototype.ShowUIContinue=function(){var t=this;this.notifyGlobalShowUI(f.BlockPuzzle99.Prefabs.UIBP99Continue,new _.UIBP99ContinueModel(this.m_Game,function(e){e?t.Continue():t.GameOver()},function(){return t.GameOver()}))},e.prototype.Continue=function(){this.boardManager.Continue()},e.prototype.GameOver=function(){var t=this;this.RecordScore(),c.default.ShowInterstitial(function(){t.ShowUIGameOver()})},e.prototype.RecordScore=function(){this.m_Game.RecordScore()},e.prototype.ShowUIGameOver=function(){var t=this;a.gf.audio.playEffect(s.HazelAudio.Audio.LOSE);var e=this.m_Game.remainStars.value;this.notifyGlobalShowUI(f.BlockPuzzle99.Prefabs.UIBP99GameOver,new y.UIBP99GameOverModel(this.m_Game,e,function(){return t.RestartGame()},function(){return t.NewGameOnLose()}))},e.prototype.ShowUIGoal=function(t,e){this.notifyGlobalShowUI(f.BlockPuzzle99.Prefabs.UIBP99Goal,new S.UIBP99GoalModel(t,e))},e.prototype.ShowUIWin=function(){var t=this,e=f.BlockPuzzle99.LS.SummaryStars.value,o=this.m_Game.score.value;this.notifyGlobalShowUI(f.BlockPuzzle99.Prefabs.UIBP99Win,new v.UIBP99WinModel(e,o,function(){return t.RestartGame()},function(){return t.ContinueOnWin()}))},e.prototype.ShowUIRate=function(){var t=this;this.notifyGlobalShowUI(u.HazelPrefab.Prefab.UIRate,new p.UIRateModel(function(){return t.RestartGame()},null))},e.prototype.PlayStarEffect=function(t){var e=this,o=this.m_StarSpriteNode.convertToWorldSpaceAR(cc.Vec3.ZERO),n=t.parent.convertToNodeSpaceAR(o),i=30+20*Math.random(),r=.4+.4*Math.random();cc.tween(t).by(r,{scale:1.5,y:-i},{easing:cc.easing.elasticOut}).to(.3,{scale:1,position:n},{easing:cc.easing.backIn}).call(function(){e.__RunStarArrivedEffect()}).removeSelf().start()},e.prototype.__RunStarArrivedEffect=function(){var t=this;cc.tween(this.m_StarSpriteNode).to(.1,{scale:1.3},{easing:cc.easing.backIn}).to(.1,{scale:1},{easing:cc.easing.backOut}).call(function(){--t.m_StarBV.value,0==t.m_StarBV.value&&c.default.ShowInterstitial(function(){t.ShowUIWin()})}).start()},e.__register__=void a.gf.Scene.registerScene("BlockPuzzle99Scene",function(t){s.HazelAudio.RegisterResources(t),t.AddView(f.BlockPuzzle99.Prefabs.UIBP99ShadowTile),t.AddView(f.BlockPuzzle99.Prefabs.UIBP99TipTile),t.AddView(f.BlockPuzzle99.Prefabs.UIBP99DockItem),t.AddView(f.BlockPuzzle99.Prefabs.UIBP99Block),t.AddView(f.BlockPuzzle99.Prefabs.UIBP99DockTile),t.AddView(f.BlockPuzzle99.Prefabs.UIBP99BoardTile),t.AddView(f.BlockPuzzle99.Prefabs.UIBP99LoseTile),t.AddView(f.BlockPuzzle99.Prefabs.UIBP99ScoreEffect)}),r([O(m.default)],e.prototype,"dockManager",void 0),r([O(d.default)],e.prototype,"boardManager",void 0),r([O(cc.Label)],e.prototype,"m_ScoreLabel",void 0),r([O(cc.Label)],e.prototype,"m_StarLabel",void 0),r([O(cc.Node)],e.prototype,"m_StarSpriteNode",void 0),r([a.gf.decorator.BlockInput(.3)],e.prototype,"OnHomeButtonClick",null),r([a.gf.decorator.BlockInput(.3)],e.prototype,"OnPauseButtonClick",null),r([w],e)}(a.gf.Scene);o.default=k,cc._RF.pop()},{"../../GF/ADService":"ADService","../../GF/SDK/SDKMgr":"SDKMgr","../../GF/core":"core","../Base/AudioConfig":"AudioConfig","../Base/GameSceneConfig":"GameSceneConfig","../Base/PrefabConfig":"PrefabConfig","../Base/UI/UIRate":"UIRate","../_Service/GameCenterRankService":"GameCenterRankService","../_Service/UIService":"UIService","./BlockPuzzle99":"BlockPuzzle99","./UI/UIBP99BoardManager":"UIBP99BoardManager","./UI/UIBP99Continue":"UIBP99Continue","./UI/UIBP99DockManager":"UIBP99DockManager","./UI/UIBP99GameOver":"UIBP99GameOver","./UI/UIBP99Goal":"UIBP99Goal","./UI/UIBP99Win":"UIBP99Win"}],BlockPuzzle99:[function(t,e,o){"use strict";cc._RF.push(e,"1b8c3BF2+VBg7IYb6GEWB4D","BlockPuzzle99");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__spreadArrays||function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<o;e++)for(var r=arguments[e],c=0,a=r.length;c<a;c++,i++)n[i]=r[c];return n};Object.defineProperty(o,"__esModule",{value:!0}),o.BlockPuzzle99=void 0;var c=t("../../GF/core"),a=t("../../GF/StateMachine"),s=t("../../GF/ADService"),l=t("./BlockPuzzle99DataConfig"),u=t("../Base/AudioConfig"),p=t("../_Service/GameCenterRankService");(function(t){var e,o=function(){function t(){}return t.BestScore=new c.gf.LocalStorageNumber(0,"bp99_BestScore",0),t.SummaryStars=new c.gf.LocalStorageNumber(0,"bp99_SummaryStar",0),t}();t.LS=o,t.Prefabs={UIBP99DockItem:"BlockPuzzle99/Prefab/UIBP99DockItem",UIBP99Block:"BlockPuzzle99/Prefab/UIBP99Block",UIBP99DockTile:"BlockPuzzle99/Prefab/UIBP99DockTile",UIBP99BoardTile:"BlockPuzzle99/Prefab/UIBP99BoardTile",UIBP99ShadowTile:"BlockPuzzle99/Prefab/UIBP99ShadowTile",UIBP99TipTile:"BlockPuzzle99/Prefab/UIBP99TipTile",UIBP99ScoreEffect:"BlockPuzzle99/Prefab/UIBP99ScoreEffect",UIBP99Goal:"BlockPuzzle99/Prefab/UIBP99Goal",UIBP99Win:"BlockPuzzle99/Prefab/UIBP99Win",UIBP99Continue:"BlockPuzzle99/Prefab/UIBP99Continue",UIBP99GameOver:"BlockPuzzle99/Prefab/UIBP99GameOver",UIBP99LoseTile:"BlockPuzzle99/Prefab/UIBP99LoseTile"},t.Config={COL:9,ROW:9,DockCount:3,TILE_WIDTH:66.1,TILE_HEIGHT:66.2,DOCK_TILE_WIDTH:36,DOCK_TILE_HEIGHT:36,DRAG_PADDING:4,DRAG_SCALE:1,EFFECT_POWER:3e3},function(t){t[t.Normal=0]="Normal",t[t.Star=1]="Star"}(e=t.EBoardTileType||(t.EBoardTileType={}));var n=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.col=t,this.row=e};t.Tile=n;var h=function(){function t(t,e){this.blockData=t,this.cnfBlockData=e,this.canEmbedded=!1}return t.Copy=function(e){var o={width:e.width,height:e.height,tiles:[]};return e.tiles.forEach(function(t){return o.tiles.push(f.Copy(t))}),new t(o,e)},t}();t.Block=h;var f=function(t){function e(e,o,n){void 0===n&&(n=null);var i=t.call(this,e,o)||this;return i.ui=n,i}return i(e,t),e.Copy=function(t){return new e(t.col,t.row)},e}(n);t.DockTile=f;var d=function(){function t(t,e){this.game=t,this.index=e,this.ui=null,this.block=null}return t.prototype.RemoveBlockDate=function(){delete this.block},t.prototype.BombBlock=function(){c.gf.audio.playEffect(u.HazelAudio.Audio.BOMB),this.ui.RemoveBlock(),this.block=h.Copy(l.BlockPuzzle99DataConfig[0].kinds[0]),this.game.RefreshBlockStatus(),this.ui.CreateNewBlock(!1)},t}();t.Dock=d;var _=function(t){function o(o,n,i){var r=t.call(this,o,n)||this;return r.typ=e.Normal,r.clearCount=0,r.dockTile=null,r.ui=null,r.typ=i,r}return i(o,t),o}(n);t.BoardTile=_;var m=function(t,e,o){this.boardTile=t,this.isEmbeddedTile=e,this.centerTile=o};t.BoardClearTile=m;var y=function(){function t(){this.clearTiles=null,this.reduceTiles=null,this.clearRows=0,this.clearCols=0,this.clearGrids=0,this.embeddedTileCount=0,this.m_Score=0,this.clearTiles=c.gf.stl.DLink.Allocate(),this.reduceTiles=c.gf.stl.DLink.Allocate()}return Object.defineProperty(t.prototype,"Score",{get:function(){return this.m_Score},enumerable:!1,configurable:!0}),t.prototype.release=function(){this.clearTiles&&(this.clearTiles.release(),this.clearTiles=null),this.reduceTiles&&(this.reduceTiles.release(),this.reduceTiles=null)},t.prototype.UpdateScore=function(t){var e=0;e+=1*this.embeddedTileCount,this.clearRows+this.clearCols+this.clearGrids>0&&(e+=10*(2*(this.clearRows+this.clearCols+this.clearGrids)-1)),t>0&&(e+=20*t),this.m_Score=e},t}();t.EmbeddedInfo=y;t.TipInfo=function(){this.block=null,this.col=0,this.row=0};var S=function(t,e){this.Stars=t,this.Count=e};t.Goal=S;var v=function(){function o(e){this.tiles=null,this._col_links=[],this._row_links=[],this._grid_links=[],this.game=e,this.tiles=c.gf.stl.DLink.Allocate();for(var o=0;o<t.Config.COL;++o)this._col_links.push(c.gf.stl.DLink.Allocate());for(var n=0;n<t.Config.ROW;++n)this._row_links.push(c.gf.stl.DLink.Allocate());for(var i=0;i<9;++i)this._grid_links.push(c.gf.stl.DLink.Allocate())}return o.prototype.cr2grid=function(t,e){return Math.floor(t/3)+3*Math.floor(e/3)},o.prototype.InitWithGoal=function(t){this.CreateTilesForGoal(t)},o.prototype.InitWithSnapData=function(t){var o=this;t.tiles.forEach(function(t){t.typ==e.Star?o.CreateStarBoardTile(t.col,t.row,t.clearCount):o.CreateBoardTile(t.col,t.row)})},o.prototype.release=function(){for(;this._grid_links.length>0;)this._grid_links.pop().release();for(;this._row_links.length>0;)this._row_links.pop().release();for(;this._col_links.length>0;)this._col_links.pop().release();this.tiles.release(function(t){return t.ui.Release()})},o.prototype.CreateTilesForGoal=function(e){console.log("CreateTilesForGoal...................");for(var o=[],n=0;n<e.Stars;++n)o.push(1);for(var i=0;i<e.Count-e.Stars;++i){var r=Math.floor(Math.random()*e.Stars);o[r]=o[r]+1}for(i=0;i<e.Stars;++i)for(;;){var c=Math.floor(Math.random()*t.Config.COL),a=Math.floor(Math.random()*t.Config.ROW);if(!this.IsTile(c,a)){this.CreateStarBoardTile(c,a,o[i]);break}}},o.prototype.__addBoardTile=function(t){this.tiles.push(t),this._col_links[t.col].enqueue(t),this._row_links[t.row].enqueue(t),this._grid_links[this.cr2grid(t.col,t.row)].enqueue(t)},o.prototype.CreateBoardTile=function(t,o){var n=new _(t,o,e.Normal);return this.__addBoardTile(n),n},o.prototype.CreateStarBoardTile=function(t,o,n){var i=new _(t,o,e.Star);return i.clearCount=n,this.__addBoardTile(i),i},o.prototype.ClearBoardAfterWatchAD=function(o){for(var n=this,i=0;i<3;++i){var r=t.Config.ROW-1-i;this._row_links[r].removeByFind(function(t){return t.typ===e.Normal},function(t){n._grid_links[n.cr2grid(t.col,t.row)].removeElement(t),n._col_links[t.col].removeElement(t),n.tiles.removeElement(t),o.enqueue(new m(t,!0,t))})}},o.prototype.RemoveAllTiles=function(t){var e=this;this.tiles.removeAll(function(o){e._grid_links[e.cr2grid(o.col,o.row)].removeElement(o),e._col_links[o.col].removeElement(o),e._row_links[o.row].removeElement(o),t.enqueue(new m(o,!0,o))})},o.prototype.OnEmbedded=function(o,n){for(var i=this,r=c.gf.stl.DLink.Allocate(),a=0,s=0,l=0,u=c.gf.stl.DLink.Allocate(),p=0;p<9;++p)9===this._grid_links[p].size()&&(u.push(p),++a);o.For(function(c){var a=i._col_links[c.col];a.size()===t.Config.ROW-s&&(++l,a.removeAll(function(t){if(i._grid_links[i.cr2grid(t.col,t.row)].removeElement(t),i._row_links[t.row].removeElement(t),i.tiles.removeElement(t),t.typ===e.Star)if(--t.clearCount,t.clearCount>0)r.enqueue(t),n.reduceTiles.enqueue(t);else{var a=null!=o.findAnyElement(function(e){return e.row===t.row&&e.col===t.col});n.clearTiles.enqueue(new m(t,a,c))}else a=null!=o.findAnyElement(function(e){return e.row===t.row&&e.col===t.col}),n.clearTiles.enqueue(new m(t,a,c))}));var u=i._row_links[c.row];u.size()===t.Config.COL-l&&(++s,u.removeAll(function(t){if(i._grid_links[i.cr2grid(t.col,t.row)].removeElement(t),i._col_links[t.col].removeElement(t),i.tiles.removeElement(t),t.typ===e.Star)if(--t.clearCount,t.clearCount>0)r.enqueue(t),n.reduceTiles.enqueue(t);else{var a=null!=o.findAnyElement(function(e){return e.row===t.row&&e.col===t.col});n.clearTiles.enqueue(new m(t,a,c))}else a=null!=o.findAnyElement(function(e){return e.row===t.row&&e.col===t.col}),n.clearTiles.enqueue(new m(t,a,c))}))}),u.release(function(t){i._grid_links[t].removeAll(function(t){i._row_links[t.row].removeElement(t),i._col_links[t.col].removeElement(t),i.tiles.removeElement(t),t.typ===e.Star?(--t.clearCount,t.clearCount>0?(r.enqueue(t),n.reduceTiles.enqueue(t)):n.clearTiles.enqueue(new m(t,!1,t))):n.clearTiles.enqueue(new m(t,!1,t))})}),r.release(function(t){return i.__addBoardTile(t)}),n.clearRows=s,n.clearCols=l,n.clearGrids=a,n.embeddedTileCount=o.size()},o.prototype.IsBlockEmbeddedable=function(e){for(var o=0;o<t.Config.ROW-(e.blockData.height-1);++o)for(var n=0;n<t.Config.COL-(e.blockData.width-1);++n)if(this.IsEmbedable(e.blockData.tiles,n,o))return!0;return!1},o.prototype.IsBlockOnlyOnePositionEmbeddedable=function(e,o){for(var n=0,i=0,r=0,c=0;c<t.Config.ROW-(e.blockData.height-1);++c)for(var a=0;a<t.Config.COL-(e.blockData.width-1);++a)if(this.IsEmbedable(e.blockData.tiles,a,c)){if(++n>1)return!1;i=a,r=c}return 1==n&&(o.block=e,o.col=i,o.row=r,!0)},o.prototype.IsEmbedable=function(t,e,o){for(var n=0;n<t.length;++n){var i=t[n];if(!this.IsInRect(e+i.col,o+i.row)||this.IsTile(e+i.col,o+i.row))return!1}return!0},o.prototype.getColCount=function(t,e){var o=0;return t.forEach(function(t){return o+=t.col===e?1:0}),o},o.prototype.getRowCount=function(t,e){var o=0;return t.forEach(function(t){return o+=t.row===e?1:0}),o},o.prototype.IsClearable=function(e,o,n,i,r){var c=this,a=!1;e.forEach(function(s){var l=o+s.col,u=n+s.row,p=c._col_links[l];p.size()+c.getColCount(e,s.col)===t.Config.ROW&&(a=!0,p.For(function(t){return i.enqueue(t)}),e.forEach(function(t){t.col==s.col&&r.enqueue(t)}));var h=c._row_links[u];h.size()+c.getRowCount(e,s.row)===t.Config.COL&&(a=!0,h.For(function(t){return i.enqueue(t)}),e.forEach(function(t){t.row==s.row&&r.enqueue(t)}))});for(var s=function(t){var s=e.reduce(function(e,i){return e+(c.cr2grid(o+i.col,n+i.row)===t?1:0)},0);9===l._grid_links[t].size()+s&&(a=!0,l._grid_links[t].For(function(t){return i.enqueue(t)}),e.forEach(function(e){c.cr2grid(o+e.col,n+e.row)===t&&r.enqueue(e)}))},l=this,u=0;u<9;++u)s(u);return a},o.prototype.IsTile=function(t,e){var o=!1;return this.tiles.forEach(function(n){if(n.col===t&&n.row===e)return o=!0,!0}),o},o.prototype.IsInRect=function(e,o){return e>=0&&e<t.Config.COL&&o>=0&&o<t.Config.ROW},o}();t.Board=v;t.GameEvent={Create:"Create",Start:"Start",Win:"Win",Lose:"Lose",PreLose:"PreLose",Bombbed:"Bombbed",Reset:"Reset",Continue:"Continue",Quit:"Quit",Restart:"Restart",ContinueOnWin:"ContinueOnWin",NewGameOnLose:"NewGameOnLose",CREATE_NEW_BLOCKS:"CREATE_NEW_BLOCKS",DOCK_STATUS_UPDATED:"DOCK_STATUS_UPDATED",SCORE_CHANGED:"SCORE_CHANGED"};var g=function(n){function u(){var t=n.call(this)||this;return t.goal=null,t.board=null,t.docks=[],t.score=new c.gf.BindableNumber(0),t.combo=new c.gf.BindableNumber(-1),t.remainStars=new c.gf.BindableNumber(0),t.fsm=null,t.InitStateMachine(),t}return i(u,n),u.Create=function(){var t=new u;return t.Init(),t},u.CreateWithSnapData=function(t){var e=new u;return e.InitWithSnapData(t),e},u.ReadOrCreate=function(){var t=new c.gf.LocalStorageObject(null,c.gf.constant.FalseResultCompareFunc,"bp99_snapdata",!1);return t.hasLocalStorage()?this.CreateWithSnapData(t.value):this.Create()},u.prototype.SaveToLS=function(){var t=this.Snap();new c.gf.LocalStorageObject(null,c.gf.constant.FalseResultCompareFunc,"bp99_snapdata",!1).value=t},u.prototype.Snap=function(){var t=[];this.board.tiles.For(function(e){t.push({col:e.col,row:e.row,typ:e.typ,clearCount:e.clearCount})});var e=[];return this.docks.forEach(function(t){return e.push({index:t.index,cnfBlockData:t.block?t.block.cnfBlockData:null})}),{score:this.score.value,tiles:t,goal:{Stars:this.goal.Stars,Count:this.goal.Count},dock:e}},u.prototype.__RandomStarCount=function(){return u.RandomStarsLS.value},u.prototype.__SaveRandomStarCount=function(){var t=u.RandomStarsLS.value+1;u.RandomStarsLS.value=t<21?t:2},u.prototype.__RandomClearCount=function(t){return t+Math.floor(Math.random()*((t+1)/2))},u.prototype.Init=function(){var e=this.__RandomStarCount();console.log("stars is..................................... ",e),this.goal=new S(e,this.__RandomClearCount(e)),this.remainStars.value=this.goal.Stars,this.board=new v(this),this.board.InitWithGoal(this.goal);for(var o=0;o<t.Config.DockCount;++o){var n=new d(this,o);this.docks.push(n)}this.CreateBlocks()},u.prototype.InitWithSnapData=function(t){var o=this,n=t.tiles.reduce(function(t,o){return t+(o.typ==e.Star?1:0)},0);this.goal=new S(t.goal.Stars,t.goal.Count),this.remainStars.value=n,this.score.value=t.score,this.board=new v(this),this.board.InitWithSnapData(t),t.dock.forEach(function(t){var e=new d(o,t.index);o.docks.push(e),t.cnfBlockData&&(e.block=h.Copy(t.cnfBlockData)),o.RefreshBlockStatus()})},u.prototype.InitStateMachine=function(){this.fsm=a.StateMachine.create({initial:{event:t.GameEvent.Create,state:"none",defer:!1},events:[{name:t.GameEvent.Reset,from:a.StateMachine.WILDCARD,to:"none"},{name:t.GameEvent.Start,from:a.StateMachine.WILDCARD,to:"running"},{name:t.GameEvent.Win,from:"running",to:"win"},{name:t.GameEvent.PreLose,from:"running",to:"prelose"},{name:t.GameEvent.Bombbed,from:"prelose",to:"running"},{name:t.GameEvent.Lose,from:"prelose",to:"lose"},{name:t.GameEvent.Continue,from:a.StateMachine.WILDCARD,to:"running"},{name:t.GameEvent.Quit,from:a.StateMachine.WILDCARD,to:"quit"},{name:t.GameEvent.Restart,from:a.StateMachine.WILDCARD,to:"running"},{name:t.GameEvent.ContinueOnWin,from:a.StateMachine.WILDCARD,to:"running"},{name:t.GameEvent.NewGameOnLose,from:a.StateMachine.WILDCARD,to:"running"}],callbacks:{onbeforeevent:this.onBeforeEvent.bind(this),onafterevent:this.onAfterEvent.bind(this)}})},u.prototype.NewGameOnLose=function(){this.fsm.NewGameOnLose()},u.prototype.ContinueOnWin=function(){this.fsm.ContinueOnWin()},u.prototype.Restart=function(){this.fsm.Restart()},u.prototype.Start=function(){this.fsm.Start()},u.prototype.Quit=function(){this.fsm.Quit()},u.prototype.Win=function(){this.fsm.Win()},u.prototype.Lose=function(){this.fsm.Lose()},u.prototype.PreLose=function(){this.fsm.PreLose()},u.prototype.Bombbed=function(){this.fsm.Bombbed()},u.prototype.Reset=function(){this.fsm.Reset()},u.prototype.IsState=function(t){return this.fsm.is(t)},u.prototype.IsStateNotDragable=function(){return this.IsState("lose")||this.IsState("win")},u.prototype.onBeforeEvent=function(e){switch(e){case t.GameEvent.Restart:this.RecordScore(),this.score.value=0,this.combo.reset(!1),this.remainStars.value=this.goal.Stars,this.board.CreateTilesForGoal(this.goal);break;case t.GameEvent.ContinueOnWin:this.RecordScore(),this.combo.reset(!1),this.__SaveRandomStarCount();var n=this.__RandomStarCount();this.goal=new S(n,this.__RandomClearCount(n)),this.remainStars.value=this.goal.Stars,this.board.CreateTilesForGoal(this.goal);break;case t.GameEvent.NewGameOnLose:this.RecordScore(),this.combo.reset(!1),this.__SaveRandomStarCount();var i=this.__RandomStarCount();this.goal=new S(i,this.__RandomClearCount(i)),this.remainStars.value=this.goal.Stars,this.board.CreateTilesForGoal(this.goal);break;case t.GameEvent.Win:o.SummaryStars.value+=this.goal.Stars,p.default.ReportScore(p.default.C_BLOCK_PUZZLE99_GAME_Star,o.SummaryStars.value),this.RecordScore()}},u.prototype.onAfterEvent=function(t){this.notifyGameEvent(t)},u.prototype.RecordScore=function(){o.BestScore.value<this.score.value&&(o.BestScore.value=this.score.value,p.default.ReportScore(p.default.C_BLOCK_PUZZLE99_GAME_SCORE,this.score.value))},u.prototype.BindListener=function(e){for(var o in t.GameEvent)this.on(t.GameEvent[o],e.OnGameEvent,e)},u.prototype.UnbindListener=function(t){this.targetOff(t)},u.prototype.notifyGameEvent=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];this.notify.apply(this,r([t,t,this],e))},u.prototype.CreateBlocks=function(){this.docks.forEach(function(t){console.assert(null==t.block);var e=Math.floor(Math.random()*(l.BlockPuzzle99DataConfig.length-1))+1,o=l.BlockPuzzle99DataConfig[e],n=Math.floor(Math.random()*o.kinds.length),i=o.kinds[n];i||console.error("BlockDataConfig.length: "+l.BlockPuzzle99DataConfig.length+" blockType: "+e+" blockTypeConfig.kinds.length:"+o.kinds.length+" blockKind: "+n),t.block=h.Copy(i)}),this.RefreshBlockStatus()},u.prototype.RefreshBlockStatus=function(){var t=this;this.docks.forEach(function(e){e.block&&(e.block.canEmbedded=t.board.IsBlockEmbeddedable(e.block))})},u.prototype.UpdateDockStatus=function(){this.IsAllDockEmpty()?(this.CreateBlocks(),this.notifyGameEvent(t.GameEvent.CREATE_NEW_BLOCKS)):(this.RefreshBlockStatus(),this.notifyGameEvent(t.GameEvent.DOCK_STATUS_UPDATED)),this.CheckGameLose()},u.prototype.IsAllDockEmpty=function(){for(var t=0;t<this.docks.length;++t)if(this.docks[t].block)return!1;return!0},u.prototype.WatchADToBombBlock=function(t,e){var o=this;s.default.ShowRewardedVideo(function(n){e(n),n?(t.BombBlock(),o.IsState("prelose")&&o.Bombbed()):o.IsState("prelose")&&o.Lose()})},u.prototype.IsEmbedable=function(t,e,o){return this.board.IsEmbedable(t,e,o)},u.prototype.EmbeddedBlock=function(t,e,o,n){var i=this;t.blockData.tiles.forEach(function(t){var r=i.board.CreateBoardTile(e+t.col,o+t.row);r.dockTile=t,n.enqueue(r)})},u.prototype.OnEmbedded=function(t,o){this.board.OnEmbedded(t,o),0==o.clearTiles.size()?this.combo.value=-1:this.combo.value+=1,o.UpdateScore(this.combo.value),this.score.value+=o.Score;var n=o.clearTiles.Count(function(t){return t.boardTile.typ===e.Star});this.remainStars.value=this.remainStars.value-n,0!=this.remainStars.value||this.IsState("win")||this.Win()},u.prototype.IsClearable=function(t,e,o,n,i){return this.board.IsClearable(t,e,o,n,i)},u.prototype.IsAnyActiveBlockOnlyOnePosition=function(t){for(var e=0;e<this.docks.length;++e){var o=this.docks[e];if(o.block&&o.block.canEmbedded&&this.board.IsBlockOnlyOnePositionEmbeddedable(o.block,t))return!0}return!1},u.prototype.Continue=function(t){this.fsm.Continue(),this.board.ClearBoardAfterWatchAD(t)},u.prototype.CheckGameLose=function(){this.IsState("win")||(this.IsState("lose")?console.log(">> \u5df2\u7ecf\u662f\u5931\u8d25\u72b6\u6001\uff08\u91cd\u590d\u68c0\u6d4b\uff09"):this.docks.reduce(function(t,e){return t&&(null==e.block||!e.block.canEmbedded)},!0)&&this.PreLose())},u.RandomStarsLS=new c.gf.LocalStorageNumber(2,"bp99_random_stars",0),u}(c.gf.EventEntity);t.Game=g})(o.BlockPuzzle99||(o.BlockPuzzle99={})),cc._RF.pop()},{"../../GF/ADService":"ADService","../../GF/StateMachine":"StateMachine","../../GF/core":"core","../Base/AudioConfig":"AudioConfig","../_Service/GameCenterRankService":"GameCenterRankService","./BlockPuzzle99DataConfig":"BlockPuzzle99DataConfig"}],BlockPuzzleDataConfig:[function(t,e,o){"use strict";cc._RF.push(e,"63191nP8UZIVo3QIh8yp8ul","BlockPuzzleDataConfig"),Object.defineProperty(o,"__esModule",{value:!0}),o.BlockPuzzleDataConfig=void 0,o.BlockPuzzleDataConfig=[{kinds:[{width:1,height:1,tiles:[{col:0,row:0}]}]},{kinds:[{width:2,height:1,tiles:[{col:0,row:0},{col:1,row:0}]},{width:1,height:2,tiles:[{col:0,row:0},{col:0,row:1}]}]},{kinds:[{width:2,height:2,tiles:[{col:0,row:0},{col:1,row:0},{col:0,row:1}]},{width:2,height:2,tiles:[{col:0,row:0},{col:1,row:0},{col:1,row:1}]},{width:2,height:2,tiles:[{col:0,row:0},{col:0,row:1},{col:1,row:1}]},{width:2,height:2,tiles:[{col:1,row:0},{col:0,row:1},{col:1,row:1}]}]},{kinds:[{width:2,height:2,tiles:[{col:0,row:0},{col:1,row:0},{col:0,row:1},{col:1,row:1}]}]},{kinds:[{width:3,height:2,tiles:[{col:0,row:0},{col:1,row:0},{col:2,row:0},{col:1,row:1}]},{width:3,height:2,tiles:[{col:1,row:0},{col:0,row:1},{col:1,row:1},{col:2,row:1}]},{width:2,height:3,tiles:[{col:0,row:0},{col:0,row:1},{col:1,row:1},{col:0,row:2}]},{width:2,height:3,tiles:[{col:1,row:0},{col:0,row:1},{col:1,row:1},{col:1,row:2}]}]},{kinds:[{width:2,height:3,tiles:[{col:0,row:0},{col:1,row:0},{col:0,row:1},{col:0,row:2}]},{width:3,height:2,tiles:[{col:0,row:0},{col:1,row:0},{col:2,row:0},{col:2,row:1}]},{width:2,height:3,tiles:[{col:1,row:0},{col:1,row:1},{col:0,row:2},{col:1,row:2}]},{width:3,height:2,tiles:[{col:0,row:0},{col:0,row:1},{col:1,row:1},{col:2,row:1}]}]},{kinds:[{width:2,height:3,tiles:[{col:0,row:0},{col:1,row:0},{col:1,row:1},{col:1,row:2}]},{width:3,height:2,tiles:[{col:2,row:0},{col:0,row:1},{col:1,row:1},{col:2,row:1}]},{width:2,height:3,tiles:[{col:0,row:0},{col:0,row:1},{col:0,row:2},{col:1,row:2}]},{width:3,height:2,tiles:[{col:0,row:0},{col:1,row:0},{col:2,row:0},{col:0,row:1}]}]},{kinds:[{width:1,height:4,tiles:[{col:0,row:0},{col:0,row:1},{col:0,row:2},{col:0,row:3}]},{width:4,height:1,tiles:[{col:0,row:0},{col:1,row:0},{col:2,row:0},{col:3,row:0}]}]},{kinds:[{width:2,height:3,tiles:[{col:1,row:0},{col:0,row:1},{col:1,row:1},{col:0,row:2}]},{width:3,height:2,tiles:[{col:0,row:0},{col:1,row:0},{col:1,row:1},{col:2,row:1}]}]},{kinds:[{width:2,height:3,tiles:[{col:0,row:0},{col:0,row:1},{col:1,row:1},{col:1,row:2}]},{width:3,height:2,tiles:[{col:1,row:0},{col:2,row:0},{col:0,row:1},{col:1,row:1}]}]},{kinds:[{width:1,height:3,tiles:[{col:0,row:0},{col:0,row:1},{col:0,row:2}]},{width:3,height:1,tiles:[{col:0,row:0},{col:1,row:0},{col:2,row:0}]}]},{kinds:[{width:3,height:3,tiles:[{col:0,row:0},{col:1,row:0},{col:2,row:0},{col:0,row:1},{col:0,row:2}]},{width:3,height:3,tiles:[{col:0,row:0},{col:1,row:0},{col:2,row:0},{col:2,row:1},{col:2,row:2}]},{width:3,height:3,tiles:[{col:2,row:0},{col:2,row:1},{col:0,row:2},{col:1,row:2},{col:2,row:2}]},{width:3,height:3,tiles:[{col:0,row:0},{col:0,row:1},{col:0,row:2},{col:1,row:2},{col:2,row:2}]}]},{kinds:[{width:3,height:3,tiles:[{col:0,row:0},{col:1,row:0},{col:2,row:0},{col:0,row:1},{col:1,row:1},{col:2,row:1},{col:0,row:2},{col:1,row:2},{col:2,row:2}]}]}],cc._RF.pop()},{}],BlockPuzzleScene:[function(t,e,o){"use strict";cc._RF.push(e,"66a900laQJCv4GJEzKeoYEd","BlockPuzzleScene");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../GF/ADService"),a=t("../../GF/core"),s=t("../Base/AudioConfig"),l=t("../Base/GameSceneConfig"),u=t("../Base/PrefabConfig"),p=t("../Base/UI/UIContinue"),h=t("../Base/UI/UIGameOver"),f=t("../Base/UI/UINewRecord"),d=t("../Base/UI/UIRate"),_=t("../_Service/UIService"),m=t("./BlockPuzzle"),y=t("./UI/UIBoardManager"),S=t("./UI/UIDockManager"),v=t("../_Service/GameCenterRankService"),g=t("../../GF/SDK/SDKMgr"),b=cc._decorator,P=b.ccclass,w=b.property,O=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dockManager=null,e.boardManager=null,e.m_ScoreLabel=null,e.m_HistoryBestScoreLabel=null,e.m_Game=null,e}return i(e,t),e.prototype.OnGameEvent=function(t,e,o){var n=this;switch(t){case m.BlockPuzzle.GameEvent.Start:this.bindCallback(this.m_Game.score,function(t){return n.m_ScoreLabel.string=""+t},!0),this.boardManager.HandleStartEvent(e),this.dockManager.HandleStartEvent(e);break;case m.BlockPuzzle.GameEvent.Quit:this.boardManager.HandleQuitEvent(),this.dockManager.HandleQuitEvent();break;case m.BlockPuzzle.GameEvent.Lose:this.ShowUIContinue();break;case m.BlockPuzzle.GameEvent.PreLose:this.dockManager.HandlePreLoseEvent();break;case m.BlockPuzzle.GameEvent.CREATE_NEW_BLOCKS:this.dockManager.HandleCreateNewBlocksEvent();break;case m.BlockPuzzle.GameEvent.DOCK_STATUS_UPDATED:this.dockManager.HandleDockStatusUpdatedEvent();break;case m.BlockPuzzle.GameEvent.SCORE_CHANGED:this.HandleScoreChangedEvent(o)}},e.prototype.OnHomeButtonClick=function(){a.gf.audio.playDefaultEffect(),this.GoHome()},e.prototype.OnPauseButtonClick=function(){a.gf.audio.playDefaultEffect(),this.PauseGame()},e.prototype.start=function(){var t=this;this.bindCallback(m.BlockPuzzle.LS.bestScoreLS,function(e){return t.m_HistoryBestScoreLabel.string=""+e},!0),this.m_Game=m.BlockPuzzle.Game.ReadOrCreate(),this.m_ScoreLabel.string="0",this.m_Game.BindListener(this),this.m_Game.Start(),v.default.StartRecordGameTimeForGame(this,v.default.C_BLOCK_PUZZLE_GAME_TIME),g.default.Ins.Channel.ADProxy.ShowBanner(!0)},e.prototype.onDestroy=function(){this.m_Game.UnbindListener(this),t.prototype.onDestroy.call(this)},e.prototype.HandleScoreChangedEvent=function(t){console.log("newScore >> "+t)},e.prototype.GoHome=function(){this.RecordScore(),this.m_Game.SaveToLS(),this.m_Game.Quit(),a.gf.Scene.loadScene("MenuScene")},e.prototype.RestartGame=function(){this.m_Game.Restart(),this.dockManager.RestartGame(),this.boardManager.RestartGame(),this.m_Game.SaveToLS()},e.prototype.PauseGame=function(){var t=this;_.default.OpenUIPause(l.default.Name.BlockPuzzle,function(){return t.RestartGame()})},e.prototype.ShowUIContinue=function(){var t=this;this.notifyGlobalShowUI(u.HazelPrefab.Prefab.UIContinue,new p.UIContinueModel(this.m_Game.score.value,function(e){return e?t.Continue():t.GameOver()}))},e.prototype.Continue=function(){this.boardManager.Continue(),this.m_Game.SaveToLS()},e.prototype.GameOver=function(){var t=this,e=this.m_Game.score.value,o=m.BlockPuzzle.LS.bestScoreLS.value,n=e>o;this.m_Game.RecordScore(),c.default.ShowInterstitial(function(){n?t.ShowUINewRecord(e,o):t.ShowUIGameOver(e,o)})},e.prototype.RecordScore=function(){this.m_Game.RecordScore()},e.prototype.ShowUIGameOver=function(t,e){var o=this;a.gf.audio.playEffect(s.HazelAudio.Audio.LOSE),this.notifyGlobalShowUI(u.HazelPrefab.Prefab.UIGameOver,new h.UIGameOverModel(function(){return o.RestartGame()},t,e))},e.prototype.ShowUINewRecord=function(t,e){var o=this;a.gf.audio.playEffect(s.HazelAudio.Audio.PASS_BEST_SCORE),this.notifyGlobalShowUI(u.HazelPrefab.Prefab.UINewRecord,new f.UINewRecordModel(function(){return o.RestartGame()},t,e))},e.prototype.Rate=function(){var t=this;this.notifyGlobalShowUI(u.HazelPrefab.Prefab.UIRate,new d.UIRateModel(function(){return t.RestartGame()},null))},e.__register__=void a.gf.Scene.registerScene("BlockPuzzleScene",function(t){s.HazelAudio.RegisterResources(t),t.AddView(m.BlockPuzzle.Prefabs.UIDockItem),t.AddView(m.BlockPuzzle.Prefabs.UIBlock),t.AddView(m.BlockPuzzle.Prefabs.UIDockTile),t.AddView(m.BlockPuzzle.Prefabs.UIBoardTile),t.AddView(m.BlockPuzzle.Prefabs.UIShadowTile),t.AddView(m.BlockPuzzle.Prefabs.UITipTile),t.AddView(m.BlockPuzzle.Prefabs.UIScoreEffect)}),r([w(S.default)],e.prototype,"dockManager",void 0),r([w(y.default)],e.prototype,"boardManager",void 0),r([w(cc.Label)],e.prototype,"m_ScoreLabel",void 0),r([w(cc.Label)],e.prototype,"m_HistoryBestScoreLabel",void 0),r([a.gf.decorator.BlockInput(.3)],e.prototype,"OnHomeButtonClick",null),r([a.gf.decorator.BlockInput(.3)],e.prototype,"OnPauseButtonClick",null),r([P],e)}(a.gf.Scene);o.default=O,cc._RF.pop()},{"../../GF/ADService":"ADService","../../GF/SDK/SDKMgr":"SDKMgr","../../GF/core":"core","../Base/AudioConfig":"AudioConfig","../Base/GameSceneConfig":"GameSceneConfig","../Base/PrefabConfig":"PrefabConfig","../Base/UI/UIContinue":"UIContinue","../Base/UI/UIGameOver":"UIGameOver","../Base/UI/UINewRecord":"UINewRecord","../Base/UI/UIRate":"UIRate","../_Service/GameCenterRankService":"GameCenterRankService","../_Service/UIService":"UIService","./BlockPuzzle":"BlockPuzzle","./UI/UIBoardManager":"UIBoardManager","./UI/UIDockManager":"UIDockManager"}],BlockPuzzle:[function(t,e,o){"use strict";cc._RF.push(e,"5d3c1ndOghPk7D59EJ6geJ+","BlockPuzzle");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__spreadArrays||function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<o;e++)for(var r=arguments[e],c=0,a=r.length;c<a;c++,i++)n[i]=r[c];return n};Object.defineProperty(o,"__esModule",{value:!0}),o.BlockPuzzle=void 0;var c=t("../../GF/core"),a=t("../../GF/StateMachine"),s=t("../../GF/ADService"),l=t("./BlockPuzzleDataConfig"),u=t("../Base/AudioConfig"),p=t("../_Service/GameCenterRankService");(function(t){var e=function(){function t(){}return t.bestScoreLS=new c.gf.LocalStorageNumber(0,"bp_bestScore",0),t}();t.LS=e,t.Prefabs={UIDockItem:"BlockPuzzle/Prefab/UIDockItem",UIBlock:"BlockPuzzle/Prefab/UIBlock",UIDockTile:"BlockPuzzle/Prefab/UIDockTile",UIBoardTile:"BlockPuzzle/Prefab/UIBoardTile",UIShadowTile:"BlockPuzzle/Prefab/UIShadowTile",UITipTile:"BlockPuzzle/Prefab/UITipTile",UIScoreEffect:"BlockPuzzle/Prefab/UIScoreEffect"},t.Config={COL:8,ROW:8,DockCount:3,DOCK_TILE_WIDTH:80,DOCK_TILE_HEIGHT:80,TILE_WIDTH:74,TILE_HEIGHT:74,DRAG_PADDING:6,DRAG_SCALE:.9,EFFECT_POWER:3e3};var o=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.col=t,this.row=e};t.Tile=o;var n=function(){function t(t,e){this.blockData=t,this.cnfBlockData=e,this.canEmbedded=!1}return t.Copy=function(e){var o={width:e.width,height:e.height,tiles:[]};return e.tiles.forEach(function(t){return o.tiles.push(h.Copy(t))}),new t(o,e)},t}();t.Block=n;var h=function(t){function e(e,o,n){void 0===n&&(n=null);var i=t.call(this,e,o)||this;return i.ui=n,i}return i(e,t),e.Copy=function(t){return new e(t.col,t.row)},e}(o);t.DockTile=h;var f=function(){function t(t,e){this.game=t,this.index=e,this.ui=null,this.block=null}return t.prototype.RemoveBlockDate=function(){delete this.block},t.prototype.BombBlock=function(){c.gf.audio.playEffect(u.HazelAudio.Audio.BOMB),this.ui.RemoveBlock(),this.block=n.Copy(l.BlockPuzzleDataConfig[0].kinds[0]),this.game.RefreshBlockStatus(),this.ui.CreateNewBlock(!1)},t}();t.Dock=f;var d=function(t){function e(e,o,n){void 0===n&&(n=null);var i=t.call(this,e,o)||this;return i.ui=n,i.dockTile=null,i}return i(e,t),e}(o);t.BoardTile=d;var _=function(t,e,o){this.boardTile=t,this.isEmbeddedTile=e,this.centerTile=o};t.BoardClearTile=_;var m=function(){function t(){this.clearTiles=null,this.clearRows=0,this.clearCols=0,this.embeddedTileCount=0,this.m_Score=0,this.m_CombolCount=0,this.clearTiles=c.gf.stl.DLink.Allocate()}return Object.defineProperty(t.prototype,"Score",{get:function(){return this.m_Score},enumerable:!1,configurable:!0}),t.prototype.release=function(){this.clearTiles&&(this.clearTiles.release(),this.clearTiles=null)},t.prototype.UpdateScore=function(t){this.m_CombolCount=t;var e=0;e+=1*this.embeddedTileCount,this.clearRows+this.clearCols>0&&(e+=10*(2*(this.clearRows+this.clearCols)-1)),t>0&&(e+=20*t),this.m_Score=e},t}();t.EmbeddedInfo=m;t.TipInfo=function(){this.block=null,this.col=0,this.row=0};var y=function(){function e(e){this.game=e,this.tiles=null,this._col_links=[],this._row_links=[],this.tiles=c.gf.stl.DLink.Allocate();for(var o=0;o<t.Config.COL;++o)this._col_links.push(c.gf.stl.DLink.Allocate());for(var n=0;n<t.Config.ROW;++n)this._row_links.push(c.gf.stl.DLink.Allocate())}return e.prototype.InitWithSnapData=function(t){var e=this;t.tiles.forEach(function(t){return e.CreateBoardTile(t.col,t.row)})},e.prototype.release=function(){for(;this._row_links.length>0;)this._row_links.pop().release();for(;this._col_links.length>0;)this._col_links.pop().release();this.tiles.release(function(t){return t.ui.Release()})},e.prototype.CreateBoardTile=function(t,e){var o=new d(t,e);return this.tiles.push(o),this._col_links[t].enqueue(o),this._row_links[e].enqueue(o),o},e.prototype.ClearBoardAfterWatchAD=function(e){for(var o=this,n=0;n<3;++n){var i=t.Config.ROW-1-n;this._row_links[i].removeAll(function(t){o._col_links[t.col].removeElement(t),o.tiles.removeElement(t),e.enqueue(new _(t,!0,t))})}},e.prototype.RemoveAllTiles=function(t){var e=this;this.tiles.removeAll(function(o){e._col_links[o.col].removeElement(o),e._row_links[o.row].removeElement(o),t.enqueue(new _(o,!0,o))})},e.prototype.OnEmbedded=function(e,o){var n=this,i=0,r=0;e.For(function(c){var a=n._col_links[c.col];a.size()===t.Config.ROW-i&&(++r,a.removeAll(function(t){n._row_links[t.row].removeElement(t),n.tiles.removeElement(t);var i=null!=e.findAnyElement(function(e){return e.row===t.row&&e.col===t.col});o.clearTiles.enqueue(new _(t,i,c))}));var s=n._row_links[c.row];s.size()===t.Config.COL-r&&(++i,s.removeAll(function(t){n._col_links[t.col].removeElement(t),n.tiles.removeElement(t);var i=null!=e.findAnyElement(function(e){return e.row===t.row&&e.col===t.col});o.clearTiles.enqueue(new _(t,i,c))}))}),o.clearRows=i,o.clearCols=r,o.embeddedTileCount=e.size()},e.prototype.IsBlockEmbeddedable=function(e){for(var o=0;o<t.Config.ROW-(e.blockData.height-1);++o)for(var n=0;n<t.Config.COL-(e.blockData.width-1);++n)if(this.IsEmbedable(e.blockData.tiles,n,o))return!0;return!1},e.prototype.IsBlockOnlyOnePositionEmbeddedable=function(e,o){for(var n=0,i=0,r=0,c=0;c<t.Config.ROW-(e.blockData.height-1);++c)for(var a=0;a<t.Config.COL-(e.blockData.width-1);++a)if(this.IsEmbedable(e.blockData.tiles,a,c)){if(++n>1)return!1;i=a,r=c}return 1==n&&(o.block=e,o.col=i,o.row=r,!0)},e.prototype.IsEmbedable=function(t,e,o){for(var n=0;n<t.length;++n){var i=t[n];if(!this.IsInRect(e+i.col,o+i.row)||this.IsTile(e+i.col,o+i.row))return!1}return!0},e.prototype.getColCount=function(t,e){var o=0;return t.forEach(function(t){return o+=t.col===e?1:0}),o},e.prototype.getRowCount=function(t,e){var o=0;return t.forEach(function(t){return o+=t.row===e?1:0}),o},e.prototype.IsClearable=function(e,o,n,i,r){var c=this,a=!1;return e.forEach(function(s){var l=o+s.col,u=n+s.row,p=c._col_links[l];p.size()+c.getColCount(e,s.col)===t.Config.ROW&&(a=!0,p.For(function(t){return i.enqueue(t)}),e.forEach(function(t){t.col==s.col&&r.enqueue(t)}));var h=c._row_links[u];h.size()+c.getRowCount(e,s.row)===t.Config.COL&&(a=!0,h.For(function(t){return i.enqueue(t)}),e.forEach(function(t){t.row==s.row&&r.enqueue(t)}))}),a},e.prototype.IsTile=function(t,e){var o=!1;return this.tiles.forEach(function(n){if(n.col===t&&n.row===e)return o=!0,!0}),o},e.prototype.IsInRect=function(e,o){return e>=0&&e<t.Config.COL&&o>=0&&o<t.Config.ROW},e}();t.Board=y;t.GameEvent={Create:"Create",Start:"Start",Win:"Win",Lose:"Lose",PreLose:"PreLose",Bombbed:"Bombbed",Reset:"Reset",Continue:"Continue",Quit:"Quit",Restart:"Restart",CREATE_NEW_BLOCKS:"CREATE_NEW_BLOCKS",DOCK_STATUS_UPDATED:"DOCK_STATUS_UPDATED",SCORE_CHANGED:"SCORE_CHANGED"};var S=function(o){function u(){var t=o.call(this)||this;return t.board=null,t.docks=[],t.score=new c.gf.BindableNumber(0),t.combo=new c.gf.BindableNumber(-1),t.fsm=null,t.InitStateMachine(),t}return i(u,o),u.Create=function(){var t=new u;return t.Init(),t},u.CreateWithSnapData=function(t){var e=new u;return e.InitWithSnapData(t),e},u.ReadOrCreate=function(){var t=new c.gf.LocalStorageObject(null,c.gf.constant.FalseResultCompareFunc,"bp_snapdata",!1);return t.hasLocalStorage()?this.CreateWithSnapData(t.value):this.Create()},u.prototype.Init=function(){this.board=new y(this);for(var e=0;e<t.Config.DockCount;++e){var o=new f(this,e);this.docks.push(o)}this.CreateBlocks()},u.prototype.InitWithSnapData=function(t){var e=this;this.score.value=t.score,this.board=new y(this),this.board.InitWithSnapData(t),t.dock.forEach(function(t){var o=new f(e,t.index);e.docks.push(o),t.cnfBlockData&&(o.block=n.Copy(t.cnfBlockData)),e.RefreshBlockStatus()})},u.prototype.SaveToLS=function(){var t=this.Snap();new c.gf.LocalStorageObject(null,c.gf.constant.FalseResultCompareFunc,"bp_snapdata",!1).value=t},u.prototype.Snap=function(){var t=[];this.board.tiles.For(function(e){t.push({col:e.col,row:e.row})});var e=[];return this.docks.forEach(function(t){return e.push({index:t.index,cnfBlockData:t.block?t.block.cnfBlockData:null})}),{score:this.score.value,tiles:t,dock:e}},u.prototype.InitStateMachine=function(){this.fsm=a.StateMachine.create({initial:{event:t.GameEvent.Create,state:"none",defer:!1},events:[{name:t.GameEvent.Reset,from:a.StateMachine.WILDCARD,to:"none"},{name:t.GameEvent.Start,from:a.StateMachine.WILDCARD,to:"running"},{name:t.GameEvent.Win,from:"running",to:"win"},{name:t.GameEvent.PreLose,from:"running",to:"prelose"},{name:t.GameEvent.Bombbed,from:"prelose",to:"running"},{name:t.GameEvent.Lose,from:"prelose",to:"lose"},{name:t.GameEvent.Continue,from:a.StateMachine.WILDCARD,to:"running"},{name:t.GameEvent.Quit,from:a.StateMachine.WILDCARD,to:"quit"},{name:t.GameEvent.Restart,from:a.StateMachine.WILDCARD,to:"running"}],callbacks:{onbeforeevent:this.onBeforeEvent.bind(this),onafterevent:this.onAfterEvent.bind(this)}})},u.prototype.Restart=function(){this.fsm.Restart()},u.prototype.Start=function(){this.fsm.Start()},u.prototype.Quit=function(){this.fsm.Quit()},u.prototype.Win=function(){this.fsm.Win()},u.prototype.Lose=function(){this.fsm.Lose()},u.prototype.PreLose=function(){this.fsm.PreLose()},u.prototype.Bombbed=function(){this.fsm.Bombbed()},u.prototype.Reset=function(){this.fsm.Reset()},u.prototype.IsState=function(t){return this.fsm.is(t)},u.prototype.IsStateNotDragable=function(){return this.IsState("lose")||this.IsState("win")},u.prototype.onBeforeEvent=function(e){switch(e){case t.GameEvent.Restart:this.RecordScore(),this.score.value=0}},u.prototype.onAfterEvent=function(t){this.notifyGameEvent(t)},u.prototype.RecordScore=function(){e.bestScoreLS.value<this.score.value&&(e.bestScoreLS.value=this.score.value,p.default.ReportScore(p.default.C_BLOCK_PUZZLE_GAME_SCORE,this.score.value))},u.prototype.BindListener=function(e){for(var o in t.GameEvent)this.on(t.GameEvent[o],e.OnGameEvent,e)},u.prototype.UnbindListener=function(t){this.targetOff(t)},u.prototype.notifyGameEvent=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];this.notify.apply(this,r([t,t,this],e))},u.prototype.CreateBlocks=function(){this.docks.forEach(function(t){console.assert(null==t.block);var e=Math.floor(Math.random()*(l.BlockPuzzleDataConfig.length-1))+1,o=l.BlockPuzzleDataConfig[e],i=Math.floor(Math.random()*o.kinds.length),r=o.kinds[i];r||console.error("BlockPuzzleDataConfig.length: "+l.BlockPuzzleDataConfig.length+" blockType: "+e+" blockTypeConfig.kinds.length:"+o.kinds.length+" blockKind: "+i),t.block=n.Copy(r)}),this.RefreshBlockStatus()},u.prototype.RefreshBlockStatus=function(){var t=this;this.docks.forEach(function(e){e.block&&(e.block.canEmbedded=t.board.IsBlockEmbeddedable(e.block))})},u.prototype.UpdateDockStatus=function(){this.IsAllDockEmpty()?(this.CreateBlocks(),this.notifyGameEvent(t.GameEvent.CREATE_NEW_BLOCKS)):(this.RefreshBlockStatus(),this.notifyGameEvent(t.GameEvent.DOCK_STATUS_UPDATED)),this.CheckGameLose()},u.prototype.IsAllDockEmpty=function(){for(var t=0;t<this.docks.length;++t)if(this.docks[t].block)return!1;return!0},u.prototype.WatchADToBombBlock=function(t,e){var o=this;s.default.ShowRewardedVideo(function(n){e(n),n?(t.BombBlock(),o.IsState("prelose")&&o.Bombbed()):o.IsState("prelose")&&o.Lose()})},u.prototype.IsEmbedable=function(t,e,o){return this.board.IsEmbedable(t,e,o)},u.prototype.EmbeddedBlock=function(t,e,o,n){var i=this;t.blockData.tiles.forEach(function(t){var r=i.board.CreateBoardTile(e+t.col,o+t.row);r.dockTile=t,n.enqueue(r)})},u.prototype.OnEmbedded=function(t,e){this.board.OnEmbedded(t,e),0==e.clearTiles.size()?this.combo.value=-1:this.combo.value+=1,e.UpdateScore(this.combo.value),this.score.value+=e.Score},u.prototype.IsClearable=function(t,e,o,n,i){return this.board.IsClearable(t,e,o,n,i)},u.prototype.IsAnyActiveBlockOnlyOnePosition=function(t){for(var e=0;e<this.docks.length;++e){var o=this.docks[e];if(o.block&&o.block.canEmbedded&&this.board.IsBlockOnlyOnePositionEmbeddedable(o.block,t))return!0}return!1},u.prototype.Continue=function(t){this.fsm.Continue(),this.board.ClearBoardAfterWatchAD(t)},u.prototype.CheckGameLose=function(){this.IsState("lose")?console.log(">> \u5df2\u7ecf\u662f\u5931\u8d25\u72b6\u6001\uff08\u91cd\u590d\u68c0\u6d4b\uff09"):this.docks.reduce(function(t,e){return t&&(null==e.block||!e.block.canEmbedded)},!0)&&this.PreLose()},u}(c.gf.EventEntity);t.Game=S})(o.BlockPuzzle||(o.BlockPuzzle={})),cc._RF.pop()},{"../../GF/ADService":"ADService","../../GF/StateMachine":"StateMachine","../../GF/core":"core","../Base/AudioConfig":"AudioConfig","../_Service/GameCenterRankService":"GameCenterRankService","./BlockPuzzleDataConfig":"BlockPuzzleDataConfig"}],ClickOrDrag:[function(t,e,o){"use strict";cc._RF.push(e,"aa232XSP6FMkYzLQXes/6mV","ClickOrDrag");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator.ccclass,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_isTouchStart=!1,e.m_isDragStart=!1,e.m_StartToDragSchedule=null,e.delegate=null,e}return i(e,t),e.prototype.start=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.dragStartTest=function(){return console.assert(null!==this.delegate),this.delegate.DragStartTest()},Object.defineProperty(e.prototype,"isDrag",{get:function(){return this.m_isDragStart},enumerable:!1,configurable:!0}),e.prototype.onTouchStart=function(t){var e=this;return!this.m_isTouchStart&&(this.m_isTouchStart=!0,this.m_isDragStart=!1,this.delegate.OnTouchStart&&this.delegate.OnTouchStart(t),this.m_StartToDragSchedule=function(){e.dragStartTest()&&(e.m_isDragStart=!0,e.delegate.OnDragStart(t))},this.scheduleOnce(this.m_StartToDragSchedule,.2),!0)},e.prototype.onTouchMove=function(t){this.m_isTouchStart&&(this.delegate.OnTouchMove&&this.delegate.OnTouchMove(t),this.m_isDragStart&&this.delegate.OnDragMove(t))},e.prototype.onTouchEnd=function(t){this.m_isTouchStart&&(this.m_isTouchStart=!1,this.unschedule(this.m_StartToDragSchedule),this.m_StartToDragSchedule=null,this.m_isDragStart?(this.m_isDragStart=!1,this.delegate.OnDragEnd(t)):this.delegate.OnTouchEnd(t))},r([c],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],CountDownSprite:[function(t,e,o){"use strict";cc._RF.push(e,"a0799D5nE5FALMLhFKos1kJ","CountDownSprite");var n,i,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.ECountDownEent=void 0,function(t){t[t.END=0]="END",t[t.TICK=1]="TICK",t[t.PROGRESS=2]="PROGRESS"}(i=o.ECountDownEent||(o.ECountDownEent={}));var a=cc._decorator,s=a.ccclass,l=a.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_Sprite=null,e.m_SpriteFrames=[],e.m_CurTick=0,e.m_CurSeconds=0,e.m_CDScheduler=null,e.m_EventListeners=[],e}return r(e,t),e.prototype.SetSpriteOpacity=function(t){this.m_Sprite.node.opacity=t},e.prototype.SetSpriteScale=function(t){this.m_Sprite.node.scale=t},e.prototype.SetSpriteFrame=function(t){this.m_Sprite.spriteFrame=this.m_SpriteFrames[this.m_SpriteFrames.length-1-t]},e.prototype.SetSpriteFrameWithScaleAction=function(t){this.SetSpriteFrame(t),this.SetSpriteOpacity(0),this.m_Sprite.node.scale=1.4,cc.tween(this.m_Sprite.node).to(.3,{scale:1,opacity:255},{easing:cc.easing.backOut}).start()},e.prototype.AddCountDownEventListener=function(t){this.m_EventListeners.push(t)},e.prototype.NotifyCoundDownEvent=function(t,e){this.m_EventListeners.forEach(function(o){return o.OnCountDownEvent(t,e)})},e.prototype.UnScheduleCD=function(){this.m_CDScheduler&&(this.unschedule(this.m_CDScheduler),this.m_CDScheduler=null)},e.prototype.Reset=function(){this.UnScheduleCD(),this.m_CurTick=0,this.m_CurSeconds=0,this.SetSpriteFrame(this.m_CurTick),this.SetSpriteOpacity(0),this.SetSpriteScale(2.4)},e.prototype.StartCountDown=function(){var t=this;this.m_CDScheduler=function(e){return t.CD(e)},this.m_CurTick=0,this.m_CurSeconds=0,cc.tween(this.m_Sprite.node).to(.2,{opacity:100}).to(.3-.2,{opacity:255}).start(),cc.tween(this.m_Sprite.node).to(.3,{scale:1},{easing:cc.easing.backOut}).start(),this.schedule(this.m_CDScheduler,0),this.NotifyCoundDownEvent(i.TICK,this.m_CurTick)},e.prototype.StopCountDown=function(){this.UnScheduleCD()},e.prototype.CD=function(t){if(this.m_CurSeconds+=t,this.m_CurSeconds>=this.m_CurTick+1&&(this.m_CurTick+=1,this.SetSpriteFrameWithScaleAction(this.m_CurTick),this.NotifyCoundDownEvent(i.TICK,this.m_CurTick),this.m_CurTick==this.m_SpriteFrames.length-1))return this.UnScheduleCD(),this.NotifyProgressEvent(),void this.NotifyCoundDownEvent(i.END);this.NotifyProgressEvent()},e.prototype.NotifyProgressEvent=function(){},c([l(cc.Sprite)],e.prototype,"m_Sprite",void 0),c([l([cc.SpriteFrame])],e.prototype,"m_SpriteFrames",void 0),c([s],e)}(cc.Component);o.default=u,cc._RF.pop()},{}],DefaultChannel:[function(t,e,o){"use strict";cc._RF.push(e,"6dcf987AsNAgKMJt3ne7inU","DefaultChannel");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var r=t("../SDKEnum"),c=t("../Base/BaseChannel"),a=t("../SDK/DevADSDK/DevADSDK"),s=t("../SDK/DevGameCenter/DevGameCenter"),l=t("../SDK/DevIAP/DevIAP"),u=t("../SDK/iOSADSDK"),p=t("../SDK/iOSGameCenter"),h=t("../SDK/iOSIAP"),f=function(t){function e(){var e=t.call(this,r.EChannel.DEFAULT)||this;return cc.sys.isNative&&cc.sys.os==cc.sys.OS_IOS?(e.ProxyIAP(e.AddSDK(new h.default)),e.ProxyAD(e.AddSDK(new u.default)),e.ProxyUser(e.AddSDK(new p.default))):(cc.sys.isNative&&(cc.sys.os,cc.sys.OS_ANDROID),e.ProxyIAP(e.AddSDK(new l.default)),e.ProxyAD(e.AddSDK(a.default.Ins)),e.ProxyUser(e.AddSDK(new s.default))),e.ADProxy.setIAP(e.IAPProxy),e}return i(e,t),e}(c.default);o.default=f,cc._RF.pop()},{"../Base/BaseChannel":"BaseChannel","../SDK/DevADSDK/DevADSDK":"DevADSDK","../SDK/DevGameCenter/DevGameCenter":"DevGameCenter","../SDK/DevIAP/DevIAP":"DevIAP","../SDK/iOSADSDK":"iOSADSDK","../SDK/iOSGameCenter":"iOSGameCenter","../SDK/iOSIAP":"iOSIAP","../SDKEnum":"SDKEnum"}],DevADBanner:[function(t,e,o){"use strict";cc._RF.push(e,"a53364dcJ5Iz4ghzzs37+aP","DevADBanner");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./DevADBase"),a=cc._decorator,s=a.ccclass,l=a.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bannerNode=null,e}return i(e,t),e.prototype.Show=function(t){this.ResizeToFullScreen(this.node),t&&!this.node.active?this.RunShowAction():!t&&this.node.active&&this.RunHideAction()},e.prototype.RunShowAction=function(){this.bannerNode.y=-this.bannerNode.height,this.node.active=!0,cc.Tween.stopAllByTarget(this.bannerNode),cc.tween(this.bannerNode).to(.2,{position:cc.Vec3.ZERO}).start()},e.prototype.RunHideAction=function(){var t=this;cc.Tween.stopAllByTarget(this.bannerNode),cc.tween(this.bannerNode).to(.2,{position:cc.v3(0,-this.bannerNode.height,0)}).call(function(){return t.node.active=!1}).start()},r([l(cc.Node)],e.prototype,"bannerNode",void 0),r([s],e)}(c.default);o.default=u,cc._RF.pop()},{"./DevADBase":"DevADBase"}],DevADBase:[function(t,e,o){"use strict";cc._RF.push(e,"ebf32EwkYFPMKrLMtwFiLrp","DevADBase");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../core"),a=cc._decorator,s=a.ccclass,l=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.OnClick=function(){cc.sys.openURL("https://numas.ltd")},r([s],e)}(c.gf.View));o.default=l,cc._RF.pop()},{"../../../core":"core"}],DevADInterstitial:[function(t,e,o){"use strict";cc._RF.push(e,"245f5kd3LhKsL9qQTPnjreV","DevADInterstitial");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./DevADBase"),a=t("../../SDKEnum"),s=cc._decorator,l=s.ccclass,u=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.interstitialNode=null,e.m_ADCallback=null,e}return i(e,t),e.prototype.OnClickClose=function(){this.RunHideAction()},e.prototype.Show=function(t){console.assert(!1===this.node.active),this.ResizeToFullScreen(this.node),this.ResizeToFullScreen(this.interstitialNode),this.m_ADCallback=t,this.RunShowAction()},e.prototype.RunShowAction=function(){this.node.active=!0,this.interstitialNode.y=-this.interstitialNode.height,cc.Tween.stopAllByTarget(this.interstitialNode),cc.tween(this.interstitialNode).to(.2,{position:cc.Vec3.ZERO}).start(),this.m_ADCallback(a.EInterstitial.SHOW)},e.prototype.RunHideAction=function(){var t=this;cc.Tween.stopAllByTarget(this.interstitialNode),cc.tween(this.interstitialNode).to(.2,{position:cc.v3(0,-this.interstitialNode.height,0)}).call(function(){t.node.active=!1,t.m_ADCallback(a.EInterstitial.HIDE)}).start()},r([u(cc.Node)],e.prototype,"interstitialNode",void 0),r([l],e)}(c.default);o.default=p,cc._RF.pop()},{"../../SDKEnum":"SDKEnum","./DevADBase":"DevADBase"}],DevADRewardedVideo:[function(t,e,o){"use strict";cc._RF.push(e,"f76d6UdrRhG0KO+DcrCkIT/","DevADRewardedVideo");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./DevADBase"),a=t("../../SDKEnum"),s=t("../../../StateMachine"),l=t("../../../core"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rewardedVideoNode=null,e.cdLabel=null,e.m_ADCallback=null,e.fsm=null,e.m_IsRewarded=!1,e.m_TickSchedule=null,e.m_Seconds=new l.gf.BindableNumber(0),e.CONST_REWARDED_SECONDS=1,e}return i(e,t),e.prototype.OnEnterStateShow=function(t){var e=this;"Show"===t&&(this.rewardedVideoNode.y=-this.rewardedVideoNode.height,this.node.active=!0,cc.Tween.stopAllByTarget(this.rewardedVideoNode),cc.tween(this.rewardedVideoNode).to(.2,{position:cc.Vec3.ZERO}).call(function(){e.m_Seconds.value=e.CONST_REWARDED_SECONDS,e.m_IsRewarded=!1,e.m_TickSchedule=function(){return e.Tick()},e.schedule(e.m_TickSchedule,1)}).start(),this.m_ADCallback(a.ERewardedVideo.SHOW))},e.prototype.OnEnterStateHide=function(){this.StopRewardCountDown(),this.RunHideAction()},e.prototype.OnEnterStatePause=function(){var t=this;l.gf.Application.ShowUIDialog("\u6b64\u65f6\u9000\u51fa\u5c06\u65e0\u6cd5\u5f97\u5230\u5956\u52b1\uff0c\u786e\u5b9a\u9000\u51fa\uff1f",function(){return t.fsm.ConfirmHide()},function(){return t.fsm.CancelHide()})},e.prototype.Show=function(t){var e=this;this.fsm||(this.ResizeToFullScreen(this.node),this.ResizeToFullScreen(this.rewardedVideoNode),this.bindCallback(this.m_Seconds,function(t){return e.cdLabel.string=""+t},!0),this.fsm=s.StateMachine.create({initial:{event:"Start",state:"hide",defer:!1},events:[{name:"Show",from:"hide",to:"show"},{name:"Hide",from:"show",to:"hide"},{name:"Pause",from:"show",to:"pause"},{name:"ConfirmHide",from:"pause",to:"hide"},{name:"CancelHide",from:"pause",to:"show"}],callbacks:{onentershow:this.OnEnterStateShow.bind(this),onenterhide:this.OnEnterStateHide.bind(this),onenterpause:this.OnEnterStatePause.bind(this)}})),console.assert(this.fsm.can("Show")),this.m_ADCallback=t,this.fsm.Show()},e.prototype.OnClickClose=function(){this.m_IsRewarded?this.fsm.Hide():this.fsm.Pause()},e.prototype.Tick=function(){!this.m_IsRewarded&&this.fsm.is("show")&&this.m_Seconds.value>0&&(this.m_Seconds.value=this.m_Seconds.value-1,this.m_Seconds.value<=0&&(this.StopRewardCountDown(),this.m_IsRewarded=!0,this.m_ADCallback(a.ERewardedVideo.REWARDED,this.m_IsRewarded)))},e.prototype.StopRewardCountDown=function(){this.m_TickSchedule&&(this.unschedule(this.m_TickSchedule),this.m_TickSchedule=null)},e.prototype.RunHideAction=function(){var t=this;cc.Tween.stopAllByTarget(this.rewardedVideoNode),cc.tween(this.rewardedVideoNode).to(.2,{position:cc.v3(0,-this.rewardedVideoNode.height,0)}).call(function(){var e=t.m_IsRewarded;t.m_IsRewarded=!1,t.node.active=!1,t.m_ADCallback(a.ERewardedVideo.HIDE,e)}).start()},r([h(cc.Node)],e.prototype,"rewardedVideoNode",void 0),r([h(cc.Label)],e.prototype,"cdLabel",void 0),r([p],e)}(c.default);o.default=f,cc._RF.pop()},{"../../../StateMachine":"StateMachine","../../../core":"core","../../SDKEnum":"SDKEnum","./DevADBase":"DevADBase"}],DevADSDK:[function(t,e,o){"use strict";cc._RF.push(e,"c4d51DCVwdKbrC273xfZUoI","DevADSDK");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../Base/BaseAD"),c=t("../../SDKMgr"),a=t("../../SDKEnum"),s=function(t){function e(){var e=t.call(this)||this;return e.delegate=null,e}return i(e,t),e.prototype.IsSupport=function(){return!1},Object.defineProperty(e,"Ins",{get:function(){return this._ins||(this._ins=new e,c.default.Ins.LoadDevEnvironment(this._ins)),this._ins},enumerable:!1,configurable:!0}),e.prototype.setDelegate=function(t){var e=this;this.delegate=t,t.isRewardedVideoAvailableBV.bind(function(t){return e.isRewardedVideoAvailableBV.value=t},!0,this),this.LoadInterstitial(function(t){console.log("EInterstitial."+a.EInterstitial[t])})},e.prototype.ADVersion=function(){return console.assert(null!=this.delegate),this.delegate.ADVersion()},e.prototype.ShowBanner=function(t){console.assert(null!=this.delegate),this.IsSupport()&&this.delegate.ShowBanner(t)},e.prototype.DestroyBanner=function(){console.assert(null!=this.delegate),this.IsSupport()&&this.delegate.DestroyBanner()},e.prototype.LoadInterstitial=function(t){console.assert(null!=this.delegate),this.delegate.LoadInterstitial(t)},e.prototype.IsInterstitialAvailable=function(){return console.assert(null!=this.delegate),this.delegate.IsInterstitialAvailable()},e.prototype.ShowInterstitial=function(t){var e=this;console.assert(null!=this.delegate),this.IsSupport()?this.delegate.ShowInterstitial(function(o){t&&t(o),o==a.EInterstitial.HIDE&&e.m_AutoLoadInterstitial&&e.LoadInterstitial(null)}):(t&&(t(a.EInterstitial.SHOW),t(a.EInterstitial.HIDE)),this.m_AutoLoadInterstitial&&this.LoadInterstitial(null))},e.prototype.IsRewardedVideoAvailable=function(){return console.assert(null!=this.delegate),this.delegate.IsRewardedVideoAvailable()},e.prototype.ShowRewardedVideo=function(t){console.assert(null!=this.delegate),this.IsSupport()?this.delegate.ShowRewardedVideo(t):t&&(t(a.ERewardedVideo.SHOW,!1),t(a.ERewardedVideo.REWARDED,!0),t(a.ERewardedVideo.HIDE,!0))},e._ins=null,e}(r.default);o.default=s,cc._RF.pop()},{"../../Base/BaseAD":"BaseAD","../../SDKEnum":"SDKEnum","../../SDKMgr":"SDKMgr"}],DevGameCenter:[function(t,e,o){"use strict";cc._RF.push(e,"82276hbLMRDZZVUPxV+S7ue","DevGameCenter");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_Authenticated=!1,e}return i(e,t),e.prototype.IsAuthenticated=function(){return this.m_Authenticated},e.prototype.Login=function(){this.m_Authenticated=!0},e.prototype.Show=function(){console.log("Show Default GameCenter")},e.prototype.ShowLeaderboards=function(t,e){console.log("timeScope: "+e+' for "'+t+'"')},e.prototype.ShowAchievement=function(){},e.prototype.ReportScore=function(){},e.prototype.ReportAchievement=function(t,e){console.log("ReportAchievement: "+e+' for "'+t+'"')},e.prototype.FiveStar=function(){console.log("FiveStar")},e.prototype.RateUsByOpenUrl=function(){cc.sys.openURL("https://numas.ltd")},e.prototype.RateUsWithinApp=function(){cc.sys.openURL("https://numas.ltd")},e}(t("../../Base/BaseGameCenter").default);o.default=r,cc._RF.pop()},{"../../Base/BaseGameCenter":"BaseGameCenter"}],DevIAP:[function(t,e,o){"use strict";cc._RF.push(e,"e541eLLPJtNi6fvJdHv4rXD","DevIAP");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../Base/BaseIAP"),c=t("../../../core"),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_isAuthorizedForPayments=!1,e}return i(e,t),e.prototype.IsAuthorizedForPayments=function(){return this.m_isAuthorizedForPayments},e.prototype.Restore=function(){c.gf.Application.ShowMessage("Not Support!")},e.prototype.Purchase=function(t){if(this.IsPurchased(t))return console.log("DevIAP >>>> AlreadyPurchased "+t),void c.gf.Application.ShowUIOK("Already Purchased!");t==this.kRemoveADs&&this.TestPurchaseAds()},e.prototype.OnInit=function(){t.prototype.OnInit.call(this),this.m_isAuthorizedForPayments=!0},e}(r.default);o.default=a,cc._RF.pop()},{"../../../core":"core","../../Base/BaseIAP":"BaseIAP"}],EntryPoint:[function(t,e,o){"use strict";cc._RF.push(e,"dd190OsOiFOOa4rNFJrk20f","EntryPoint");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../core"),a=cc._decorator.ccclass,s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getPersistResources=function(t){t.AddAudio(c.gf.audio.DEFAULT_EFFECT)},r([a],e)}(c.gf.Application);o.default=s,cc._RF.pop()},{"../core":"core"}],GameCenterRankService:[function(t,e,o){"use strict";cc._RF.push(e,"678fbz359NKLL3bDy3lWuj1","GameCenterRankService");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../GF/core"),c=t("../../GF/SDK/SDKMgr"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.StartRecordGameTimeForGame=function(t,e){var o=15+Math.floor(45*Math.random());this.__StartRecordGameTime(t,e,o)},e.__StartRecordGameTime=function(t,e,o){var n=this;t.scheduleOnce(function(){var i=new r.gf.LocalStorageNumber(0,"gc_"+e,0);i.value+=o,n.ReportScore(e,i.value),n.StartRecordGameTimeForGame(t,e)},o)},e.ReportNumberPuzzleLevel=function(t,e){var o=this.C_NUMBER_PUZZLE_LEVEL_LIST[t];this.ReportScore(o,e)},e.ReportNumberPuzzleBestTime=function(t,e){var o=this.C_NUMBER_PUZZLE_BESTTIME_LIST[t];this.ReportScore(o,e)},e.ReportScore=function(t,e){c.default.Ins.Channel.UserProxy.ReportScore(t,e)},e.C_BLOCK_PUZZLE_GAME_TIME="BlockPuzzle_GameTime",e.C_BLOCK_PUZZLE_GAME_SCORE="BlockPuzzle_Score",e.C_BLOCK_PUZZLE99_GAME_TIME="Woodoku99_GameTime",e.C_BLOCK_PUZZLE99_GAME_SCORE="Woodoku99_Score",e.C_BLOCK_PUZZLE99_GAME_Star="Woodoku99_Star",e.C_NUMBER_PUZZLE_GAME_TIME="NumberPuzzle_GameTime",e.C_NUMBER_PUZZLE_LEVEL_LIST=["NumberPuzzle_3x3_Level","NumberPuzzle_4x4_Level","NumberPuzzle_5x5_Level","NumberPuzzle_6x6_Level","NumberPuzzle_7x7_Level","NumberPuzzle_8x8_Level"],e.C_NUMBER_PUZZLE_BESTTIME_LIST=["NumberPuzzle_3x3_BestTime","NumberPuzzle_4x4_BestTime","NumberPuzzle_5x5_BestTime","NumberPuzzle_6x6_BestTime","NumberPuzzle_7x7_BestTime","NumberPuzzle_8x8_BestTime"],e}(r.gf.Service);o.default=a,cc._RF.pop()},{"../../GF/SDK/SDKMgr":"SDKMgr","../../GF/core":"core"}],GameSceneConfig:[function(t,e,o){"use strict";cc._RF.push(e,"277b0l/AexBm4Y3q+Uf95Xc","GameSceneConfig"),Object.defineProperty(o,"__esModule",{value:!0}),o.default={Name:{BlockPuzzle:"BlockPuzzle",BlockPuzzle99:"BlockPuzzle99",NumberPuzzle:"NumberPuzzle"}},cc._RF.pop()},{}],IAD:[function(t,e,o){"use strict";cc._RF.push(e,"cbe03mQCVRObZP2BLSmBrbY","IAD"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IIAP:[function(t,e,o){"use strict";cc._RF.push(e,"21f17dwz0lA26jG8nZF7uTD","IIAP"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],ISDKLifeCycle:[function(t,e,o){"use strict";cc._RF.push(e,"402afdzWZ5E0LDVjPR35+N4","ISDKLifeCycle"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IUser:[function(t,e,o){"use strict";cc._RF.push(e,"237eaD+nutOpovVti0zZq/S","IUser"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],MenuItem:[function(t,e,o){"use strict";cc._RF.push(e,"276068aZGhA+6hkTjb3POG0","MenuItem");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../GF/core"),a=t("../BlockPuzzleScene/BlockPuzzle"),s=t("../BlockPuzzle99Scene/BlockPuzzle99"),l=t("../AppConfig"),u=t("../Base/GameSceneConfig"),p=t("../NumberPuzzleScene/NumberPuzzle"),h=cc._decorator,f=h.ccclass,d=h.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_NormalNode=null,e.m_PressedNode=null,e.m_NormalIconSprite=null,e.m_PressedIconSprite=null,e.m_NormalGameNameSprite=null,e.m_PressedGameNameSprite=null,e.m_NHotNode=null,e.m_PHotNode=null,e.m_NormalScoreLabel=null,e.m_PressedScoreLabel=null,e.m_Button=null,e.m_NormalLastGameKeyHighlight=null,e.m_PressedLastGameKeyHighlight=null,e.m_GameKey="",e.m_MenuScene=null,e}var o;return i(e,t),o=e,e.prototype.Init=function(t,e,n,i){this.m_GameKey=t,this.m_MenuScene=e,this.m_Button.node.x=o.CONST_X,this.SwitchToNormal(),l.AppConfig.LS.LastGameKey.value==this.m_GameKey?(this.m_NormalLastGameKeyHighlight.active=!0,this.m_PressedLastGameKeyHighlight.active=!0):(this.m_NormalLastGameKeyHighlight.active=!1,this.m_PressedLastGameKeyHighlight.active=!1),this.m_NormalIconSprite.spriteFrame=n,this.m_PressedIconSprite.spriteFrame=n,this.m_NormalGameNameSprite.spriteFrame=i,this.m_PressedGameNameSprite.spriteFrame=i,this.m_NHotNode.active=this.m_GameKey==u.default.Name.BlockPuzzle99,this.m_PHotNode.active=this.m_GameKey==u.default.Name.BlockPuzzle99},e.prototype.start=function(){this.m_NormalScoreLabel.string=""+this.ScoreString,this.m_PressedScoreLabel.string=""+this.ScoreString,this.m_Button.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.m_Button.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.m_Button.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this)},e.prototype.SwitchToNormal=function(){this.m_NormalNode.active=!0,this.m_PressedNode.active=!1},e.prototype.SwitchToPressed=function(){this.m_NormalNode.active=!1,this.m_PressedNode.active=!0},e.prototype.RunEnterAction=function(t){cc.tween(this.m_Button.node).delay(t).to(.5,{position:cc.Vec3.ZERO},{easing:cc.easing.backOut}).start()},e.prototype.RunExitAction=function(t){cc.tween(this.m_Button.node).delay(t).to(.3,{position:cc.v3(o.CONST_X,0,0)},{easing:cc.easing.backIn}).start()},e.prototype.onTouchStart=function(){c.gf.audio.playDefaultEffect(),this.SwitchToPressed()},e.prototype.onTouchEnd=function(){this.SwitchToNormal(),this.m_GameKey==u.default.Name.NumberPuzzle?this.m_MenuScene.ExitAndSwtichToSubContent(this.m_GameKey):this.m_MenuScene.EnterGame(this.m_GameKey)},e.prototype.onTouchCancel=function(){this.SwitchToNormal()},Object.defineProperty(e.prototype,"ScoreString",{get:function(){switch(this.m_GameKey){case u.default.Name.BlockPuzzle:return"SCORE: "+a.BlockPuzzle.LS.bestScoreLS.value;case u.default.Name.BlockPuzzle99:return"SCORE: "+s.BlockPuzzle99.LS.BestScore.value;case u.default.Name.NumberPuzzle:var t=l.AppConfig.LS.LastNumberPuzzleLevelType.value,e=p.NumberPuzzle.LS.Get(t).historyBestSeconds.value;return"BEST TIME: "+c.gf.date.Format(e,"mm:ss")}return""},enumerable:!1,configurable:!0}),e.CONST_X=-560,r([d(cc.Node)],e.prototype,"m_NormalNode",void 0),r([d(cc.Node)],e.prototype,"m_PressedNode",void 0),r([d(cc.Sprite)],e.prototype,"m_NormalIconSprite",void 0),r([d(cc.Sprite)],e.prototype,"m_PressedIconSprite",void 0),r([d(cc.Sprite)],e.prototype,"m_NormalGameNameSprite",void 0),r([d(cc.Sprite)],e.prototype,"m_PressedGameNameSprite",void 0),r([d(cc.Node)],e.prototype,"m_NHotNode",void 0),r([d(cc.Node)],e.prototype,"m_PHotNode",void 0),r([d(cc.Label)],e.prototype,"m_NormalScoreLabel",void 0),r([d(cc.Label)],e.prototype,"m_PressedScoreLabel",void 0),r([d(cc.Button)],e.prototype,"m_Button",void 0),r([d(cc.Node)],e.prototype,"m_NormalLastGameKeyHighlight",void 0),r([d(cc.Node)],e.prototype,"m_PressedLastGameKeyHighlight",void 0),o=r([f],e)}(c.gf.View);o.default=_,cc._RF.pop()},{"../../GF/core":"core","../AppConfig":"AppConfig","../Base/GameSceneConfig":"GameSceneConfig","../BlockPuzzle99Scene/BlockPuzzle99":"BlockPuzzle99","../BlockPuzzleScene/BlockPuzzle":"BlockPuzzle","../NumberPuzzleScene/NumberPuzzle":"NumberPuzzle"}],MenuScene:[function(t,e,o){"use strict";cc._RF.push(e,"9ea05wdbsBLApYhO43UOGTn","MenuScene");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.EMenuSceneEnterType=void 0;var c,a=t("../../GF/core"),s=t("./MenuItem"),l=t("../NumberPuzzleScene/NumberPuzzleScene"),u=t("../Base/GameSceneConfig"),p=t("../AppConfig"),h=t("./SubContent/NumberPuzzleContent"),f=t("../../GF/SDK/SDKMgr"),d=t("../../GF/ADService");(function(t){t[t.Default=0]="Default",t[t.NumberPuzzle=1]="NumberPuzzle"})(c=o.EMenuSceneEnterType||(o.EMenuSceneEnterType={}));var _=cc._decorator,m=_.ccclass,y=_.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_SubScrollView=null,e.m_Layout=null,e.m_CommingSoom=null,e.m_MoreGameNode=null,e.m_SettingNode=null,e.m_BackToMenuListNode=null,e.m_MenuItemPrefab=null,e.m_MenuItemContent=null,e.m_IconList=[],e.m_GameNameSPList=[],e.m_MenuItemList=[],e.m_BackToMenuListCall=null,e}var o;return i(e,t),o=e,e.prototype.start=function(){this.m_SubScrollView.node.active=!1,this.m_BackToMenuListNode.active=!1,this.AddMenuItem(u.default.Name.BlockPuzzle,0),this.AddMenuItem(u.default.Name.BlockPuzzle99,1),this.AddMenuItem(u.default.Name.NumberPuzzle,2),this.m_CommingSoom.x=s.default.CONST_X;var t=o.EnterType;switch(o.EnterType=c.Default,t){case c.NumberPuzzle:this.SetUIToMenuStatus(!1),this.SwtichToSubContent(u.default.Name.NumberPuzzle);break;default:this.SetUIToMenuStatus(!0),this.RunMenuItemEnterAction()}f.default.Ins.Channel.ADProxy.ShowBanner(!1)},e.prototype.AddMenuItem=function(t,e){var o=cc.instantiate(this.m_MenuItemPrefab);this.m_MenuItemContent.addChild(o);var n=o.getComponent(s.default);this.m_MenuItemList.push(n),n.Init(t,this,this.m_IconList[e],this.m_GameNameSPList[e])},e.prototype.SetUIToMenuStatus=function(t){this.m_BackToMenuListNode.active=!t},e.prototype.RunMenuItemEnterAction=function(t){var e=this;this.m_MenuItemList.forEach(function(t,e){return t.RunEnterAction(.35+.1*e)}),cc.tween(this.m_CommingSoom).delay(.55+.1*this.m_MenuItemList.length).call(function(){t&&t(),e.m_SubScrollView.node.active=!1}).start(),cc.tween(this.m_CommingSoom).delay(.35+.1*this.m_MenuItemList.length).to(.5,{position:cc.Vec3.ZERO},{easing:cc.easing.backOut}).start()},e.prototype.RunMenuItemExitAction=function(t){this.SetUIToMenuStatus(!1),this.m_MenuItemList.forEach(function(t,e){return t.RunExitAction(.35+.1*e)}),cc.tween(this.m_CommingSoom).delay(.55+.1*this.m_MenuItemList.length).call(t).start(),cc.tween(this.m_CommingSoom).delay(.35+.1*this.m_MenuItemList.length).to(.3,{position:cc.v3(s.default.CONST_X,0,0)},{easing:cc.easing.backIn}).start()},e.prototype.OnMoreGameClick=function(){a.gf.audio.playDefaultEffect(),console.log("OnMoreGameClick555544534534........."),d.default.ShowInterstitial(function(){})},e.prototype.OnSettingClick=function(){a.gf.audio.playDefaultEffect(),console.log("OnSettingClick........."),d.default.ShowRewardedVideo(function(t){console.log("OnSettingClick.........isRewared >> ",t)})},e.prototype.OnClickBackToMenuList=function(){a.gf.audio.playDefaultEffect(),this.m_BackToMenuListCall()},e.prototype.ExitAndSwtichToSubContent=function(t){var e=this;this.RunMenuItemExitAction(function(){return e.SwtichToSubContent(t)})},e.prototype.SwtichToSubContent=function(t){var e=this;switch(this.m_SubScrollView.node.active=!0,t){case u.default.Name.NumberPuzzle:var o=a.gf.ReusableView.Allocate("_MenuScene/"+t+"Content",new h.NumberPuzzleContentModel(function(o,n){l.default.s_SelectLevel=o,p.AppConfig.LS.LastNumberPuzzleLevelType.value=o,e.EnterGame(t,function(){n.Release()})}));this.m_Layout.node.addChild(o.node),this.m_BackToMenuListCall=function(){e.SetUIToMenuStatus(!0),o.ExitContent(function(){return e.RunMenuItemEnterAction()})},o.EnterContent()}},e.prototype.EnterGame=function(t,e){a.gf.Scene.loadScene(t+"Scene",function(){return p.AppConfig.LS.LastGameKey.value=t},e)},e.Prefabs={BlockPuzzle:"_MenuScene/"+u.default.Name.BlockPuzzle+"Content",BlockPuzzle99:"_MenuScene/"+u.default.Name.BlockPuzzle99+"Content",NumberPuzzle:"_MenuScene/"+u.default.Name.NumberPuzzle+"Content"},e.__register__=void a.gf.Scene.registerScene("MenuScene",function(t){t.AddView("_MenuScene/"+u.default.Name.NumberPuzzle+"Content")}),e.EnterType=c.Default,r([y(cc.ScrollView)],e.prototype,"m_SubScrollView",void 0),r([y(cc.Layout)],e.prototype,"m_Layout",void 0),r([y(cc.Node)],e.prototype,"m_CommingSoom",void 0),r([y(cc.Node)],e.prototype,"m_MoreGameNode",void 0),r([y(cc.Node)],e.prototype,"m_SettingNode",void 0),r([y(cc.Node)],e.prototype,"m_BackToMenuListNode",void 0),r([y(cc.Prefab)],e.prototype,"m_MenuItemPrefab",void 0),r([y(cc.Node)],e.prototype,"m_MenuItemContent",void 0),r([y([cc.SpriteFrame])],e.prototype,"m_IconList",void 0),r([y([cc.SpriteFrame])],e.prototype,"m_GameNameSPList",void 0),r([a.gf.decorator.BlockInput(1)],e.prototype,"OnClickBackToMenuList",null),o=r([m],e)}(a.gf.Scene);o.default=S,cc._RF.pop()},{"../../GF/ADService":"ADService","../../GF/SDK/SDKMgr":"SDKMgr","../../GF/core":"core","../AppConfig":"AppConfig","../Base/GameSceneConfig":"GameSceneConfig","../NumberPuzzleScene/NumberPuzzleScene":"NumberPuzzleScene","./MenuItem":"MenuItem","./SubContent/NumberPuzzleContent":"NumberPuzzleContent"}],NumberPuzzleContentItem:[function(t,e,o){"use strict";cc._RF.push(e,"e7f019h6nZEzI8/z4pbvInb","NumberPuzzleContentItem");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../NumberPuzzleScene/NumberPuzzle"),a=t("../../../GF/core"),s=cc._decorator,l=s.ccclass,u=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_ActionNode=null,e.m_NormalNode=null,e.m_PressedNode=null,e.m_NormalColorSprite=null,e.m_PressedColorSprite=null,e.m_NormalWordSprite=null,e.m_PressedWordSprite=null,e.m_NormalLevelLabel=null,e.m_PressedLevelLabel=null,e.m_Button=null,e.m_Index=null,e.m_Content=null,e}var o;return i(e,t),o=e,e.prototype.Init=function(t,e){this.m_Index=t,this.m_Content=e,this.m_ActionNode.x=o.CONST_X;var n=c.NumberPuzzle.LS.Get(this.m_Index).winCount.value;this.m_NormalLevelLabel.string=""+n,this.m_PressedLevelLabel.string=""+n,this.SwitchToNormal()},e.prototype.start=function(){this.m_Button.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.m_Button.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.m_Button.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this)},e.prototype.onTouchStart=function(){a.gf.audio.playDefaultEffect(),this.SwitchToPressed()},e.prototype.onTouchEnd=function(){this.SwitchToNormal(),this.m_Content.OnClick(this.m_Index)},e.prototype.onTouchCancel=function(){this.SwitchToNormal()},e.prototype.SwitchToNormal=function(){this.m_NormalNode.active=!0,this.m_PressedNode.active=!1,this.m_NormalColorSprite.spriteFrame=this.m_Content.m_NormalSpriteFrameList[this.m_Index],this.m_NormalWordSprite.spriteFrame=this.m_Content.m_NormalWordSpriteFrameList[this.m_Index]},e.prototype.SwitchToPressed=function(){this.m_NormalNode.active=!1,this.m_PressedNode.active=!0,this.m_PressedColorSprite.spriteFrame=this.m_Content.m_PressedSpriteFrameList[this.m_Index],this.m_PressedWordSprite.spriteFrame=this.m_Content.m_PressedWordSpriteFrameList[this.m_Index]},e.prototype.RunEnterAction=function(t){cc.tween(this.m_ActionNode).delay(t).to(.5,{position:cc.Vec3.ZERO},{easing:cc.easing.backOut}).start()},e.prototype.RunExitAction=function(t,e){cc.tween(this.m_ActionNode).delay(t).to(.3,{position:cc.v3(o.CONST_X,0,0)},{easing:cc.easing.backIn}).call(e).start()},e.prototype.OnExit=function(){this.m_ActionNode.x=o.CONST_X},e.CONST_X=560,r([u(cc.Node)],e.prototype,"m_ActionNode",void 0),r([u(cc.Node)],e.prototype,"m_NormalNode",void 0),r([u(cc.Node)],e.prototype,"m_PressedNode",void 0),r([u(cc.Sprite)],e.prototype,"m_NormalColorSprite",void 0),r([u(cc.Sprite)],e.prototype,"m_PressedColorSprite",void 0),r([u(cc.Sprite)],e.prototype,"m_NormalWordSprite",void 0),r([u(cc.Sprite)],e.prototype,"m_PressedWordSprite",void 0),r([u(cc.Label)],e.prototype,"m_NormalLevelLabel",void 0),r([u(cc.Label)],e.prototype,"m_PressedLevelLabel",void 0),r([u(cc.Button)],e.prototype,"m_Button",void 0),o=r([l],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../GF/core":"core","../../NumberPuzzleScene/NumberPuzzle":"NumberPuzzle"}],NumberPuzzleContent:[function(t,e,o){"use strict";cc._RF.push(e,"a1728T3XT1BxJ8JG8BWn6Vk","NumberPuzzleContent");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.NumberPuzzleContentModel=void 0;var c=t("../../../GF/core"),a=t("./NumberPuzzleContentItem");o.NumberPuzzleContentModel=function(t){this.OnSelect=t};var s=cc._decorator,l=s.ccclass,u=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_ItemPrefab=null,e.m_NormalSpriteFrameList=[],e.m_PressedSpriteFrameList=[],e.m_NormalWordSpriteFrameList=[],e.m_PressedWordSpriteFrameList=[],e.m_ContentItemList=[],e}return i(e,t),e.prototype.OnCreate=function(){for(var t=3;t<=8;++t){var e=t-3,o=cc.instantiate(this.m_ItemPrefab);this.node.addChild(o);var n=o.getComponent(a.default);n.Init(e,this),this.m_ContentItemList.push(n)}},e.prototype.OnAllocate=function(){},e.prototype.OnEnter=function(){},e.prototype.OnExit=function(){this.m_ContentItemList.forEach(function(t){return t.OnExit()})},e.prototype.OnClick=function(t){this.vm.OnSelect(t,this)},e.prototype.EnterContent=function(){this.Enter(),this.m_ContentItemList.forEach(function(t,e){return t.RunEnterAction(.1*e)})},e.prototype.ExitContent=function(t){var e=this,o=c.gf.util.CallAfterCount(function(){e.Release()},this.m_ContentItemList.length);this.m_ContentItemList.forEach(function(t,e){return t.RunExitAction(.1*e,o)}),cc.tween(this.node).delay(.35).call(t).start()},r([u(cc.Prefab)],e.prototype,"m_ItemPrefab",void 0),r([u([cc.SpriteFrame])],e.prototype,"m_NormalSpriteFrameList",void 0),r([u([cc.SpriteFrame])],e.prototype,"m_PressedSpriteFrameList",void 0),r([u([cc.SpriteFrame])],e.prototype,"m_NormalWordSpriteFrameList",void 0),r([u([cc.SpriteFrame])],e.prototype,"m_PressedWordSpriteFrameList",void 0),r([c.gf.decorator.BlockInput(1)],e.prototype,"OnClick",null),r([l],e)}(c.gf.ReusableView);o.default=p,cc._RF.pop()},{"../../../GF/core":"core","./NumberPuzzleContentItem":"NumberPuzzleContentItem"}],NumberPuzzleScene:[function(t,e,o){"use strict";cc._RF.push(e,"cce293fudRI5YFMzuSlkjPD","NumberPuzzleScene");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../GF/ADService"),a=t("../../GF/core"),s=t("../Base/GameSceneConfig"),l=t("../_Service/UIService"),u=t("./NumberPuzzle"),p=t("./UI/UINPBlock"),h=t("./UI/UINPDialog"),f=t("./UI/UINPWin"),d=t("../_Service/GameCenterRankService"),_=t("../MenuScene/MenuScene"),m=t("../../GF/SDK/SDKMgr"),y=cc._decorator,S=y.ccclass,v=y.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_BoardNode=null,e.m_LevelLabel=null,e.m_SecondsLabel=null,e.m_HistoryBestSecondsLabel=null,e.m_ProgressSprite=null,e.m_NormalStarSpriteFrame=null,e.m_DarkStarSpriteFrame=null,e.m_SwapCountLabel=null,e.m_SwapWatchAdNode=null,e.m_SwapCountNode=null,e.m_SwapSpriteList=[],e.m_StarAnchorSpriteList=[],e.m_StarSpriteList=[],e.m_Game=null,e.m_Number2UIBlockMap={},e.m_CurrentStarIndex=0,e.m_TileWidth=0,e.m_TileHeight=0,e.m_TimeScheduler=null,e.m_isSwapping=!1,e.m_SelectedBlock=null,e}var o;return i(e,t),o=e,Object.defineProperty(e.prototype,"TileWidth",{get:function(){return this.m_TileWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"TileHeight",{get:function(){return this.m_TileHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Col",{get:function(){return o.s_SelectLevel+3},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Row",{get:function(){return o.s_SelectLevel+3},enumerable:!1,configurable:!0}),e.prototype.CalcBlockPosition=function(t){return cc.v3((this.Slot2Col(t)+.5)*this.m_TileWidth,(this.Slot2Row(t)+.5)*this.m_TileHeight,0)},e.prototype.Slot2Col=function(t){return t%this.Col},e.prototype.Slot2Row=function(t){return this.Row-1-Math.floor(t/this.Col)},e.prototype.ColRow2Slot=function(t,e){return t+this.Col*(this.Row-1-e)},e.prototype.start=function(){var t=this;this.m_TileWidth=this.m_BoardNode.width/this.Col,this.m_TileHeight=this.m_BoardNode.height/this.Row,this.bindCallback(u.NumberPuzzle.LS.SwapCount,function(e){t.m_SwapCountLabel.string=""+e,t.m_SwapWatchAdNode.active=0==e,t.m_SwapCountNode.active=e>0},!0);for(var e=0;e<this.Col*this.Row-1;++e){var n=new u.NumberPuzzle.Block(e,e),i=a.gf.ReusableView.Allocate(u.NumberPuzzle.Prefab.UINPBlock,new p.UINPBlockModel(n,this.TileWidth,this.TileHeight,this.OnClickBlock.bind(this)));i.node.position=this.CalcBlockPosition(n.Slot),this.m_BoardNode.addChild(i.node),this.m_Number2UIBlockMap[n.Number]=i,i.Enter()}var r=u.NumberPuzzle.LS.Get(o.s_SelectLevel).snapData;r.hasLocalStorage()&&r.value.seconds>0&&!r.value.isWin?this.notifyGlobalShowUI(u.NumberPuzzle.Prefab.UINPDialog,new h.UINPDialogModel(function(){return t.__PlayWithSnapData()},function(){return t.__PlayNewGame()})):this.__PlayNewGame(),d.default.StartRecordGameTimeForGame(this,d.default.C_NUMBER_PUZZLE_GAME_TIME),m.default.Ins.Channel.ADProxy.ShowBanner(!0)},e.prototype.onDestroy=function(){for(var e in this.m_Number2UIBlockMap)this.m_Number2UIBlockMap[e].Release();this.m_Number2UIBlockMap={},t.prototype.onDestroy.call(this)},e.prototype.__PlayNewGame=function(){var t=new u.NumberPuzzle.Game({levelType:o.s_SelectLevel});t.InitWithNew(),t.SaveToLS(),this.__PlayWithSnapData()},e.prototype.__PlayWithSnapData=function(){var t=this;this.StopTimeScheduler(),this.m_Game&&this.m_Game.Seconds.targetUnbind(this),this.m_CurrentStarIndex=0;var e=u.NumberPuzzle.LS.Get(o.s_SelectLevel).snapData.value;this.m_Game=new u.NumberPuzzle.Game({levelType:o.s_SelectLevel}),this.m_Game.InitWithSnapData(e),this.m_Game.Blocks.forEach(function(e){if(e){var o=t.m_Number2UIBlockMap[e.Number];o.SetBlock(e);var n=t.CalcBlockPosition(e.Number),i=t.CalcBlockPosition(e.Slot);o.node.position=n,t.m_Number2UIBlockMap[e.Number]=o,cc.tween(o.node).delay(.4).to(.15,{position:i}).start()}}),this.__SyncHistoryBestSecondsLabel(this.m_Game.LevelType),this.__SyncLevelLabel(this.m_Game.LevelType),this.__UpdateStarListPosition(),this.m_StarSpriteList.forEach(function(e){return e.spriteFrame=t.m_NormalStarSpriteFrame}),this.m_Game.Seconds.bind(function(e){t.m_SecondsLabel.string=""+a.gf.date.Format(e,"mm:ss"),t.m_ProgressSprite.fillRange=t.m_Game.CalculateRemainProgress(e),t.__UpdateStarHighLight(e)},!0,this),this.StartTimeScheduler(),this.scheduleOnce(function(){t.notifyGlobalShowUI(u.NumberPuzzle.Prefab.UINP321Go)},1)},e.prototype.__SyncHistoryBestSecondsLabel=function(t){this.m_HistoryBestSecondsLabel.string=""+a.gf.date.Format(u.NumberPuzzle.LS.Get(t).historyBestSeconds.value,"mm:ss")},e.prototype.__SyncLevelLabel=function(t){this.m_LevelLabel.string=""+u.NumberPuzzle.LS.Get(t).winCount.value},e.prototype.__UpdateStarListPosition=function(){var t=this;this.m_StarAnchorSpriteList.forEach(function(e,o){var n=1-t.m_Game.SecondsConfig[o]/t.m_Game.SecondsConfig[3],i=t.m_ProgressSprite.node.width*n;e.node.x=i})},e.prototype.__UpdateStarHighLight=function(t){for(var e=this,o=function(){var t=n.m_StarAnchorSpriteList[n.m_CurrentStarIndex],o=n.m_StarSpriteList[n.m_CurrentStarIndex];cc.tween(t.node).to(.2,{scale:1.2}).to(.2,{scale:1},{easing:cc.easing.backOut}).call(function(){o.spriteFrame=e.m_DarkStarSpriteFrame}).start(),++n.m_CurrentStarIndex},n=this;this.m_CurrentStarIndex<=3&&t>=this.m_Game.SecondsConfig[this.m_CurrentStarIndex];)o()},e.prototype.StartTimeScheduler=function(){var t=this;console.assert(null==this.m_TimeScheduler),this.m_TimeScheduler=function(){return t.m_Game.AddSeconds()},this.schedule(this.m_TimeScheduler,1)},e.prototype.StopTimeScheduler=function(){this.m_TimeScheduler&&(this.unschedule(this.m_TimeScheduler),this.m_TimeScheduler=null)},e.prototype.OnHomeButtonClick=function(){a.gf.audio.playDefaultEffect(),this.GoHome(_.EMenuSceneEnterType.Default)},e.prototype.OnPauseButtonClick=function(){a.gf.audio.playDefaultEffect(),this.PauseGame()},e.prototype.OnClickBlock=function(t){this.m_Game.IsFinishStatus()||(this.m_isSwapping?this.__HandleSwapClick(t):this.__HandleNormalClick(t),this.m_Game.UpdateFinishStatus(),this.m_Game.IsFinishStatus()&&this.PassLevel())},e.prototype.__HandleNormalClick=function(t){if(this.m_Game.IsOnEmptyRow(t.vm.block))if(this.m_Game.EmptySlot<t.vm.block.Slot)for(var e=this.m_Game.EmptySlot+1,o=t.vm.block.Slot,n=e;n<=o;++n)this.MoveBlock(n);else for(e=this.m_Game.EmptySlot-1,o=t.vm.block.Slot,n=e;n>=o;--n)this.MoveBlock(n);else if(this.m_Game.IsOnEmptyCol(t.vm.block))if(this.m_Game.EmptySlot<t.vm.block.Slot)for(var i=this.m_Game.EmptySlotCol,r=this.m_Game.EmptySlotRow-1,c=this.m_Game.Slot2Row(t.vm.block.Slot),a=r;a>=c;--a)n=this.m_Game.ColRow2Slot(i,a),this.MoveBlock(n);else for(i=this.m_Game.EmptySlotCol,r=this.m_Game.EmptySlotRow+1,c=this.m_Game.Slot2Row(t.vm.block.Slot),a=r;a<=c;++a)n=this.m_Game.ColRow2Slot(i,a),this.MoveBlock(n)},e.prototype.MoveBlock=function(t){var e=this.CalcBlockPosition(this.m_Game.EmptySlot);this.m_Game.MarkMoved();var o=this.m_Game.MoveBlock(t),n=this.m_Number2UIBlockMap[o.Number];cc.tween(n.node).to(.15,{position:e}).start()},e.prototype.PauseGame=function(){var t=this;this.m_Game.IsPause=!0,l.default.OpenUIPause(s.default.Name.NumberPuzzle,function(){t.m_Game.IsPause=!1,t.RestartGame()},function(){t.m_Game.IsPause=!1})},e.prototype.PassLevel=function(){var t=this,e=this.m_Game.RecordOnPassLevel();this.StopTimeScheduler(),c.default.ShowInterstitial(function(){t.notifyGlobalShowUI(u.NumberPuzzle.Prefab.UINPWin,new f.UINPWinModel(e.stars,e.seconds,e.historyBestSeconds,function(){return t.GoToLevelSelect()},function(){return t.RestartGame()},function(){return t.__PlayNewGame()}))})},e.prototype.GoHome=function(t){for(var e in this.m_Number2UIBlockMap)this.m_Number2UIBlockMap[e].Release();this.m_Number2UIBlockMap={},this.StopTimeScheduler(),this.m_Game.SaveToLS(),_.default.EnterType=t,a.gf.Scene.loadScene("MenuScene")},e.prototype.GoToLevelSelect=function(){this.GoHome(_.EMenuSceneEnterType.NumberPuzzle)},e.prototype.RestartGame=function(){this.m_Game.SaveToLSWithModifier(function(t){t.isWin=!1,t.seconds=0}),this.__PlayWithSnapData()},e.prototype.OnClickSwap=function(){var t=this;a.gf.audio.playDefaultEffect(),this.m_isSwapping?this.__DoSwap():u.NumberPuzzle.LS.SwapCount.value>0?this.__DoSwap():c.default.ShowRewardedVideo(function(e){e&&(u.NumberPuzzle.LS.SwapCount.value=3,t.__DoSwap())})},e.prototype.__DoSwap=function(){this.m_isSwapping=!this.m_isSwapping,this.__UpdateSwapButtonSprite()},e.prototype.__UpdateSwapButtonSprite=function(){this.m_isSwapping?(this.m_SwapSpriteList[0].node.active=!1,this.m_SwapSpriteList[1].node.active=!0):(this.m_SwapSpriteList[0].node.active=!0,this.m_SwapSpriteList[1].node.active=!1,this.m_SelectedBlock&&(this.m_SelectedBlock.ShowSwapStatus(!1),this.m_SelectedBlock=null))},e.prototype.__HandleSwapClick=function(t){if(this.m_SelectedBlock)if(this.m_SelectedBlock==t)t.ShowSwapStatus(!1),this.m_SelectedBlock=null;else{var e=this.m_SelectedBlock;this.m_SelectedBlock=null,this.m_isSwapping=!1,this.__UpdateSwapButtonSprite(),t.ShowSwapStatus(!0),this.m_Game.MarkMoved(),this.m_Game.SwapBlock(e.vm.block,t.vm.block),this.__MoveBlockToTargetSlot(e),this.__MoveBlockToTargetSlot(t),--u.NumberPuzzle.LS.SwapCount.value}else this.m_SelectedBlock=t,t.ShowSwapStatus(!0)},e.prototype.__MoveBlockToTargetSlot=function(t){var e=this.CalcBlockPosition(t.vm.block.Slot);cc.tween(t.node).to(.15,{position:e}).call(function(){t.ShowSwapStatus(!1)}).start()},e.s_SelectLevel=null,e.__register__=void a.gf.Scene.registerScene("NumberPuzzleScene",function(t){t.AddView(u.NumberPuzzle.Prefab.UINPBlock)}),r([v(cc.Node)],e.prototype,"m_BoardNode",void 0),r([v(cc.Label)],e.prototype,"m_LevelLabel",void 0),r([v(cc.Label)],e.prototype,"m_SecondsLabel",void 0),r([v(cc.Label)],e.prototype,"m_HistoryBestSecondsLabel",void 0),r([v(cc.Sprite)],e.prototype,"m_ProgressSprite",void 0),r([v(cc.SpriteFrame)],e.prototype,"m_NormalStarSpriteFrame",void 0),r([v(cc.SpriteFrame)],e.prototype,"m_DarkStarSpriteFrame",void 0),r([v(cc.Label)],e.prototype,"m_SwapCountLabel",void 0),r([v(cc.Node)],e.prototype,"m_SwapWatchAdNode",void 0),r([v(cc.Node)],e.prototype,"m_SwapCountNode",void 0),r([v([cc.Sprite])],e.prototype,"m_SwapSpriteList",void 0),r([v([cc.Sprite])],e.prototype,"m_StarAnchorSpriteList",void 0),r([v([cc.Sprite])],e.prototype,"m_StarSpriteList",void 0),r([a.gf.decorator.BlockInput(.3)],e.prototype,"OnHomeButtonClick",null),r([a.gf.decorator.BlockInput(.3)],e.prototype,"OnPauseButtonClick",null),r([a.gf.decorator.BlockInput(.3)],e.prototype,"OnClickSwap",null),o=r([S],e)}(a.gf.Scene);o.default=g,cc._RF.pop()},{"../../GF/ADService":"ADService","../../GF/SDK/SDKMgr":"SDKMgr","../../GF/core":"core","../Base/GameSceneConfig":"GameSceneConfig","../MenuScene/MenuScene":"MenuScene","../_Service/GameCenterRankService":"GameCenterRankService","../_Service/UIService":"UIService","./NumberPuzzle":"NumberPuzzle","./UI/UINPBlock":"UINPBlock","./UI/UINPDialog":"UINPDialog","./UI/UINPWin":"UINPWin"}],NumberPuzzle:[function(t,e,o){"use strict";cc._RF.push(e,"2eaafRoiY9PG7FWIWzNYtHn","NumberPuzzle"),Object.defineProperty(o,"__esModule",{value:!0}),o.NumberPuzzle=void 0;var n=t("../../GF/core"),i=t("../_Service/GameCenterRankService");(function(t){var e=function(){function t(){}return t.Get=function(t){return this.LevelTypeList[t]},t.SwapCount=new n.gf.LocalStorageNumber(3,"np_SwapCount",0),t.LevelTypeList=[{historyBestSeconds:new n.gf.LocalStorageNumber(0,"np_historyBestSeconds_0",0),winCount:new n.gf.LocalStorageNumber(0,"np_winCount_0",0),snapData:new n.gf.LocalStorageObject(null,n.gf.constant.FalseResultCompareFunc,"np_snapData_0",!1)},{historyBestSeconds:new n.gf.LocalStorageNumber(0,"np_historyBestSeconds_1",0),winCount:new n.gf.LocalStorageNumber(0,"np_winCount_1",0),snapData:new n.gf.LocalStorageObject(null,n.gf.constant.FalseResultCompareFunc,"np_snapData_1",!1)},{historyBestSeconds:new n.gf.LocalStorageNumber(0,"np_historyBestSeconds_2",0),winCount:new n.gf.LocalStorageNumber(0,"np_winCount_2",0),snapData:new n.gf.LocalStorageObject(null,n.gf.constant.FalseResultCompareFunc,"np_snapData_2",!1)},{historyBestSeconds:new n.gf.LocalStorageNumber(0,"np_historyBestSeconds_3",0),winCount:new n.gf.LocalStorageNumber(0,"np_winCount_3",0),snapData:new n.gf.LocalStorageObject(null,n.gf.constant.FalseResultCompareFunc,"np_snapData_3",!1)},{historyBestSeconds:new n.gf.LocalStorageNumber(0,"np_historyBestSeconds_4",0),winCount:new n.gf.LocalStorageNumber(0,"np_winCount_4",0),snapData:new n.gf.LocalStorageObject(null,n.gf.constant.FalseResultCompareFunc,"np_snapData_4",!1)},{historyBestSeconds:new n.gf.LocalStorageNumber(0,"np_historyBestSeconds_5",0),winCount:new n.gf.LocalStorageNumber(0,"np_winCount_5",0),snapData:new n.gf.LocalStorageObject(null,n.gf.constant.FalseResultCompareFunc,"np_snapData_5",!1)}],t}();t.LS=e;var o=[{seconds:[30,60,120,240]},{seconds:[60,120,240,360]},{seconds:[90,180,360,500]},{seconds:[150,300,600,960]},{seconds:[180,360,720,1320]},{seconds:[240,480,960,1620]}];t.Prefab={UINPBlock:"NumberPuzzle/Prefab/UINPBlock",UINPWin:"NumberPuzzle/Prefab/UINPWin",UINPDialog:"NumberPuzzle/Prefab/UINPDialog",UINP321Go:"NumberPuzzle/Prefab/UINP321Go"},t.Audio={np_win_star:"NumberPuzzle/Audio/np_win_star",CD:["NumberPuzzle/Audio/np_readygo_0","NumberPuzzle/Audio/np_readygo_1","NumberPuzzle/Audio/np_readygo_2","NumberPuzzle/Audio/np_readygo_3"]},function(t){t[t.Level3X3=0]="Level3X3",t[t.Level4X4=1]="Level4X4",t[t.Level5X5=2]="Level5X5",t[t.Level6X6=3]="Level6X6",t[t.Level7X7=4]="Level7X7",t[t.Level8X8=5]="Level8X8"}(t.ELevelType||(t.ELevelType={}));var r=function(t,e){this.Number=t,this.Slot=e};t.Block=r;var c=function(){this.stars=0,this.seconds=0,this.historyBestSeconds=0};t.PassInfo=c;var a=function(){function t(t){this.m_IsPause=!1,this.m_Moved=!1,this.m_GameArgs=null,this.m_Blocks=[],this.Seconds=new n.gf.BindableNumber(0),this.SecondsConfig=null,this.EmptySlot=-1,this.m_FinishStatus=!1,this.m_GameArgs=t,this.SecondsConfig=o[this.LevelType].seconds}return Object.defineProperty(t.prototype,"IsPause",{get:function(){return this.m_IsPause},set:function(t){this.m_IsPause=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Blocks",{get:function(){return this.m_Blocks},enumerable:!1,configurable:!0}),t.prototype.AddSeconds=function(){!this.m_IsPause&&this.m_Moved&&(this.Seconds.value+=1)},t.prototype.InitWithNew=function(){for(var t=0;t<this.Col*this.Row-1;++t)this.m_Blocks.push(new r(t,t));this.m_Blocks.push(null),this.EmptySlot=this.Col*this.Row-1;for(var e=0;e<1e3;++e){var o;(o=Math.random()<.25?this.EmptySlot+1:Math.random()<.5?this.EmptySlot-1:Math.random()<.5?this.ColRow2Slot(this.EmptySlotCol,this.EmptySlotRow+1):this.ColRow2Slot(this.EmptySlotCol,this.EmptySlotRow-1))>=0&&o<this.Col*this.Row&&this.MoveBlock(o)}for(;0!=this.EmptySlotRow;)this.MoveBlock(this.ColRow2Slot(this.EmptySlotCol,this.EmptySlotRow-1));for(;this.EmptySlotCol!=this.Col-1;)this.MoveBlock(this.EmptySlot+1)},t.prototype.InitWithSnapData=function(t){var e=this;this.Seconds.value=t.seconds,this.EmptySlot=t.emptySlot;for(var o=0;o<this.Col*this.Row;++o)o!=this.EmptySlot?this.m_Blocks.push(new r(o,o)):this.m_Blocks.push(null);t.blocks.forEach(function(t){return e.m_Blocks[t.Slot].Number=t.Number})},Object.defineProperty(t.prototype,"LevelType",{get:function(){return this.m_GameArgs.levelType},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Col",{get:function(){return this.m_GameArgs.levelType+3},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Row",{get:function(){return this.m_GameArgs.levelType+3},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"EmptySlotCol",{get:function(){return this.Slot2Col(this.EmptySlot)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"EmptySlotRow",{get:function(){return this.Slot2Row(this.EmptySlot)},enumerable:!1,configurable:!0}),t.prototype.IsOnEmptyRow=function(t){return this.Slot2Row(t.Slot)===this.EmptySlotRow},t.prototype.IsOnEmptyCol=function(t){return this.Slot2Col(t.Slot)===this.EmptySlotCol},t.prototype.Slot2Vec2=function(t){return cc.v2(this.Slot2Col(t),this.Slot2Row(t))},t.prototype.Slot2Col=function(t){return t%this.Col},t.prototype.Slot2Row=function(t){return this.Row-1-Math.floor(t/this.Col)},t.prototype.ColRow2Slot=function(t,e){return t+this.Col*(this.Row-1-e)},t.prototype.MarkMoved=function(){this.m_Moved||(this.m_Moved=!0)},t.prototype.MoveBlock=function(t){console.assert(t!==this.EmptySlot);var e=this.m_Blocks[t];return e.Slot=this.EmptySlot,this.m_Blocks[this.EmptySlot]=this.m_Blocks[t],this.EmptySlot=t,this.m_Blocks[this.EmptySlot]=null,e},t.prototype.SwapBlock=function(t,e){var o=t.Slot,n=e.Slot;this.m_Blocks[o].Slot=n,this.m_Blocks[n].Slot=o;var i=this.m_Blocks[o];this.m_Blocks[o]=this.m_Blocks[n],this.m_Blocks[n]=i},t.prototype.UpdateFinishStatus=function(){this.m_FinishStatus=this.__CalcFinishStatus(),this.m_FinishStatus&&this.SaveToLSWithModifier(function(t){return t.isWin=!0})},t.prototype.IsFinishStatus=function(){return this.m_FinishStatus},t.prototype.RecordOnPassLevel=function(){console.assert(this.m_FinishStatus);var t=e.Get(this.LevelType),o=this.Seconds.value,n=t.historyBestSeconds.value,r=new c;return r.stars=this.__CalculateStars(),r.seconds=o,r.historyBestSeconds=n,o>0&&(0==n||o<n)&&(t.historyBestSeconds.value=o,i.default.ReportNumberPuzzleBestTime(this.LevelType,o)),++t.winCount.value,i.default.ReportNumberPuzzleLevel(this.LevelType,t.winCount.value),r},t.prototype.__CalcFinishStatus=function(){for(var t=0;t<this.m_Blocks.length;++t){var e=this.m_Blocks[t];if(e&&e.Number!==e.Slot)return!1}return!0},t.prototype.CalculateRemainProgress=function(t){return t>this.SecondsConfig[3]?0:1-t/this.SecondsConfig[3]},t.prototype.__CalculateStars=function(){for(var t=3;t>0;--t)if(this.Seconds.value>this.SecondsConfig[t])return 3-t;return 3},t.prototype.SaveToLS=function(){var t=this.Snap();e.Get(this.LevelType).snapData.value=t},t.prototype.SaveToLSWithModifier=function(t){e.Get(this.LevelType).snapData.commit(t)},t.prototype.Snap=function(){for(var t=this.Seconds.value,e=[],o=0;o<this.Col*this.Row;++o){var n=this.m_Blocks[o];n&&e.push({Number:n.Number,Slot:n.Slot})}return{seconds:t,blocks:e,emptySlot:this.EmptySlot,isWin:this.m_FinishStatus}},t}();t.Game=a})(o.NumberPuzzle||(o.NumberPuzzle={})),cc._RF.pop()},{"../../GF/core":"core","../_Service/GameCenterRankService":"GameCenterRankService"}],PrefabConfig:[function(t,e,o){"use strict";cc._RF.push(e,"037f9uOOuVBs4K6MYhFi5LE","PrefabConfig"),Object.defineProperty(o,"__esModule",{value:!0}),o.HazelPrefab=void 0,(o.HazelPrefab||(o.HazelPrefab={})).Prefab={UIContinue:"Base/Prefab/UIContinue",UIPause:"Base/Prefab/UIPause",UIRate:"Base/Prefab/UIRate",UINewRecord:"Base/Prefab/UINewRecord",UIGameOver:"Base/Prefab/UIGameOver"},cc._RF.pop()},{}],ResizeToFullScreen:[function(t,e,o){"use strict";cc._RF.push(e,"21a97zqEZRFhZUiJqOoeUsl","ResizeToFullScreen");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator.ccclass,a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.onLoad=function(){this.node.width=cc.winSize.width,this.node.height=cc.winSize.height},r([c],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],SDKConfig:[function(t,e,o){"use strict";cc._RF.push(e,"c0854ALWGZBlqFaRYdbOIC6","SDKConfig"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./SDKEnum"),i=function(){function t(){}return t.CHANNEL=n.EChannel.DEFAULT,t}();o.default=i,cc._RF.pop()},{"./SDKEnum":"SDKEnum"}],SDKEnum:[function(t,e,o){"use strict";cc._RF.push(e,"7d924GR5N1IeLAefkK3EmmY","SDKEnum"),Object.defineProperty(o,"__esModule",{value:!0}),o.ERewardedVideo=o.EInterstitial=o.EChannel=void 0,(o.EChannel||(o.EChannel={})).DEFAULT="default",function(t){t[t.NOT_AVAILABLE=0]="NOT_AVAILABLE",t[t.AD_REMOVED=1]="AD_REMOVED",t[t.LOADING=2]="LOADING",t[t.LOADED=3]="LOADED",t[t.LOAD_ERROR=4]="LOAD_ERROR",t[t.SHOW=5]="SHOW",t[t.SHOW_ERROR=6]="SHOW_ERROR",t[t.CLICK=7]="CLICK",t[t.HIDE=8]="HIDE"}(o.EInterstitial||(o.EInterstitial={})),function(t){t[t.AVAILABLE_STATUS_CHANGED=0]="AVAILABLE_STATUS_CHANGED",t[t.SHOW=1]="SHOW",t[t.SHOW_ERROR=2]="SHOW_ERROR",t[t.CLICK=3]="CLICK",t[t.HIDE=4]="HIDE",t[t.REWARDED=5]="REWARDED",t[t.NOT_AVAILABLE=6]="NOT_AVAILABLE"}(o.ERewardedVideo||(o.ERewardedVideo={})),cc._RF.pop()},{}],SDKMgr:[function(t,e,o){"use strict";cc._RF.push(e,"e4945KTOcFAxambQff2B7ZT","SDKMgr");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var r=t("./SDKEnum"),c=t("./SDKConfig"),a=t("./Channel/DefaultChannel"),s=t("../core"),l=t("./SimulatorSDK/SimulatorAD"),u=function(t){function e(){var e=t.call(this)||this;return e.m_Channel=null,e}return i(e,t),Object.defineProperty(e,"Ins",{get:function(){return this._ins||(this._ins=new e,this._ins.Channel,console.log(">> \u521d\u59cb\u5316 SDKMgr")),this._ins},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Channel",{get:function(){return this.m_Channel||(c.default.CHANNEL,console.assert(c.default.CHANNEL===r.EChannel.DEFAULT),this.m_Channel=new a.default,this.m_Channel.OnInit()),this.m_Channel},enumerable:!1,configurable:!0}),e.prototype.OnDestroy=function(){this.m_Channel&&this.m_Channel.OnDestroy()},e.prototype.LoadDevEnvironment=function(t){var e=cc.instantiate(s.gf.Application.Ins.SimulatorADPrefab);s.gf.Application.Ins.AddNode(e),t.setDelegate(e.getComponent(l.default))},e._ins=null,e}(s.gf.EventEntity);o.default=u,cc._RF.pop()},{"../core":"core","./Channel/DefaultChannel":"DefaultChannel","./SDKConfig":"SDKConfig","./SDKEnum":"SDKEnum","./SimulatorSDK/SimulatorAD":"SimulatorAD"}],SDKTypeDefine:[function(t,e,o){"use strict";cc._RF.push(e,"e0392RiiJ9M2bW6WmwTqFVx","SDKTypeDefine"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],SimulatorAD:[function(t,e,o){"use strict";cc._RF.push(e,"1d04341xhFIfIpqwi2+9Tn+","SimulatorAD");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../SDK/DevADSDK/DevADBanner"),a=t("../SDK/DevADSDK/DevADInterstitial"),s=t("../SDK/DevADSDK/DevADRewardedVideo"),l=t("../../core"),u=t("../SDKEnum"),p=cc._decorator,h=p.ccclass,f=p.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bannerPrefab=null,e.interstitialPrefab=null,e.rewardedVideoPrefab=null,e.m_Banner=null,e.m_Interstitial=null,e.m_RewardedVideo=null,e.isLoadingBV=new l.gf.BindableBoolean(!1),e.isInterstitialAvailableBV=new l.gf.BindableBoolean(!1),e.isRewardedVideoAvailableBV=new l.gf.BindableBoolean(!0),e}return i(e,t),Object.defineProperty(e.prototype,"Banner",{get:function(){return this.m_Banner||(this.m_Banner=cc.instantiate(this.bannerPrefab).getComponent(c.default),this.m_Banner.node.active=!1,this.node.parent.addChild(this.m_Banner.node,1e4)),this.m_Banner},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Interstitial",{get:function(){return this.m_Interstitial||(this.m_Interstitial=cc.instantiate(this.interstitialPrefab).getComponent(a.default),this.m_Interstitial.node.active=!1,this.node.addChild(this.m_Interstitial.node)),this.m_Interstitial},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"RewardedVideo",{get:function(){return this.m_RewardedVideo||(this.m_RewardedVideo=cc.instantiate(this.rewardedVideoPrefab).getComponent(s.default),this.m_RewardedVideo.node.active=!1,this.node.addChild(this.m_RewardedVideo.node)),this.m_RewardedVideo},enumerable:!1,configurable:!0}),e.prototype.resetZIndex=function(){var t=this.node.parent;this.node.removeFromParent(),this.node.parent=t},e.prototype.ADVersion=function(){return"1.0.0"},e.prototype.ShowBanner=function(t){this.resetZIndex(),this.Banner.Show(t)},e.prototype.DestroyBanner=function(){this.m_Banner&&(this.m_Banner.node.removeFromParent(),this.m_Banner=null)},e.prototype.IsInterstitialAvailable=function(){return this.isInterstitialAvailableBV.value},e.prototype.LoadInterstitial=function(t){var e=this;this.isLoadingBV.value?t&&t(u.EInterstitial.LOADING):this.isInterstitialAvailableBV.value?t&&t(u.EInterstitial.LOADED):(this.isLoadingBV.value=!0,setTimeout(function(){e.isInterstitialAvailableBV.value=!0,e.isLoadingBV.value=!1,t&&t(u.EInterstitial.LOADED)},3e3))},e.prototype.ShowInterstitial=function(t){this.isInterstitialAvailableBV.value?(this.isInterstitialAvailableBV.value=!1,this.resetZIndex(),this.Interstitial.Show(t)):t(u.EInterstitial.NOT_AVAILABLE)},e.prototype.ShowRewardedVideo=function(t){var e=this;this.resetZIndex(),this.isRewardedVideoAvailableBV.value=!1,setTimeout(function(){e.isRewardedVideoAvailableBV.value=!0},3e3),this.RewardedVideo.Show(t)},e.prototype.IsRewardedVideoAvailable=function(){return this.isRewardedVideoAvailableBV.value},r([f(cc.Prefab)],e.prototype,"bannerPrefab",void 0),r([f(cc.Prefab)],e.prototype,"interstitialPrefab",void 0),r([f(cc.Prefab)],e.prototype,"rewardedVideoPrefab",void 0),r([h],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../core":"core","../SDK/DevADSDK/DevADBanner":"DevADBanner","../SDK/DevADSDK/DevADInterstitial":"DevADInterstitial","../SDK/DevADSDK/DevADRewardedVideo":"DevADRewardedVideo","../SDKEnum":"SDKEnum"}],SplashScene:[function(t,e,o){"use strict";cc._RF.push(e,"2242eDVLtdCdZ6BdMNOY4G/","SplashScene");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../GF/core"),a=t("../GF/SDK/SDKMgr"),s=cc._decorator,l=s.ccclass,u=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.start=function(){console.log(">>>> SplashScene::start"),a.default.Ins.Channel.UserProxy.Login(),c.gf.Scene.loadScene("MenuScene")},r([l],e)}(c.gf.Scene));o.default=u,cc._RF.pop()},{"../GF/SDK/SDKMgr":"SDKMgr","../GF/core":"core"}],StateMachine:[function(t,e,o){"use strict";cc._RF.push(e,"450abXCjrZN4ZyQS+JfQUKp","StateMachine"),Object.defineProperty(o,"__esModule",{value:!0}),o.StateMachine=void 0,function(t){function e(e,o,n,i,r,c){if(o)try{return o.apply(e,[n,i,r].concat(c))}catch(a){return e.error(n,i,r,c,t.Error.INVALID_CALLBACK,"an exception occurred in a caller-provided callback function",a)}}function o(t,o,n,i,r){return e(t,t.onbeforeevent,o,n,i,r)}function n(t,o,n,i,r){return e(t,t.onafterevent||t.onevent,o,n,i,r)}function i(t,o,n,i,r){return e(t,t.onleavestate,o,n,i,r)}function r(t,o,n,i,r){return e(t,t.onenterstate||t.onstate,o,n,i,r)}function c(t,o,n,i,r){return e(t,t.onchangestate,o,n,i,r)}function a(t,o,n,i,r){return e(t,t["onbefore"+o],o,n,i,r)}function s(t,o,n,i,r){return e(t,t["onafter"+o]||t["on"+o],o,n,i,r)}function l(t,o,n,i,r){return e(t,t["onleave"+n],o,n,i,r)}function u(t,o,n,i,r){return e(t,t["onenter"+i]||t["on"+i],o,n,i,r)}function p(t,e,n,i,r){if(!1===a(t,e,n,i,r)||!1===o(t,e,n,i,r))return!1}function h(t,e,o,i,r){s(t,e,o,i,r),n(t,e,o,i,r)}function f(e,o,n,r,c){var a=l(e,o,n,r,c),s=i(e,o,n,r,c);return!1!==a&&!1!==s&&(t.ASYNC===a||t.ASYNC===s?t.ASYNC:void 0)}function d(t,e,o,n,i){u(t,e,o,n,i),r(t,e,o,n,i)}function _(e,o){return function(){var n=this.current,i=o[n]||o[t.WILDCARD]||n,r=Array.prototype.slice.call(arguments);if(this.transition)return this.error(e,n,i,r,t.Error.PENDING_TRANSITION,"event "+e+" inappropriate because previous transition did not complete");if(this.cannot(e))return this.error(e,n,i,r,t.Error.INVALID_TRANSITION,"event "+e+" inappropriate in current state "+this.current);if(!1===p(this,e,n,i,r))return t.Result.CANCELLED;if(n===i)return h(this,e,n,i,r),t.Result.NOTRANSITION;var a=this;this.transition=function(){return a.transition=null,a.current=i,d(a,e,n,i,r),c(a,e,n,i,r),h(a,e,n,i,r),t.Result.SUCCEEDED},this.transition.cancel=function(){a.transition=null,h(a,e,n,i,r)};var s=f(this,e,n,i,r);return!1===s?(this.transition=null,t.Result.CANCELLED):t.ASYNC===s?t.Result.PENDING:this.transition?this.transition():void 0}}t.VERSION="2.3.5",t.Result={SUCCEEDED:1,NOTRANSITION:2,CANCELLED:3,PENDING:4},t.Error={INVALID_TRANSITION:100,PENDING_TRANSITION:200,INVALID_CALLBACK:300},t.WILDCARD="*",t.ASYNC="async",t.create=function(e,o){var n="string"==typeof e.initial?{state:e.initial}:e.initial,i=e.terminal||e.final,r=o||e.target||{},c=e.events||[],a=e.callbacks||{},s={},l={},u=function(e){var o=e.from instanceof Array?e.from:e.from?[e.from]:[t.WILDCARD];s[e.name]=s[e.name]||{};for(var n=0;n<o.length;n++)l[o[n]]=l[o[n]]||[],l[o[n]].push(e.name),s[e.name][o[n]]=e.to||o[n]};n&&(n.event=n.event||"startup",u({name:n.event,from:"none",to:n.state}));for(var p=0;p<c.length;p++)u(c[p]);for(var h in s)s.hasOwnProperty(h)&&(r[h]=_(h,s[h]));for(var h in a)a.hasOwnProperty(h)&&(r[h]=a[h]);return r.current="none",r.is=function(t){return t instanceof Array?t.indexOf(this.current)>=0:this.current===t},r.can=function(e){return!this.transition&&(s[e].hasOwnProperty(this.current)||s[e].hasOwnProperty(t.WILDCARD))},r.cannot=function(t){return!this.can(t)},r.transitions=function(){return l[this.current]},r.isFinished=function(){return this.is(i)},r.error=e.error||function(t,e,o,n,i,r,c){throw c||r},n&&!n.defer&&r[n.event](),r}}(o.StateMachine||(o.StateMachine={})),cc._RF.pop()},{}],UIBP99Block:[function(t,e,o){"use strict";cc._RF.push(e,"ea6dbs8TfRLnbg3rz8Qyb0e","UIBP99Block");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GF/core"),a=t("../BlockPuzzle99"),s=cc._decorator,l=s.ccclass,u=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_UITileList=null,e.m_OffsetCol=null,e.m_OffsetRow=null,e}return i(e,t),e.prototype.OnCreate=function(){},e.prototype.OnAllocate=function(){this.m_UITileList=c.gf.stl.DLink.Allocate(),this.m_OffsetCol=.5*-(this.vm.blockData.width-1),this.m_OffsetRow=.5*-(this.vm.blockData.height-1)},e.prototype.OnEnter=function(){var t=this;this.vm.blockData.tiles.forEach(function(e){return t.CreateUITile(e),!1})},e.prototype.OnExit=function(){this.m_UITileList.removeAll(function(t){return t.Release()})},e.prototype.RunEnterAction=function(t){this.node.x=900,cc.tween(this.node).to(.4,{position:cc.Vec3.ZERO},{easing:cc.easing.cubicOut}).call(t).start()},e.prototype.CreateUITile=function(t){var e=c.gf.ReusableView.Allocate(a.BlockPuzzle99.Prefabs.UIBP99DockTile,t);this.node.addChild(e.node),e.Enter();var o=this.GetColRowDockPosition(t.col,t.row,0);e.node.x=o.x,e.node.y=o.y,e.node.zIndex=16-4*t.row-t.col,this.m_UITileList.enqueue(e)},e.prototype.UpdateDockStatus=function(t){t?this.SwitchToDockSprite():this.SwitchToDisableSprite()},e.prototype.forEachTile=function(t){this.m_UITileList.For(t)},e.prototype.GetOriginWorldPosition=function(){var t=this.GetColRowPosition(0,0,0);return this.node.convertToWorldSpaceAR(t)},e.prototype.GetColRowPosition=function(t,e,o){var n=(this.m_OffsetCol+t)*(a.BlockPuzzle99.Config.TILE_WIDTH+o),i=(this.m_OffsetRow+e)*(a.BlockPuzzle99.Config.TILE_HEIGHT+o);return cc.v2(n,i)},e.prototype.GetColRowDockPosition=function(t,e,o){var n=(this.m_OffsetCol+t)*(a.BlockPuzzle99.Config.DOCK_TILE_WIDTH+o),i=(this.m_OffsetRow+e)*(a.BlockPuzzle99.Config.DOCK_TILE_HEIGHT+o);return cc.v2(n,i)},e.prototype.SwitchToDockSprite=function(){this.forEachTile(function(t){return t.SwitchToDockSprite()})},e.prototype.SwitchToDragSprite=function(){this.forEachTile(function(t){return t.SwitchToDragSprite()})},e.prototype.SwitchToHighlightSprite=function(){this.forEachTile(function(t){return t.SwitchToHighlightSprite()})},e.prototype.SwitchToDisableSprite=function(){this.forEachTile(function(t){return t.SwitchToDisableSprite()})},e.prototype.ShowPadding=function(t){var e=this;t?this.forEachTile(function(t){var o=e.GetColRowPosition(t.vm.col,t.vm.row,a.BlockPuzzle99.Config.DRAG_PADDING);t.node.x=o.x,t.node.y=o.y}):this.forEachTile(function(t){var o=e.GetColRowDockPosition(t.vm.col,t.vm.row,0);t.node.x=o.x,t.node.y=o.y})},r([l],e)}(c.gf.ReusableView));o.default=u,cc._RF.pop()},{"../../../GF/core":"core","../BlockPuzzle99":"BlockPuzzle99"}],UIBP99BoardManager:[function(t,e,o){"use strict";cc._RF.push(e,"eb074vEjSZLy4laEVeI45//","UIBP99BoardManager");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GF/core"),a=t("../../Base/AudioConfig"),s=t("../BlockPuzzle99"),l=t("./UIBP99ScoreEffect"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ShadowTileRoot=null,e.TipTileRoot=null,e.TileRoot=null,e.m_EffectRoot=null,e.m_ShadowTileLinkList=c.gf.stl.DLink.Allocate(),e.m_TipTileLinkList=c.gf.stl.DLink.Allocate(),e.m_IsDragging=!1,e.vm=null,e.m_Scene=null,e.m_PreCol=null,e.m_PreRow=null,e.C_EMBEDED_TIME=.1,e}return i(e,t),e.prototype.start=function(){this.__InitTipTiles()},Object.defineProperty(e.prototype,"game",{get:function(){return this.vm.game},enumerable:!1,configurable:!0}),e.prototype.HandleStartEvent=function(t,e){this.vm=t.board,this.m_Scene=e,this.ResizeShadowTileLinkList(9),this.ResizeTipTileLinkList(9),this.CreateUITiles(),this.TryToShowTipTile()},e.prototype.HandleQuitEvent=function(){this.m_ShadowTileLinkList.release(function(t){return t.Release()}),this.m_TipTileLinkList.release(function(t){return t.Release()}),this.game.board.release()},e.prototype.CreateUITiles=function(){var t=this;this.vm.tiles.For(function(e){var o=t.CreateUIBoardTile(e);t.SetTilePosition(o,o.vm.col,o.vm.row)})},e.prototype.Continue=function(){var t=this,e=c.gf.stl.DLink.Allocate();this.vm.game.Continue(e),e.size()>0?(c.gf.audio.playEffect(a.HazelAudio.Audio.CLEAR_0),e.removeAll(function(e){c.gf.ui.moveNodeToTargetParent(e.boardTile.ui.node,t.m_EffectRoot,!1),e.boardTile.ui.RemoveFromBoard(e)}),this.vm.game.UpdateDockStatus()):this.vm.game.UpdateDockStatus(),e.release()},e.prototype.RemoveAllTilesWithAction=function(){var t=this,e=c.gf.stl.DLink.Allocate();this.vm.RemoveAllTiles(e),e.size()>0&&(c.gf.audio.playEffect(a.HazelAudio.Audio.CLEAR_0),e.removeAll(function(e){c.gf.ui.moveNodeToTargetParent(e.boardTile.ui.node,t.m_EffectRoot,!1),e.boardTile.ui.RemoveFromBoard(e)})),e.release()},e.prototype.AllocateShadowTile=function(){var t=c.gf.ReusableView.Allocate(s.BlockPuzzle99.Prefabs.UIBP99ShadowTile);this.ShadowTileRoot.addChild(t.node),t.Enter(),t.node.active=!1,this.m_ShadowTileLinkList.enqueue(t)},e.prototype.ResizeShadowTileLinkList=function(t){if(this.m_ShadowTileLinkList.size()<t)for(var e=t-this.m_ShadowTileLinkList.size();e>0;--e)this.AllocateShadowTile()},e.prototype.SetTilePosition=function(t,e,o){t.node.x=(.5+e)*s.BlockPuzzle99.Config.TILE_WIDTH,t.node.y=(.5+o)*s.BlockPuzzle99.Config.TILE_HEIGHT},e.prototype.GetTilePosition=function(t,e){return cc.v3((.5+t)*s.BlockPuzzle99.Config.TILE_WIDTH,(.5+e)*s.BlockPuzzle99.Config.TILE_HEIGHT,0)},e.prototype.CalculateOriginColAndRow=function(t){var e=t.GetOriginWorldPosition(),o=this.ShadowTileRoot.convertToNodeSpaceAR(e),n=Math.floor(o.x/s.BlockPuzzle99.Config.TILE_WIDTH),i=Math.floor(o.y/s.BlockPuzzle99.Config.TILE_HEIGHT);return cc.v2(n,i)},e.prototype.UpdateWithUIDockItem=function(t){var e=this,o=t.GetUIBlock();this.m_IsDragging||(this.m_IsDragging=!0,this.ShowTileTip(!1));var n=this.CalculateOriginColAndRow(o);if(this.m_PreCol!==n.x||this.m_PreRow!==n.y){this.m_PreCol=n.x,this.m_PreRow=n.y;var i=o.vm.blockData.tiles,r=this.game.IsEmbedable(i,this.m_PreCol,this.m_PreRow);if(this.m_ShadowTileLinkList.For(function(t){t.node.active=!1}),r)for(var c=function(t){var o=i[t];a.m_ShadowTileLinkList.dequeue(function(t){t.node.active=!0,e.SetTilePosition(t,e.m_PreCol+o.col,e.m_PreRow+o.row),e.m_ShadowTileLinkList.enqueue(t)})},a=this,s=0;s<i.length;++s)c(s);this.HighlightClearableBoardTilesOnDrag(t,i)}},e.prototype.HandleUIDockItemDragEnd=function(t){var e=this;this.m_IsDragging=!1,this.m_PreCol=null,this.m_PreRow=null,this.m_ShadowTileLinkList.For(function(t){return t.node.active=!1});var o=t.GetUIBlock(),n=this.CalculateOriginColAndRow(o),i=o.node.convertToWorldSpaceAR(cc.Vec2.ZERO),r=o.vm.blockData.tiles,l=this.game.IsEmbedable(r,n.x,n.y);if(l){c.gf.audio.playEffect(a.HazelAudio.Audio.PUT_DOWN);var u=c.gf.stl.DLink.Allocate();this.game.EmbeddedBlock(o.vm,n.x,n.y,u);var p=c.gf.stl.DLink.Allocate();u.For(function(t){var o=e.CreateUIBoardTile(t),n=e.TileRoot.convertToNodeSpaceAR(t.dockTile.ui.node.convertToWorldSpaceAR(cc.Vec3.ZERO));o.node.position=n,o.node.scale=s.BlockPuzzle99.Config.DRAG_SCALE,p.enqueue(o)});var h=c.gf.util.CallAfterCount(function(){var t=new s.BlockPuzzle99.EmbeddedInfo;e.game.OnEmbedded(u,t),u.removeAll(),t.clearTiles.size()>0?(c.gf.audio.playEffect(a.HazelAudio.Audio.CLEAR_0),t.reduceTiles.removeAll(function(t){return t.ui.PlayNumberReduceEffect()}),t.clearTiles.removeAll(function(t){var o=t.boardTile.ui;if(o.SwitchToHighlightSprite(),c.gf.ui.moveNodeToTargetParent(t.boardTile.ui.node,e.m_EffectRoot,!1),t.boardTile.typ==s.BlockPuzzle99.EBoardTileType.Star){var n=o.GetNormalStarSprite().node,i=cc.instantiate(n);i.active=!0,e.m_EffectRoot.addChild(i,1),i.position=e.m_EffectRoot.convertToNodeSpaceAR(n.convertToWorldSpaceAR(cc.Vec3.ZERO)),e.m_Scene.PlayStarEffect(i)}t.boardTile.ui.RemoveFromBoard(t)}),e.PlayScoreEffect(i,e.m_EffectRoot,t.Score),e.vm.game.UpdateDockStatus(),e.TryToShowTipTile()):(e.vm.game.UpdateDockStatus(),e.TryToShowTipTile()),t.release()},p.size());p.For(function(t){var o=e.GetTilePosition(t.vm.col,t.vm.row);cc.tween(t.node).to(e.C_EMBEDED_TIME,{position:o,scale:1}).call(h).start()}),p.removeAll()}else this.vm.tiles.For(function(t){return t.ui.SwitchToNormalSprite()}),this.TryToShowTipTile();return l},e.prototype.CreateUIBoardTile=function(t){var e=c.gf.ReusableView.Allocate(s.BlockPuzzle99.Prefabs.UIBP99BoardTile,t);return this.TileRoot.addChild(e.node),e.Enter(),e},e.prototype.PlayScoreEffect=function(t,e,o){var n=new l.UIBP99ScoreEffectModel(o);if(n.HasScoreEffect()){t.x>400?t.x=400:t.x<240&&(t.x=240);var i=cc.v2(t.x+60*(1+Math.random()),t.y-10*Math.random()),r=c.gf.ReusableView.Allocate(s.BlockPuzzle99.Prefabs.UIBP99ScoreEffect,n);if(r.node.setPosition(e.convertToNodeSpaceAR(i)),e.addChild(r.node),r.Enter(),r.RunScoreEffect(),n.HasLevelEffect()){var a=cc.v2(t.x-60*(1+Math.random()),t.y+10*Math.random()),u=c.gf.ReusableView.Allocate(s.BlockPuzzle99.Prefabs.UIBP99ScoreEffect,n);u.node.setPosition(e.convertToNodeSpaceAR(a)),e.addChild(u.node),u.Enter(),u.RunLevelEffect()}}},e.prototype.HighlightClearableBoardTilesOnDrag=function(t,e){if(t.GetUIBlock().SwitchToDragSprite(),this.vm.tiles.For(function(t){return t.ui.SwitchToNormalSprite()}),this.game.IsEmbedable(e,this.m_PreCol,this.m_PreRow)){var o=c.gf.stl.DLink.Allocate(),n=c.gf.stl.DLink.Allocate();this.game.IsClearable(e,this.m_PreCol,this.m_PreRow,o,n)&&(o.For(function(t){return t.ui.SwitchToHighlightSprite()}),n.For(function(t){return t.ui.SwitchToHighlightSprite()})),n.release(),o.release()}},e.prototype.__InitTipTiles=function(){this.ShowTileTip(!1)},e.prototype.ShowTileTip=function(t){this.TipTileRoot.active=t},e.prototype.TryToShowTipTile=function(){var t=this,e=new s.BlockPuzzle99.TipInfo,o=this.game.IsAnyActiveBlockOnlyOnePosition(e);if(o){this.m_TipTileLinkList.For(function(t){t.node.active=!1,t.StopTipAction()});for(var n=e.block.blockData.tiles,i=function(o){var i=n[o];r.m_TipTileLinkList.dequeue(function(o){o.node.active=!0,t.SetTilePosition(o,e.col+i.col,e.row+i.row),t.m_TipTileLinkList.enqueue(o),o.RunTipAction()})},r=this,c=0;c<n.length;++c)i(c)}this.ShowTileTip(o)},e.prototype.AllocateTipTile=function(){var t=c.gf.ReusableView.Allocate(s.BlockPuzzle99.Prefabs.UIBP99TipTile);this.TipTileRoot.addChild(t.node),t.Enter(),t.node.active=!1,this.m_TipTileLinkList.enqueue(t)},e.prototype.ResizeTipTileLinkList=function(t){if(this.m_TipTileLinkList.size()<t)for(var e=t-this.m_TipTileLinkList.size();e>0;--e)this.AllocateTipTile()},r([h(cc.Node)],e.prototype,"ShadowTileRoot",void 0),r([h(cc.Node)],e.prototype,"TipTileRoot",void 0),r([h(cc.Node)],e.prototype,"TileRoot",void 0),r([h(cc.Node)],e.prototype,"m_EffectRoot",void 0),r([p],e)}(c.gf.View);o.default=f,cc._RF.pop()},{"../../../GF/core":"core","../../Base/AudioConfig":"AudioConfig","../BlockPuzzle99":"BlockPuzzle99","./UIBP99ScoreEffect":"UIBP99ScoreEffect"}],UIBP99BoardTile:[function(t,e,o){"use strict";cc._RF.push(e,"2841d2TWT5LBryWlrIBdIVx","UIBP99BoardTile");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GF/core"),a=t("../../../GF/StateMachine"),s=t("../BlockPuzzle99"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.NormalSprite=null,e.HighlightSprite=null,e.StarNormalSprite=null,e.StarHighlightSprite=null,e.StarLabel=null,e.fsm=null,e.SM_STATUS={none:"none",flying:"flying",done:"done"},e.SM_EVENT={Fly:"Fly",Finish:"Finish",Reset:"Reset"},e.m_Radian=0,e.m_Power=0,e.m_ActionCallback=null,e.m_Velocity=null,e.m_RotationSpeed=0,e.m_Gravity=0,e.m_FlyingScheduler=null,e}return i(e,t),e.prototype.GetNormalStarSprite=function(){return this.StarNormalSprite},e.prototype.OnCreate=function(){this.fsm=a.StateMachine.create({final:this.SM_STATUS.done,events:[{name:this.SM_EVENT.Fly,from:this.SM_STATUS.none,to:this.SM_STATUS.flying},{name:this.SM_EVENT.Finish,from:this.SM_STATUS.flying,to:this.SM_STATUS.done},{name:this.SM_EVENT.Reset,from:a.StateMachine.WILDCARD,to:this.SM_STATUS.none}],callbacks:{onenterstate:this.onEnterState.bind(this)}})},e.prototype.OnAllocate=function(){this.vm.ui=this},e.prototype.OnEnter=function(){this.SwitchToNormalSprite(),this.UpdateStarLabel()},e.prototype.OnExit=function(){this.fsm.Reset()},e.prototype.PlayNumberReduceEffect=function(){this.UpdateStarLabel(),this.SwitchToNormalSprite(),this.vm.clearCount>1&&cc.tween(this.StarLabel.node).to(.1,{scale:.9}).to(.3,{scale:1},{easing:cc.easing.backOut}).start()},e.prototype.UpdateStarLabel=function(){this.vm.typ==s.BlockPuzzle99.EBoardTileType.Star&&(this.StarLabel.string=""+this.vm.clearCount)},e.prototype.SwitchToNormalSprite=function(){this.NormalSprite.node.active=!0,this.HighlightSprite.node.active=!1,this.HighlightSprite.node.scale=1,this.StarHighlightSprite.node.active=!1,this.StarNormalSprite.node.active=this.vm.typ==s.BlockPuzzle99.EBoardTileType.Star,this.StarLabel.node.active=this.vm.typ==s.BlockPuzzle99.EBoardTileType.Star&&this.vm.clearCount>1},e.prototype.SwitchToHighlightSprite=function(){this.NormalSprite.node.active=!1,this.StarNormalSprite.node.active=!1,this.HighlightSprite.node.active=!0,this.HighlightSprite.node.scale=1.05,this.StarHighlightSprite.node.active=this.vm.typ==s.BlockPuzzle99.EBoardTileType.Star,this.StarLabel.node.active=this.vm.typ==s.BlockPuzzle99.EBoardTileType.Star&&this.vm.clearCount>1},e.prototype.RemoveFromBoard=function(t){if(this.vm.row===t.centerTile.row){var e=this.vm.col-t.centerTile.col,o=.5*Math.PI+Math.PI/3*(e/(s.BlockPuzzle99.Config.COL-1))+10*Math.random(),n=0;n=t.isEmbeddedTile?s.BlockPuzzle99.Config.EFFECT_POWER*(1-.1*Math.abs(e)):this.vm.col===s.BlockPuzzle99.Config.COL-1||0===this.vm.col?s.BlockPuzzle99.Config.EFFECT_POWER:s.BlockPuzzle99.Config.EFFECT_POWER*(.4+.1*Math.random()),this.RunRemoveFromBoardAction(o,n,null)}else{var i=this.vm.row-t.centerTile.row;o=.5*Math.PI+(Math.random()-.5)*Math.PI/3,n=0,n=t.isEmbeddedTile?s.BlockPuzzle99.Config.EFFECT_POWER*(1-.1*Math.abs(i)):s.BlockPuzzle99.Config.EFFECT_POWER*(.4+.1*Math.random()),this.RunRemoveFromBoardAction(o,n,null)}},e.prototype.RunRemoveFromBoardAction=function(t,e,o){this.m_Radian=t,this.m_Power=e,this.m_ActionCallback=o,this.fsm.Fly()},e.prototype.onEnterState=function(t,e,o){var n=this;switch(o){case this.SM_STATUS.none:this.node.angle=0;break;case this.SM_STATUS.flying:this.m_Velocity=cc.v2(0,0),this.m_Velocity.x=30*Math.sin(this.m_Radian),this.m_Velocity.y=this.m_Power*(.8+.2*Math.cos(this.m_Radian)),this.m_RotationSpeed=600*(.3+.7*Math.random()),this.m_Gravity=-5e3,this.m_FlyingScheduler=function(t){return n.__updatePerFrameForFlying(t)},this.schedule(this.m_FlyingScheduler,0,cc.macro.REPEAT_FOREVER);break;case this.SM_STATUS.done:this.m_ActionCallback&&this.m_ActionCallback(),this.Release();break;default:console.error("state: "+o+" no handled")}},e.prototype.__updatePerFrameForFlying=function(t){this.node.angle+=this.m_RotationSpeed*t,this.m_Velocity.y+=this.m_Gravity*t,this.node.x+=this.m_Velocity.x*t,this.node.y+=this.m_Velocity.y*t,this.node.convertToWorldSpaceAR(cc.Vec2.ZERO).y<-cc.winSize.height/3&&(this.unschedule(this.m_FlyingScheduler),this.m_FlyingScheduler=null,this.fsm.Finish())},r([p(cc.Sprite)],e.prototype,"NormalSprite",void 0),r([p(cc.Sprite)],e.prototype,"HighlightSprite",void 0),r([p(cc.Sprite)],e.prototype,"StarNormalSprite",void 0),r([p(cc.Sprite)],e.prototype,"StarHighlightSprite",void 0),r([p(cc.Label)],e.prototype,"StarLabel",void 0),r([u],e)}(c.gf.ReusableView);o.default=h,cc._RF.pop()},{"../../../GF/StateMachine":"StateMachine","../../../GF/core":"core","../BlockPuzzle99":"BlockPuzzle99"}],UIBP99Continue:[function(t,e,o){"use strict";cc._RF.push(e,"85e6bj62KpFzaUFnQowIkuW","UIBP99Continue");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.UIBP99ContinueModel=void 0;var c=t("../../BaseUIPop"),a=t("../../../GF/core"),s=t("../../../GF/ADService"),l=t("../BlockPuzzle99");o.UIBP99ContinueModel=function(t,e,o){this.game=t,this.onContinue=e,this.onNoThanks=o};var u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_TileRoot=null,e.m_Tiles=null,e}return i(e,t),e.prototype.EnterActionType=function(){return cc.easing.backOut},e.prototype.OnEnter=function(e){var o=this;t.prototype.OnEnter.call(this,e),this.m_Tiles=a.gf.stl.DLink.Allocate(),this.vm.game.board.tiles.For(function(t){var e=a.gf.ReusableView.Allocate(l.BlockPuzzle99.Prefabs.UIBP99LoseTile,t);o.SetTilePosition(e,e.vm.col,e.vm.row),o.m_TileRoot.addChild(e.node),e.Enter(),o.m_Tiles.enqueue(e)})},e.prototype.OnExit=function(){this.m_Tiles.release(function(t){return t.Release()}),t.prototype.OnExit.call(this)},e.prototype.SetTilePosition=function(t,e,o){t.node.x=(.5+e)*l.BlockPuzzle99.Config.TILE_WIDTH,t.node.y=(.5+o)*l.BlockPuzzle99.Config.TILE_HEIGHT},e.prototype.OnContinueClick=function(){var t=this;a.gf.audio.playDefaultEffect(),s.default.ShowRewardedVideo(function(e){t.ExitWithAction(function(){t.vm.onContinue(e)})})},e.prototype.OnClickNoThanks=function(){a.gf.audio.playDefaultEffect(),this.ExitWithAction(this.vm.onNoThanks)},r([h(cc.Node)],e.prototype,"m_TileRoot",void 0),r([a.gf.decorator.BlockInput(1)],e.prototype,"OnContinueClick",null),r([a.gf.decorator.BlockInput(1)],e.prototype,"OnClickNoThanks",null),r([p],e)}(c.default);o.default=f,cc._RF.pop()},{"../../../GF/ADService":"ADService","../../../GF/core":"core","../../BaseUIPop":"BaseUIPop","../BlockPuzzle99":"BlockPuzzle99"}],UIBP99DockItem:[function(t,e,o){"use strict";cc._RF.push(e,"5d224isxJdFgIfIgtehybO/","UIBP99DockItem");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GF/core"),a=t("../../Base/AudioConfig"),s=t("./UIBP99Block"),l=t("../BlockPuzzle99"),u=t("../../../GF/SDK/SDKMgr"),p=cc._decorator,h=p.ccclass,f=p.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.StartOrEndActionNode=null,e.MovingNode=null,e.ScaleNode=null,e.UIBlockRoot=null,e.VideoAvailableNode=null,e.BombButtonNode=null,e.BombActionNode=null,e.m_OriginScale=1,e.m_DockManager=null,e.m_WatchingAD=!1,e.m_IsBlockPlayingAction=!1,e.C_DRAG_TO_Y=180,e.C_DRAG_END_ACTION_TIME=.2,e}return i(e,t),Object.defineProperty(e.prototype,"IsPlayingAction",{get:function(){return this.m_IsBlockPlayingAction},enumerable:!1,configurable:!0}),e.prototype.GetUIBlock=function(){return this.UIBlockRoot.getComponentInChildren(s.default)},e.prototype.OnCreate=function(){this.m_OriginScale=this.ScaleNode.scale,this.BombActionNode.scale=.9;var t=cc.tween().to(1,{scale:1.2},{easing:cc.easing.backOut}).to(1,{scale:.9},{easing:cc.easing.backIn});cc.tween(this.BombActionNode).repeatForever(t).start()},e.prototype.OnAllocate=function(){this.vm.ui=this},e.prototype.OnEnter=function(t){var e=this;this.m_DockManager=t,this.BindTouch(),this.CreateNewBlock(!0),this.bindCallback(u.default.Ins.Channel.ADProxy.isRewardedVideoAvailableBV,function(t){return e.VideoAvailableNode.active=t||e.m_WatchingAD},!0)},e.prototype.OnExit=function(){cc.Tween.stopAllByTarget(this.MovingNode),this.MovingNode.position=cc.Vec3.ZERO,cc.Tween.stopAllByTarget(this.StartOrEndActionNode),this.StartOrEndActionNode.position=cc.Vec3.ZERO,cc.Tween.stopAllByTarget(this.ScaleNode),this.MovingNode.scale=this.m_OriginScale;var t=this.GetUIBlock();t&&t.Release(),this.UnbindTouch()},e.prototype.hasBlock=function(){return null!=this.vm.block},e.prototype.CreateNewBlock=function(t){var e=this;if(this.vm.block){var o=c.gf.ReusableView.Allocate(l.BlockPuzzle99.Prefabs.UIBP99Block,this.vm.block);o.node.position=cc.Vec3.ZERO,this.UIBlockRoot.addChild(o.node),o.Enter(),t?(this.UpdateDockStatus(),this.BombButtonNode.active=!1,this.m_IsBlockPlayingAction=!0,o.RunEnterAction(function(){e.m_IsBlockPlayingAction=!1,e.UpdateDockStatus()})):this.UpdateDockStatus()}else this.UpdateDockStatus()},e.prototype.UpdateDockStatus=function(){this.vm.block?(this.BombButtonNode.active=!this.vm.block.canEmbedded,this.GetUIBlock().UpdateDockStatus(this.vm.block.canEmbedded)):this.BombButtonNode.active=!1},e.prototype.OnBombClick=function(){var t=this;this.m_DockManager.IsBombClickable(this)&&u.default.Ins.Channel.ADProxy.IsRewardedVideoAvailable()&&(c.gf.audio.playDefaultEffect(),this.m_WatchingAD=!0,this.m_DockManager.OnBombClick(this,function(){t.m_WatchingAD=!1}))},e.prototype.RemoveBlock=function(t){void 0===t&&(t=!1);var e=this.GetUIBlock();e&&(this.m_IsBlockPlayingAction=!1,e.Release()),t&&(this.vm.block=null)},e.prototype.BindTouch=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.UnbindTouch=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.onTouchStart=function(t){return this.m_DockManager.OnItemTouchStart(this,t)},e.prototype.onTouchMove=function(t){this.m_DockManager.OnItemTouchMove(this,t)},e.prototype.onTouchEnd=function(t){this.m_DockManager.OnItemTouchEnd(this,t)},e.prototype.OnDragStart=function(t,e){var o=this;c.gf.audio.playEffect(a.HazelAudio.Audio.PICK_UP);var n=this.GetUIBlock();n.SwitchToDragSprite(),n.ShowPadding(!0),this.StartOrEndActionNode.y=this.C_DRAG_TO_Y,cc.Tween.stopAllByTarget(this.ScaleNode),this.ScaleNode.scale=.5,cc.tween(this.ScaleNode).to(.3,{scale:l.BlockPuzzle99.Config.DRAG_SCALE},{easing:cc.easing.elasticOut}).call(function(){e.UpdateWithUIDockItem(o)}).start()},e.prototype.OnDragMove=function(t,e){this.MovingNode.x+=t.getDelta().x,this.MovingNode.y+=t.getDelta().y,e.UpdateWithUIDockItem(this)},e.prototype.OnDragEnd=function(t,e){var o;cc.Tween.stopAllByTarget(this.MovingNode),cc.Tween.stopAllByTarget(this.StartOrEndActionNode),cc.Tween.stopAllByTarget(this.ScaleNode),e.HandleUIDockItemDragEnd(this)?((o=this.GetUIBlock()).Release(),this.vm.RemoveBlockDate(),this.MovingNode.x=0,this.MovingNode.y=0,this.StartOrEndActionNode.x=0,this.StartOrEndActionNode.y=0,this.ScaleNode.scale=this.m_OriginScale):((o=this.GetUIBlock()).ShowPadding(!1),o.SwitchToDockSprite(),cc.tween(this.MovingNode).to(this.C_DRAG_END_ACTION_TIME,{x:0,y:0}).start(),cc.tween(this.StartOrEndActionNode).to(this.C_DRAG_END_ACTION_TIME,{x:0,y:0}).start(),cc.tween(this.ScaleNode).to(this.C_DRAG_END_ACTION_TIME,{scale:this.m_OriginScale}).start())},r([f(cc.Node)],e.prototype,"StartOrEndActionNode",void 0),r([f(cc.Node)],e.prototype,"MovingNode",void 0),r([f(cc.Node)],e.prototype,"ScaleNode",void 0),r([f(cc.Node)],e.prototype,"UIBlockRoot",void 0),r([f(cc.Node)],e.prototype,"VideoAvailableNode",void 0),r([f(cc.Node)],e.prototype,"BombButtonNode",void 0),r([f(cc.Node)],e.prototype,"BombActionNode",void 0),r([c.gf.decorator.BlockInput(1)],e.prototype,"OnBombClick",null),r([h],e)}(c.gf.ReusableView);o.default=d,cc._RF.pop()},{"../../../GF/SDK/SDKMgr":"SDKMgr","../../../GF/core":"core","../../Base/AudioConfig":"AudioConfig","../BlockPuzzle99":"BlockPuzzle99","./UIBP99Block":"UIBP99Block"}],UIBP99DockManager:[function(t,e,o){"use strict";cc._RF.push(e,"3d948NWjVZAZIEDrq1Rj4cP","UIBP99DockManager");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GF/core"),a=t("../../Base/AudioConfig"),s=t("../BlockPuzzle99"),l=t("./UIBP99BoardManager"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_DockItemContainer=null,e.m_UIBoardManager=null,e.m_UIDockItemList=c.gf.stl.DLink.Allocate(),e.m_isTouchStart=!1,e.m_DragDockItem=null,e.m_Game=null,e.__HE_m_PreLoseSchduler=null,e.__HE_m_TickCount=0,e}return i(e,t),e.prototype.RemoveAllBlocks=function(){this.m_UIDockItemList.For(function(t){return t.RemoveBlock(!0)})},e.prototype.TopZOrder=function(t){this.m_UIDockItemList.For(function(e){return e.node.zIndex=e==t?1:0})},e.prototype.HandleStartEvent=function(t){var e=this;this.m_Game=t,t.docks.forEach(function(t,o){var n=c.gf.ReusableView.Allocate(s.BlockPuzzle99.Prefabs.UIBP99DockItem,t);n.node.x=210*(o-1),e.m_DockItemContainer.addChild(n.node),e.m_UIDockItemList.push(n),n.Enter(t,e)})},e.prototype.HandleQuitEvent=function(){this.m_UIDockItemList.removeAll(function(t){return t.Release()}),this.__HE_StopPreLoseScheduler()},e.prototype.HandleCreateNewBlocksEvent=function(){this.m_UIDockItemList.For(function(t){return t.CreateNewBlock(!0)})},e.prototype.HandleDockStatusUpdatedEvent=function(){this.m_UIDockItemList.For(function(t){return t.UpdateDockStatus()})},e.prototype.HandlePreLoseEvent=function(){this.__HE_StartPreLoseScheduler()},e.prototype.__HE_StartPreLoseScheduler=function(){var t=this;this.__HE_StopPreLoseScheduler(),c.gf.audio.playEffect(a.HazelAudio.Audio.CD),this.__HE_m_PreLoseSchduler=function(){c.gf.audio.playEffect(a.HazelAudio.Audio.CD),2==t.__HE_m_TickCount&&t.m_Game.Lose(),++t.__HE_m_TickCount},this.schedule(this.__HE_m_PreLoseSchduler,1,2)},e.prototype.__HE_StopPreLoseScheduler=function(){this.__HE_m_PreLoseSchduler&&(this.unschedule(this.__HE_m_PreLoseSchduler),this.__HE_m_PreLoseSchduler=null,this.__HE_m_TickCount=0)},e.prototype.IsBombClickable=function(t){return!this.m_isTouchStart&&t.hasBlock()&&!t.IsPlayingAction},e.prototype.OnBombClick=function(t,e){this.__HE_StopPreLoseScheduler(),this.m_Game.WatchADToBombBlock(t.vm,e)},e.prototype.OnItemTouchStart=function(t,e){return!(this.m_isTouchStart||!t.hasBlock()||t.IsPlayingAction||this.m_Game.IsStateNotDragable()||(this.m_isTouchStart=!0,this.m_DragDockItem=t,this.TopZOrder(t),t.OnDragStart(e,this.m_UIBoardManager),0))},e.prototype.OnItemTouchMove=function(t,e){this.m_isTouchStart&&t===this.m_DragDockItem&&t.OnDragMove(e,this.m_UIBoardManager)},e.prototype.OnItemTouchEnd=function(t,e){this.m_isTouchStart&&t===this.m_DragDockItem&&(this.m_DragDockItem=null,this.m_isTouchStart=!1,t.OnDragEnd(e,this.m_UIBoardManager))},r([h(cc.Node)],e.prototype,"m_DockItemContainer",void 0),r([h(l.default)],e.prototype,"m_UIBoardManager",void 0),r([p],e)}(c.gf.View);o.default=f,cc._RF.pop()},{"../../../GF/core":"core","../../Base/AudioConfig":"AudioConfig","../BlockPuzzle99":"BlockPuzzle99","./UIBP99BoardManager":"UIBP99BoardManager"}],UIBP99DockTile:[function(t,e,o){"use strict";cc._RF.push(e,"c2144NggB5JcZK8Of1iCYpJ","UIBP99DockTile");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GF/core"),a=cc._decorator,s=a.ccclass,l=a.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.DockSprite=null,e.m_DockSpriteFrame=null,e.m_DragSpriteFrame=null,e.m_HighlightSpriteFrame=null,e.m_DisableSpriteFrame=null,e}return i(e,t),e.prototype.OnCreate=function(){},e.prototype.OnAllocate=function(){this.vm.ui=this},e.prototype.OnEnter=function(){this.SwitchToDockSprite()},e.prototype.OnExit=function(){},e.prototype.SwitchToDockSprite=function(){this.DockSprite.spriteFrame=this.m_DockSpriteFrame,this.__SetSpriteWH(36,37)},e.prototype.SwitchToDragSprite=function(){this.DockSprite.spriteFrame=this.m_DragSpriteFrame,this.__SetSpriteWH(64,64)},e.prototype.SwitchToDisableSprite=function(){this.DockSprite.spriteFrame=this.m_DisableSpriteFrame,this.__SetSpriteWH(36,37)},e.prototype.SwitchToHighlightSprite=function(){this.DockSprite.spriteFrame=this.m_HighlightSpriteFrame,this.__SetSpriteWH(58,58)},e.prototype.__SetSpriteWH=function(t,e){this.DockSprite.node.width=t,this.DockSprite.node.height=e},r([l(cc.Sprite)],e.prototype,"DockSprite",void 0),r([l(cc.SpriteFrame)],e.prototype,"m_DockSpriteFrame",void 0),r([l(cc.SpriteFrame)],e.prototype,"m_DragSpriteFrame",void 0),r([l(cc.SpriteFrame)],e.prototype,"m_HighlightSpriteFrame",void 0),r([l(cc.SpriteFrame)],e.prototype,"m_DisableSpriteFrame",void 0),r([s],e)}(c.gf.ReusableView);o.default=u,cc._RF.pop()},{"../../../GF/core":"core"}],UIBP99GameOver:[function(t,e,o){"use strict";cc._RF.push(e,"f9371USWbdCTrOeCgQcN6V8","UIBP99GameOver");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.UIBP99GameOverModel=void 0;var c=t("../../BaseUIPop"),a=t("../../../GF/core"),s=t("../BlockPuzzle99");o.UIBP99GameOverModel=function(t,e,o,n){this.game=t,this.remainStarCount=e,this.onReplay=o,this.onContinue=n};var l=cc._decorator,u=l.ccclass,p=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_TileRoot=null,e.m_RemainStarCountLabel=null,e.m_Tiles=null,e}return i(e,t),e.prototype.EnterActionType=function(){return cc.easing.backOut},e.prototype.OnEnter=function(e){var o=this;t.prototype.OnEnter.call(this,e),this.m_Tiles=a.gf.stl.DLink.Allocate(),this.m_RemainStarCountLabel.string=""+this.vm.remainStarCount,this.vm.game.board.tiles.For(function(t){var e=a.gf.ReusableView.Allocate(s.BlockPuzzle99.Prefabs.UIBP99LoseTile,t);o.SetTilePosition(e,e.vm.col,e.vm.row),o.m_TileRoot.addChild(e.node),e.Enter(),o.m_Tiles.enqueue(e)})},e.prototype.OnExit=function(){this.m_Tiles.release(function(t){return t.Release()}),t.prototype.OnExit.call(this)},e.prototype.SetTilePosition=function(t,e,o){t.node.x=(.5+e)*s.BlockPuzzle99.Config.TILE_WIDTH,t.node.y=(.5+o)*s.BlockPuzzle99.Config.TILE_HEIGHT},e.prototype.OnReplayClick=function(){a.gf.audio.playDefaultEffect(),this.ExitWithAction(this.vm.onReplay)},e.prototype.OnContinueClick=function(){a.gf.audio.playDefaultEffect(),this.ExitWithAction(this.vm.onContinue)},r([p(cc.Node)],e.prototype,"m_TileRoot",void 0),r([p(cc.Label)],e.prototype,"m_RemainStarCountLabel",void 0),r([a.gf.decorator.BlockInput(1)],e.prototype,"OnReplayClick",null),r([a.gf.decorator.BlockInput(1)],e.prototype,"OnContinueClick",null),r([u],e)}(c.default);o.default=h,cc._RF.pop()},{"../../../GF/core":"core","../../BaseUIPop":"BaseUIPop","../BlockPuzzle99":"BlockPuzzle99"}],UIBP99Goal:[function(t,e,o){"use strict";cc._RF.push(e,"c7672pWZMlL2YIAIi6rDk1n","UIBP99Goal");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.UIBP99GoalModel=void 0;var c=t("../../BaseUIPop");o.UIBP99GoalModel=function(t,e){this.stars=t,this.onClose=e};var a=cc._decorator,s=a.ccclass,l=a.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_StarLabel=null,e}return i(e,t),e.prototype.EnterActionType=function(){return cc.easing.backOut},e.prototype.OnEnter=function(e){var o=this;t.prototype.OnEnter.call(this,e),this.m_StarLabel.string=""+this.vm.stars,this.scheduleOnce(function(){o.ExitWithAction(o.vm.onClose,!0)},2)},r([l(cc.Label)],e.prototype,"m_StarLabel",void 0),r([s],e)}(c.default);o.default=u,cc._RF.pop()},{"../../BaseUIPop":"BaseUIPop"}],UIBP99LoseTile:[function(t,e,o){"use strict";cc._RF.push(e,"041478hNeJI7Kl6DZd+qHa8","UIBP99LoseTile");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../BlockPuzzle99"),a=t("../../../GF/core"),s=cc._decorator,l=s.ccclass,u=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.NormalSprite=null,e.StarNormalSprite=null,e.StarLabel=null,e}return i(e,t),e.prototype.OnCreate=function(){},e.prototype.OnAllocate=function(){},e.prototype.OnEnter=function(){this.SwitchToNormalSprite(),this.UpdateStarLabel()},e.prototype.OnExit=function(){},e.prototype.UpdateStarLabel=function(){this.vm.typ==c.BlockPuzzle99.EBoardTileType.Star&&(this.StarLabel.string=""+this.vm.clearCount)},e.prototype.SwitchToNormalSprite=function(){this.NormalSprite.node.active=!0,this.StarNormalSprite.node.active=this.vm.typ==c.BlockPuzzle99.EBoardTileType.Star,this.StarLabel.node.active=this.vm.typ==c.BlockPuzzle99.EBoardTileType.Star&&this.vm.clearCount>1},r([u(cc.Sprite)],e.prototype,"NormalSprite",void 0),r([u(cc.Sprite)],e.prototype,"StarNormalSprite",void 0),r([u(cc.Label)],e.prototype,"StarLabel",void 0),r([l],e)}(a.gf.ReusableView);o.default=p,cc._RF.pop()},{"../../../GF/core":"core","../BlockPuzzle99":"BlockPuzzle99"}],UIBP99ScoreEffect:[function(t,e,o){"use strict";cc._RF.push(e,"1cd85NooFRGrZ2/eXhIU7Mv","UIBP99ScoreEffect");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.UIBP99ScoreEffectModel=void 0;var c=t("../../../GF/core"),a=t("../../../GF/StateMachine"),s=function(){function t(t){void 0===t&&(t=0),this.score=t,this.m_Level=-1,this.UpdateLevel()}return t.prototype.UpdateLevel=function(){this.m_Level=-1;for(var t=0;t<5;++t)this.score>=10*(2*t+3)&&(this.m_Level=t)},t.prototype.HasLevelEffect=function(){return this.m_Level>=0},t.prototype.HasScoreEffect=function(){return this.score>=10},Object.defineProperty(t.prototype,"Level",{get:function(){return this.m_Level},enumerable:!1,configurable:!0}),t}();o.UIBP99ScoreEffectModel=s;var l=cc._decorator,u=l.ccclass,p=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_LevelSprite=null,e.m_SpriteFrames=[],e.m_ScoreEffect=null,e.m_ScoreLabel=null,e.fsm=null,e.SM_STATUS={none:"none",flying:"flying",done:"done"},e.SM_EVENT={Fly:"Fly",Finish:"Finish",Reset:"Reset"},e.m_Radian=0,e.m_Power=0,e.m_ActionCallback=null,e.m_Velocity=null,e.m_RotationSpeed=0,e.m_Gravity=0,e.m_FlyingScheduler=null,e}return i(e,t),Object.defineProperty(e.prototype,"LEVEL",{get:function(){return this.m_SpriteFrames.length},enumerable:!1,configurable:!0}),e.prototype.OnCreate=function(){this.fsm=a.StateMachine.create({final:this.SM_STATUS.done,events:[{name:this.SM_EVENT.Fly,from:this.SM_STATUS.none,to:this.SM_STATUS.flying},{name:this.SM_EVENT.Finish,from:this.SM_STATUS.flying,to:this.SM_STATUS.done},{name:this.SM_EVENT.Reset,from:a.StateMachine.WILDCARD,to:this.SM_STATUS.none}],callbacks:{onenterstate:this.onEnterState.bind(this)}})},e.prototype.OnAllocate=function(){},e.prototype.OnEnter=function(){},e.prototype.OnExit=function(){this.fsm.Reset()},e.prototype.RunLevelEffect=function(){this.node.scale=.1,this.m_ScoreEffect.active=!1,this.m_LevelSprite.node.active=!0,this.m_LevelSprite.spriteFrame=this.m_SpriteFrames[this.vm.Level],this.m_Gravity=-2600,this.RunRemoveFromBoardAction(Math.PI*(.5+.2*(.5-Math.random())),1400,null),c.gf.platform.Vibrate.vibrateNormal()},e.prototype.RunScoreEffect=function(){this.m_ScoreLabel.string="+"+10*Math.floor(.1*this.vm.score),this.m_ScoreEffect.active=!0,this.m_LevelSprite.node.active=!1,this.node.scale=1,this.m_Gravity=-2500,this.RunRemoveFromBoardAction(Math.PI*(.5+.1*(.5-Math.random())),1200,null)},e.prototype.RunRemoveFromBoardAction=function(t,e,o){this.m_Radian=t,this.m_Power=e,this.m_ActionCallback=o,this.fsm.Fly()},e.prototype.onEnterState=function(t,e,o){var n=this;switch(o){case this.SM_STATUS.none:this.node.angle=0;break;case this.SM_STATUS.flying:this.m_Velocity=cc.v2(0,0),this.m_Velocity.x=30*Math.sin(this.m_Radian),this.m_Velocity.y=this.m_Power*(.8+.2*Math.cos(this.m_Radian)),this.m_RotationSpeed=20*(.3+.7*Math.random()),this.m_FlyingScheduler=function(t){return n.__updatePerFrameForFlying(t)},this.schedule(this.m_FlyingScheduler,0,cc.macro.REPEAT_FOREVER),cc.tween(this.node).to(.3,{scale:1},{easing:cc.easing.backOut}).start();break;case this.SM_STATUS.done:this.m_ActionCallback&&this.m_ActionCallback(),this.Release();break;default:console.error("state: "+o+" no handled")}},e.prototype.__updatePerFrameForFlying=function(t){this.node.angle+=this.m_RotationSpeed*t,this.m_Velocity.y+=this.m_Gravity*t,this.node.x+=this.m_Velocity.x*t,this.node.y+=this.m_Velocity.y*t,this.node.convertToWorldSpaceAR(cc.Vec2.ZERO).y<-cc.winSize.height/3&&(this.unschedule(this.m_FlyingScheduler),this.m_FlyingScheduler=null,this.fsm.Finish())},r([p(cc.Sprite)],e.prototype,"m_LevelSprite",void 0),r([p([cc.SpriteFrame])],e.prototype,"m_SpriteFrames",void 0),r([p(cc.Node)],e.prototype,"m_ScoreEffect",void 0),r([p(cc.Label)],e.prototype,"m_ScoreLabel",void 0),r([u],e)}(c.gf.ReusableView);o.default=h,cc._RF.pop()},{"../../../GF/StateMachine":"StateMachine","../../../GF/core":"core"}],UIBP99ShadowTile:[function(t,e,o){"use strict";cc._RF.push(e,"866d678He9NxIeOFtrgMj/u","UIBP99ShadowTile");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GF/core"),a=cc._decorator,s=a.ccclass,l=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.OnCreate=function(){},e.prototype.OnAllocate=function(){},e.prototype.OnEnter=function(){},e.prototype.OnExit=function(){},r([s],e)}(c.gf.ReusableView));o.default=l,cc._RF.pop()},{"../../../GF/core":"core"}],UIBP99TipTile:[function(t,e,o){"use strict";cc._RF.push(e,"d9137eeD/tDdaIOUERlVsYm","UIBP99TipTile");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GF/core"),a=cc._decorator,s=a.ccclass,l=a.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_SpriteNode=null,e}return i(e,t),e.prototype.OnCreate=function(){},e.prototype.OnAllocate=function(){},e.prototype.OnEnter=function(){},e.prototype.OnExit=function(){},e.prototype.RunTipAction=function(){this.m_SpriteNode.opacity=0;var t=cc.tween(this.m_SpriteNode).to(1,{opacity:255}).to(1,{opacity:0});cc.tween(this.m_SpriteNode).repeatForever(t).start()},e.prototype.StopTipAction=function(){cc.Tween.stopAllByTarget(this.m_SpriteNode)},r([l(cc.Node)],e.prototype,"m_SpriteNode",void 0),r([s],e)}(c.gf.ReusableView);o.default=u,cc._RF.pop()},{"../../../GF/core":"core"}],UIBP99Win:[function(t,e,o){"use strict";cc._RF.push(e,"4077addEc5NNo69K1RtPa7l","UIBP99Win");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.UIBP99WinModel=void 0;var c=t("../../BaseUIPop"),a=t("../../../GF/core");o.UIBP99WinModel=function(t,e,o,n){this.summaryStars=t,this.score=e,this.onReplay=o,this.onContinue=n};var s=cc._decorator,l=s.ccclass,u=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_SummaryStarsLabel=null,e.m_ScoreLabel=null,e}return i(e,t),e.prototype.EnterActionType=function(){return cc.easing.backOut},e.prototype.OnEnter=function(e){t.prototype.OnEnter.call(this,e),this.m_SummaryStarsLabel.string=""+this.vm.summaryStars,this.m_ScoreLabel.string=""+this.vm.score},e.prototype.OnReplayClick=function(){a.gf.audio.playDefaultEffect(),this.ExitWithAction(this.vm.onReplay)},e.prototype.OnContinueClick=function(){a.gf.audio.playDefaultEffect(),this.ExitWithAction(this.vm.onContinue)},r([u(cc.Label)],e.prototype,"m_SummaryStarsLabel",void 0),r([u(cc.Label)],e.prototype,"m_ScoreLabel",void 0),r([a.gf.decorator.BlockInput(1)],e.prototype,"OnReplayClick",null),r([a.gf.decorator.BlockInput(1)],e.prototype,"OnContinueClick",null),r([l],e)}(c.default);o.default=p,cc._RF.pop()},{"../../../GF/core":"core","../../BaseUIPop":"BaseUIPop"}],UIBlock:[function(t,e,o){"use strict";cc._RF.push(e,"43f78QrH/hGXo0f2vVtIn2c","UIBlock");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../App/BlockPuzzleScene/BlockPuzzle"),a=t("../../../GF/core"),s=cc._decorator,l=s.ccclass,u=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_UITileList=null,e.m_OffsetCol=null,e.m_OffsetRow=null,e}return i(e,t),e.prototype.OnCreate=function(){},e.prototype.OnAllocate=function(){this.m_UITileList=a.gf.stl.DLink.Allocate(),this.m_OffsetCol=.5*-(this.vm.blockData.width-1),this.m_OffsetRow=.5*-(this.vm.blockData.height-1)},e.prototype.OnEnter=function(){var t=this;this.vm.blockData.tiles.forEach(function(e){return t.CreateUITile(e),!1})},e.prototype.OnExit=function(){this.m_UITileList.removeAll(function(t){return t.Release()})},e.prototype.RunEnterAction=function(t){this.node.x=900,cc.tween(this.node).to(.4,{position:cc.Vec3.ZERO},{easing:cc.easing.cubicOut}).call(t).start()},e.prototype.CreateUITile=function(t){var e=a.gf.ReusableView.Allocate(c.BlockPuzzle.Prefabs.UIDockTile,t);this.node.addChild(e.node);var o=this.GetColRowPosition(t.col,t.row,0);e.node.x=o.x,e.node.y=o.y,e.node.zIndex=16-4*t.row-t.col,this.m_UITileList.enqueue(e)},e.prototype.UpdateDockStatus=function(t){t?this.forEachTile(function(t){return t.SwitchToDockSprite()}):this.forEachTile(function(t){return t.SwitchToDisableSprite()})},e.prototype.forEachTile=function(t){this.m_UITileList.For(t)},e.prototype.GetOriginWorldPosition=function(){var t=this.GetColRowPosition(0,0,0);return this.node.convertToWorldSpaceAR(t)},e.prototype.GetColRowPosition=function(t,e,o){var n=(this.m_OffsetCol+t)*(c.BlockPuzzle.Config.DOCK_TILE_WIDTH+o),i=(this.m_OffsetRow+e)*(c.BlockPuzzle.Config.DOCK_TILE_HEIGHT+o);return cc.v2(n,i)},e.prototype.SwitchToDockSprite=function(){this.forEachTile(function(t){return t.SwitchToDockSprite()})},e.prototype.SwitchToNormalSprite=function(){this.forEachTile(function(t){return t.SwitchToNormalSprite()})},e.prototype.SwitchToHighlightSprite=function(){this.forEachTile(function(t){return t.SwitchToHighlightSprite()})},e.prototype.ShowPadding=function(t){var e=this,o=t?c.BlockPuzzle.Config.DRAG_PADDING:0;this.forEachTile(function(t){var n=e.GetColRowPosition(t.vm.col,t.vm.row,o);t.node.x=n.x,t.node.y=n.y})},r([l],e)}(a.gf.ReusableView));o.default=u,cc._RF.pop()},{"../../../App/BlockPuzzleScene/BlockPuzzle":"BlockPuzzle","../../../GF/core":"core"}],UIBoardManager:[function(t,e,o){"use strict";cc._RF.push(e,"50363MfKJVPUp7FyZ8vdjEl","UIBoardManager");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../BlockPuzzle"),a=t("../../../GF/core"),s=t("./UIScoreEffect"),l=t("../../Base/AudioConfig"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ShadowTileRoot=null,e.TipTileRoot=null,e.TileRoot=null,e.m_EffectRoot=null,e.m_ShadowTileLinkList=a.gf.stl.DLink.Allocate(),e.m_TipTileLinkList=a.gf.stl.DLink.Allocate(),e.m_IsDragging=!1,e.vm=null,e.m_PreCol=null,e.m_PreRow=null,e.C_EMBEDED_TIME=.1,e}return i(e,t),e.prototype.start=function(){this.__InitTipTiles()},Object.defineProperty(e.prototype,"game",{get:function(){return this.vm.game},enumerable:!1,configurable:!0}),e.prototype.HandleStartEvent=function(t){this.vm=t.board,this.ResizeShadowTileLinkList(9),this.ResizeTipTileLinkList(9),this.CreateUITiles(),this.TryToShowTipTile()},e.prototype.HandleQuitEvent=function(){this.m_ShadowTileLinkList.release(function(t){return t.Release()}),this.m_TipTileLinkList.release(function(t){return t.Release()}),this.game.board.release()},e.prototype.CreateUITiles=function(){var t=this;this.vm.tiles.For(function(e){var o=t.CreateUIBoardTile(e);t.SetTilePosition(o,o.vm.col,o.vm.row)})},e.prototype.Continue=function(){var t=this,e=a.gf.stl.DLink.Allocate();this.vm.game.Continue(e),e.size()>0?(a.gf.audio.playEffect(l.HazelAudio.Audio.CLEAR_0),e.removeAll(function(e){a.gf.ui.moveNodeToTargetParent(e.boardTile.ui.node,t.m_EffectRoot,!1),e.boardTile.ui.RemoveFromBoard(e)}),this.vm.game.UpdateDockStatus()):this.vm.game.UpdateDockStatus(),e.release()},e.prototype.RestartGame=function(){var t=this,e=a.gf.stl.DLink.Allocate();this.vm.RemoveAllTiles(e),e.size()>0?(a.gf.audio.playEffect(l.HazelAudio.Audio.CLEAR_0),e.removeAll(function(e){a.gf.ui.moveNodeToTargetParent(e.boardTile.ui.node,t.m_EffectRoot,!1),e.boardTile.ui.RemoveFromBoard(e)}),this.vm.game.UpdateDockStatus()):this.vm.game.UpdateDockStatus(),e.release()},e.prototype.AllocateShadowTile=function(){var t=a.gf.ReusableView.Allocate(c.BlockPuzzle.Prefabs.UIShadowTile);this.ShadowTileRoot.addChild(t.node),t.Enter(),t.node.active=!1,this.m_ShadowTileLinkList.enqueue(t)},e.prototype.ResizeShadowTileLinkList=function(t){if(this.m_ShadowTileLinkList.size()<t)for(var e=t-this.m_ShadowTileLinkList.size();e>0;--e)this.AllocateShadowTile()},e.prototype.SetTilePosition=function(t,e,o){t.node.x=(.5+e)*c.BlockPuzzle.Config.TILE_WIDTH,t.node.y=(.5+o)*c.BlockPuzzle.Config.TILE_HEIGHT},e.prototype.GetTilePosition=function(t,e){return cc.v3((.5+t)*c.BlockPuzzle.Config.TILE_WIDTH,(.5+e)*c.BlockPuzzle.Config.TILE_HEIGHT,0)},e.prototype.CalculateOriginColAndRow=function(t){var e=t.GetOriginWorldPosition(),o=this.ShadowTileRoot.convertToNodeSpaceAR(e),n=Math.floor(o.x/c.BlockPuzzle.Config.TILE_WIDTH),i=Math.floor(o.y/c.BlockPuzzle.Config.TILE_HEIGHT);return cc.v2(n,i)},e.prototype.UpdateWithUIDockItem=function(t){var e=this,o=t.GetUIBlock();this.m_IsDragging||(this.m_IsDragging=!0,this.ShowTileTip(!1));var n=this.CalculateOriginColAndRow(o);if(this.m_PreCol!==n.x||this.m_PreRow!==n.y){this.m_PreCol=n.x,this.m_PreRow=n.y;var i=o.vm.blockData.tiles,r=this.game.IsEmbedable(i,this.m_PreCol,this.m_PreRow);if(this.m_ShadowTileLinkList.For(function(t){t.node.active=!1}),r)for(var c=function(t){var o=i[t];a.m_ShadowTileLinkList.dequeue(function(t){t.node.active=!0,e.SetTilePosition(t,e.m_PreCol+o.col,e.m_PreRow+o.row),e.m_ShadowTileLinkList.enqueue(t)})},a=this,s=0;s<i.length;++s)c(s);this.HighlightClearableBoardTilesOnDrag(i)}},e.prototype.HandleUIDockItemDragEnd=function(t){var e=this;this.m_IsDragging=!1,this.m_PreCol=null,this.m_PreRow=null,this.m_ShadowTileLinkList.For(function(t){return t.node.active=!1});var o=t.GetUIBlock(),n=this.CalculateOriginColAndRow(o),i=o.node.convertToWorldSpaceAR(cc.Vec2.ZERO),r=o.vm.blockData.tiles,s=this.game.IsEmbedable(r,n.x,n.y);if(s){a.gf.audio.playEffect(l.HazelAudio.Audio.PUT_DOWN);var u=a.gf.stl.DLink.Allocate();this.game.EmbeddedBlock(o.vm,n.x,n.y,u);var p=a.gf.stl.DLink.Allocate();u.For(function(t){var o=e.CreateUIBoardTile(t),n=e.TileRoot.convertToNodeSpaceAR(t.dockTile.ui.node.convertToWorldSpaceAR(cc.Vec3.ZERO));o.node.position=n,o.node.scale=c.BlockPuzzle.Config.DRAG_SCALE,p.enqueue(o)});var h=a.gf.util.CallAfterCount(function(){var t=new c.BlockPuzzle.EmbeddedInfo;e.game.OnEmbedded(u,t),u.removeAll(),t.clearTiles.size()>0?(a.gf.audio.playEffect(l.HazelAudio.Audio.CLEAR_0),t.clearTiles.removeAll(function(t){t.boardTile.ui.SwitchToNormalSprite(),a.gf.ui.moveNodeToTargetParent(t.boardTile.ui.node,e.m_EffectRoot,!1),t.boardTile.ui.RemoveFromBoard(t)}),e.PlayScoreEffect(i,e.m_EffectRoot,t.Score),e.vm.game.UpdateDockStatus(),e.TryToShowTipTile()):(e.vm.game.UpdateDockStatus(),e.TryToShowTipTile()),t.release()},p.size());p.For(function(t){var o=e.GetTilePosition(t.vm.col,t.vm.row);cc.tween(t.node).to(e.C_EMBEDED_TIME,{position:o,scale:1}).call(h).start()}),p.removeAll()}else this.vm.tiles.For(function(t){return t.ui.SwitchToNormalSprite()}),this.TryToShowTipTile();return s},e.prototype.CreateUIBoardTile=function(t){var e=a.gf.ReusableView.Allocate(c.BlockPuzzle.Prefabs.UIBoardTile,t);return this.TileRoot.addChild(e.node),e.Enter(),e},e.prototype.PlayScoreEffect=function(t,e,o){var n=new s.UIScoreEffectModel(o);if(n.HasScoreEffect()){t.x>400?t.x=400:t.x<240&&(t.x=240);var i=cc.v2(t.x+60*(1+Math.random()),t.y-10*Math.random()),r=a.gf.ReusableView.Allocate(c.BlockPuzzle.Prefabs.UIScoreEffect,n);if(r.node.setPosition(e.convertToNodeSpaceAR(i)),e.addChild(r.node),r.Enter(),r.RunScoreEffect(),n.HasLevelEffect()){var l=cc.v2(t.x-60*(1+Math.random()),t.y+10*Math.random()),u=a.gf.ReusableView.Allocate(c.BlockPuzzle.Prefabs.UIScoreEffect,n);u.node.setPosition(e.convertToNodeSpaceAR(l)),e.addChild(u.node),u.Enter(),u.RunLevelEffect()}}},e.prototype.HighlightClearableBoardTilesOnDrag=function(t){if(this.vm.tiles.For(function(t){return t.ui.SwitchToNormalSprite()}),t.forEach(function(t){return t.ui.SwitchToNormalSprite()}),this.game.IsEmbedable(t,this.m_PreCol,this.m_PreRow)){var e=a.gf.stl.DLink.Allocate(),o=a.gf.stl.DLink.Allocate();this.game.IsClearable(t,this.m_PreCol,this.m_PreRow,e,o)&&(e.For(function(t){return t.ui.SwitchToHighlightSprite()}),o.For(function(t){return t.ui.SwitchToHighlightSprite()})),o.release(),e.release()}},e.prototype.__InitTipTiles=function(){this.ShowTileTip(!1)},e.prototype.ShowTileTip=function(t){this.TipTileRoot.active=t},e.prototype.TryToShowTipTile=function(){var t=this,e=new c.BlockPuzzle.TipInfo,o=this.game.IsAnyActiveBlockOnlyOnePosition(e);if(o){this.m_TipTileLinkList.For(function(t){t.node.active=!1,t.StopTipAction()});for(var n=e.block.blockData.tiles,i=function(o){var i=n[o];r.m_TipTileLinkList.dequeue(function(o){o.node.active=!0,t.SetTilePosition(o,e.col+i.col,e.row+i.row),t.m_TipTileLinkList.enqueue(o),o.RunTipAction()})},r=this,a=0;a<n.length;++a)i(a)}this.ShowTileTip(o)},e.prototype.AllocateTipTile=function(){var t=a.gf.ReusableView.Allocate(c.BlockPuzzle.Prefabs.UITipTile);this.TipTileRoot.addChild(t.node),t.Enter(),t.node.active=!1,this.m_TipTileLinkList.enqueue(t)},e.prototype.ResizeTipTileLinkList=function(t){if(this.m_TipTileLinkList.size()<t)for(var e=t-this.m_TipTileLinkList.size();e>0;--e)this.AllocateTipTile()},r([h(cc.Node)],e.prototype,"ShadowTileRoot",void 0),r([h(cc.Node)],e.prototype,"TipTileRoot",void 0),r([h(cc.Node)],e.prototype,"TileRoot",void 0),r([h(cc.Node)],e.prototype,"m_EffectRoot",void 0),r([p],e)}(a.gf.View);o.default=f,cc._RF.pop()},{"../../../GF/core":"core","../../Base/AudioConfig":"AudioConfig","../BlockPuzzle":"BlockPuzzle","./UIScoreEffect":"UIScoreEffect"}],UIBoardTile:[function(t,e,o){"use strict";cc._RF.push(e,"0c9f5jaCv1O5ILcegVel7Q6","UIBoardTile");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GF/core"),a=t("../BlockPuzzle"),s=t("../../../GF/StateMachine"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.NormalSprite=null,e.HighlightSprite=null,e.fsm=null,e.SM_STATUS={none:"none",flying:"flying",done:"done"},e.SM_EVENT={Fly:"Fly",Finish:"Finish",Reset:"Reset"},e.m_Radian=0,e.m_Power=0,e.m_ActionCallback=null,e.m_Velocity=null,e.m_RotationSpeed=0,e.m_Gravity=0,e.m_FlyingScheduler=null,e}return i(e,t),e.prototype.OnCreate=function(){this.fsm=s.StateMachine.create({final:this.SM_STATUS.done,events:[{name:this.SM_EVENT.Fly,from:this.SM_STATUS.none,to:this.SM_STATUS.flying},{name:this.SM_EVENT.Finish,from:this.SM_STATUS.flying,to:this.SM_STATUS.done},{name:this.SM_EVENT.Reset,from:s.StateMachine.WILDCARD,to:this.SM_STATUS.none}],callbacks:{onenterstate:this.onEnterState.bind(this)}})},e.prototype.OnAllocate=function(){this.vm.ui=this},e.prototype.OnEnter=function(){this.SwitchToNormalSprite()},e.prototype.OnExit=function(){this.fsm.Reset()},e.prototype.SwitchToNormalSprite=function(){this.NormalSprite.node.active=!0,this.HighlightSprite.node.active=!1,this.HighlightSprite.node.scale=1},e.prototype.SwitchToHighlightSprite=function(){this.NormalSprite.node.active=!1,this.HighlightSprite.node.active=!0,this.HighlightSprite.node.scale=1.05},e.prototype.RemoveFromBoard=function(t){if(this.vm.row===t.centerTile.row){var e=this.vm.col-t.centerTile.col,o=.5*Math.PI+Math.PI/3*(e/(a.BlockPuzzle.Config.COL-1))+10*Math.random(),n=0;n=t.isEmbeddedTile?a.BlockPuzzle.Config.EFFECT_POWER*(1-.1*Math.abs(e)):this.vm.col===a.BlockPuzzle.Config.COL-1||0===this.vm.col?a.BlockPuzzle.Config.EFFECT_POWER:a.BlockPuzzle.Config.EFFECT_POWER*(.4+.1*Math.random()),this.RunRemoveFromBoardAction(o,n,null)}else{var i=this.vm.row-t.centerTile.row;o=.5*Math.PI+(Math.random()-.5)*Math.PI/3,n=0,n=t.isEmbeddedTile?a.BlockPuzzle.Config.EFFECT_POWER*(1-.1*Math.abs(i)):a.BlockPuzzle.Config.EFFECT_POWER*(.4+.1*Math.random()),this.RunRemoveFromBoardAction(o,n,null)}},e.prototype.RunRemoveFromBoardAction=function(t,e,o){this.m_Radian=t,this.m_Power=e,this.m_ActionCallback=o,this.fsm.Fly()},e.prototype.onEnterState=function(t,e,o){var n=this;switch(o){case this.SM_STATUS.none:this.node.angle=0;break;case this.SM_STATUS.flying:this.m_Velocity=cc.v2(0,0),this.m_Velocity.x=30*Math.sin(this.m_Radian),this.m_Velocity.y=this.m_Power*(.8+.2*Math.cos(this.m_Radian)),this.m_RotationSpeed=600*(.3+.7*Math.random()),this.m_Gravity=-5e3,this.m_FlyingScheduler=function(t){return n.__updatePerFrameForFlying(t)},this.schedule(this.m_FlyingScheduler,0,cc.macro.REPEAT_FOREVER);break;case this.SM_STATUS.done:this.m_ActionCallback&&this.m_ActionCallback(),this.Release();break;default:console.error("state: "+o+" no handled")}},e.prototype.__updatePerFrameForFlying=function(t){this.node.angle+=this.m_RotationSpeed*t,this.m_Velocity.y+=this.m_Gravity*t,this.node.x+=this.m_Velocity.x*t,this.node.y+=this.m_Velocity.y*t,this.node.convertToWorldSpaceAR(cc.Vec2.ZERO).y<-cc.winSize.height/3&&(this.unschedule(this.m_FlyingScheduler),this.m_FlyingScheduler=null,this.fsm.Finish())},r([p(cc.Sprite)],e.prototype,"NormalSprite",void 0),r([p(cc.Sprite)],e.prototype,"HighlightSprite",void 0),r([u],e)}(c.gf.ReusableView);o.default=h,cc._RF.pop()},{"../../../GF/StateMachine":"StateMachine","../../../GF/core":"core","../BlockPuzzle":"BlockPuzzle"}],UIContinue:[function(t,e,o){"use strict";cc._RF.push(e,"9c8fe3FaI5OoK75bg9vjr1r","UIContinue");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.UIContinueModel=void 0;var c=t("../../../GF/core"),a=t("../../../GF/Component/CountDownSprite"),s=t("../../../GF/ADService"),l=t("../AudioConfig");o.UIContinueModel=function(t,e){this.score=t,this.watchADCallback=e};var u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_Background=null,e.m_ActionNode=null,e.m_CountDownSprite=null,e.m_ProgressSprite=null,e.m_ScoreLabel=null,e.m_OriginActionNodePosition=null,e.m_OriginBackgroundOpacity=null,e.m_HandleLock=!1,e}return i(e,t),e.prototype.SetProgress=function(t){this.m_ProgressSprite.fillRange=1-t},e.prototype.OnCreate=function(){this.m_OriginActionNodePosition=this.m_ActionNode.position,this.m_OriginBackgroundOpacity=this.m_Background.opacity,this.m_Background.opacity=0},e.prototype.OnAllocate=function(){this.m_HandleLock=!1,this.SetProgress(0),this.m_CountDownSprite.Reset()},e.prototype.OnEnter=function(){var t=this;c.gf.action.In(this.m_Background,.6,{opacity:this.m_OriginBackgroundOpacity}),c.gf.action.MoveWithEasing(this.m_ActionNode,!0,.6,this.m_OriginActionNodePosition,function(){return t.StartCountDown()},.3),this.m_ScoreLabel.string=""+this.vm.score},e.prototype.OnExit=function(){},e.prototype.ExitWithAction=function(t){var e=this;c.gf.action.MoveWithEasing(this.m_ActionNode,!1,.3,this.m_OriginActionNodePosition,null,.8),c.gf.action.Out(this.m_Background,.3,{opacity:0},function(){e.vm.watchADCallback(t),e.Release()},.8+.4)},e.prototype.OnWatchADClick=function(){var t=this;this.m_HandleLock||(this.m_HandleLock=!0,c.gf.audio.playDefaultEffect(),this.StopCountDown(),s.default.ShowRewardedVideo(function(e){return t.ExitWithAction(e)}))},e.prototype.OnNewGameClick=function(){this.m_HandleLock||(this.m_HandleLock=!0,c.gf.audio.playDefaultEffect(),this.StopCountDown(),this.ExitWithAction(!1))},e.prototype.StartCountDown=function(){this.m_CountDownSprite.AddCountDownEventListener(this),this.m_CountDownSprite.StartCountDown()},e.prototype.StopCountDown=function(){this.m_CountDownSprite.StopCountDown()},e.prototype.OnCountDownEvent=function(t,e){switch(t){case a.ECountDownEent.END:if(this.m_HandleLock)break;this.m_HandleLock=!0,this.ExitWithAction(!1);break;case a.ECountDownEent.TICK:c.gf.audio.playEffect(l.HazelAudio.Audio.CD);break;case a.ECountDownEent.PROGRESS:this.SetProgress(e)}},r([h(cc.Node)],e.prototype,"m_Background",void 0),r([h(cc.Node)],e.prototype,"m_ActionNode",void 0),r([h(a.default)],e.prototype,"m_CountDownSprite",void 0),r([h(cc.Sprite)],e.prototype,"m_ProgressSprite",void 0),r([h(cc.Label)],e.prototype,"m_ScoreLabel",void 0),r([c.gf.decorator.BlockInput(1)],e.prototype,"OnWatchADClick",null),r([c.gf.decorator.BlockInput(1)],e.prototype,"OnNewGameClick",null),r([p],e)}(c.gf.ReusableView);o.default=f,cc._RF.pop()},{"../../../GF/ADService":"ADService","../../../GF/Component/CountDownSprite":"CountDownSprite","../../../GF/core":"core","../AudioConfig":"AudioConfig"}],UIDialog:[function(t,e,o){"use strict";cc._RF.push(e,"121e8MH9sRKx4PZAIMf3wmP","UIDialog");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../core"),a=cc._decorator,s=a.ccclass,l=a.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.background=null,e.dialog=null,e.message=null,e._onClickConfirm=null,e._onClickCancel=null,e}return i(e,t),e.prototype.OnCreate=function(){this.ResizeToFullScreen(this.node),this.ResizeToFullScreen(this.background)},e.prototype.OnAllocate=function(){},e.prototype.OnEnter=function(){this.message.string=this.vm.msg,this._onClickConfirm=this.vm.confirm,this._onClickCancel=this.vm.cancel,this.dialog.scale=.6,c.gf.action.In(this.dialog,.15,{scale:1}),c.gf.action.In(this.background,.3,{opacity:120})},e.prototype.OnExit=function(){},e.prototype.OnClickConfirm=function(){c.gf.audio.playDefaultEffect(),c.gf.action.Out(this.dialog,.15,{scale:.6}),this.ReleaseWithAction(this.background,{opacity:0},.2,this._onClickConfirm)},e.prototype.OnClickCancel=function(){c.gf.audio.playDefaultEffect(),c.gf.action.Out(this.dialog,.15,{scale:.6}),this.ReleaseWithAction(this.background,{opacity:0},.2,this._onClickCancel)},r([l(cc.Node)],e.prototype,"background",void 0),r([l(cc.Node)],e.prototype,"dialog",void 0),r([l(cc.Label)],e.prototype,"message",void 0),r([c.gf.decorator.BlockInput(.3)],e.prototype,"OnClickConfirm",null),r([c.gf.decorator.BlockInput(.3)],e.prototype,"OnClickCancel",null),r([s],e)}(c.gf.ReusableView);o.default=u,cc._RF.pop()},{"../../core":"core"}],UIDockItem:[function(t,e,o){"use strict";cc._RF.push(e,"e3ef7xMrytLuo+9+IM8IADv","UIDockItem");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GF/core"),a=t("../../../App/BlockPuzzleScene/BlockPuzzle"),s=t("./UIBlock"),l=t("../../Base/AudioConfig"),u=t("../../../GF/SDK/SDKMgr"),p=cc._decorator,h=p.ccclass,f=p.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.StartOrEndActionNode=null,e.MovingNode=null,e.ScaleNode=null,e.UIBlockRoot=null,e.VideoAvailableNode=null,e.BombButtonNode=null,e.BombActionNode=null,e.m_OriginScale=1,e.m_DockManager=null,e.m_WatchingAD=!1,e.m_IsBlockPlayingAction=!1,e.C_DRAG_TO_Y=200,e.C_DRAG_END_ACTION_TIME=.2,e}return i(e,t),Object.defineProperty(e.prototype,"IsPlayingAction",{get:function(){return this.m_IsBlockPlayingAction},enumerable:!1,configurable:!0}),e.prototype.GetUIBlock=function(){return this.UIBlockRoot.getComponentInChildren(s.default)},e.prototype.OnCreate=function(){this.m_OriginScale=this.ScaleNode.scale,this.BombActionNode.scale=.9;var t=cc.tween().to(1,{scale:1.2},{easing:cc.easing.backOut}).to(1,{scale:.9},{easing:cc.easing.backIn});cc.tween(this.BombActionNode).repeatForever(t).start()},e.prototype.OnAllocate=function(){this.vm.ui=this},e.prototype.OnEnter=function(t){var e=this;this.m_DockManager=t,this.BindTouch(),this.CreateNewBlock(!0),this.bindCallback(u.default.Ins.Channel.ADProxy.isRewardedVideoAvailableBV,function(t){return e.VideoAvailableNode.active=t||e.m_WatchingAD},!0)},e.prototype.OnExit=function(){var t=this.GetUIBlock();t&&t.Release(),this.UnbindTouch()},e.prototype.hasBlock=function(){return null!=this.vm.block},e.prototype.CreateNewBlock=function(t){var e=this;if(this.vm.block){var o=c.gf.ReusableView.Allocate(a.BlockPuzzle.Prefabs.UIBlock,this.vm.block);o.node.position=cc.Vec3.ZERO,this.UIBlockRoot.addChild(o.node),o.Enter(),t?(this.m_IsBlockPlayingAction=!0,this.UpdateDockStatus(),this.BombButtonNode.active=!1,o.RunEnterAction(function(){e.UpdateDockStatus(),e.m_IsBlockPlayingAction=!1})):this.UpdateDockStatus()}else this.UpdateDockStatus()},e.prototype.UpdateDockStatus=function(){this.vm.block?(this.BombButtonNode.active=!this.vm.block.canEmbedded,this.GetUIBlock().UpdateDockStatus(this.vm.block.canEmbedded)):this.BombButtonNode.active=!1},e.prototype.OnBombClick=function(){var t=this;this.m_DockManager.IsBombClickable(this)&&u.default.Ins.Channel.ADProxy.IsRewardedVideoAvailable()&&(c.gf.audio.playDefaultEffect(),this.m_WatchingAD=!0,this.m_DockManager.OnBombClick(this,function(){t.m_WatchingAD=!1}))},e.prototype.RemoveBlock=function(t){void 0===t&&(t=!1);var e=this.GetUIBlock();e&&(this.m_IsBlockPlayingAction=!1,e.Release()),t&&(this.vm.block=null)},e.prototype.BindTouch=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.UnbindTouch=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.onTouchStart=function(t){return this.m_DockManager.OnItemTouchStart(this,t)},e.prototype.onTouchMove=function(t){this.m_DockManager.OnItemTouchMove(this,t)},e.prototype.onTouchEnd=function(t){this.m_DockManager.OnItemTouchEnd(this,t)},e.prototype.OnDragStart=function(t,e){var o=this;c.gf.audio.playEffect(l.HazelAudio.Audio.PICK_UP),console.log("OnDragStart.........");var n=this.GetUIBlock();n.SwitchToNormalSprite(),n.ShowPadding(!0),this.StartOrEndActionNode.y=this.C_DRAG_TO_Y,cc.Tween.stopAllByTarget(this.ScaleNode),this.ScaleNode.scale=.6,cc.tween(this.ScaleNode).to(.3,{scale:a.BlockPuzzle.Config.DRAG_SCALE},{easing:cc.easing.elasticOut}).call(function(){e.UpdateWithUIDockItem(o)}).start()},e.prototype.OnDragMove=function(t,e){this.MovingNode.x+=t.getDelta().x,this.MovingNode.y+=t.getDelta().y,e.UpdateWithUIDockItem(this)},e.prototype.OnDragEnd=function(t,e){var o;cc.Tween.stopAllByTarget(this.MovingNode),cc.Tween.stopAllByTarget(this.StartOrEndActionNode),cc.Tween.stopAllByTarget(this.ScaleNode),e.HandleUIDockItemDragEnd(this)?((o=this.GetUIBlock()).Release(),this.vm.RemoveBlockDate(),this.MovingNode.x=0,this.MovingNode.y=0,this.StartOrEndActionNode.x=0,this.StartOrEndActionNode.y=0,this.ScaleNode.scale=this.m_OriginScale):((o=this.GetUIBlock()).ShowPadding(!1),o.SwitchToDockSprite(),cc.tween(this.MovingNode).to(this.C_DRAG_END_ACTION_TIME,{x:0,y:0}).start(),cc.tween(this.StartOrEndActionNode).to(this.C_DRAG_END_ACTION_TIME,{x:0,y:0}).start(),cc.tween(this.ScaleNode).to(this.C_DRAG_END_ACTION_TIME,{scale:this.m_OriginScale}).start())},r([f(cc.Node)],e.prototype,"StartOrEndActionNode",void 0),r([f(cc.Node)],e.prototype,"MovingNode",void 0),r([f(cc.Node)],e.prototype,"ScaleNode",void 0),r([f(cc.Node)],e.prototype,"UIBlockRoot",void 0),r([f(cc.Node)],e.prototype,"VideoAvailableNode",void 0),r([f(cc.Node)],e.prototype,"BombButtonNode",void 0),r([f(cc.Node)],e.prototype,"BombActionNode",void 0),r([c.gf.decorator.BlockInput(1)],e.prototype,"OnBombClick",null),r([h],e)}(c.gf.ReusableView);o.default=d,cc._RF.pop()},{"../../../App/BlockPuzzleScene/BlockPuzzle":"BlockPuzzle","../../../GF/SDK/SDKMgr":"SDKMgr","../../../GF/core":"core","../../Base/AudioConfig":"AudioConfig","./UIBlock":"UIBlock"}],UIDockManager:[function(t,e,o){"use strict";cc._RF.push(e,"eba99r8JyFADrIwu7W8JSbW","UIDockManager");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GF/core"),a=t("../BlockPuzzle"),s=t("./UIBoardManager"),l=t("../../Base/AudioConfig"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_DockItemContainer=null,e.m_UIBoardManager=null,e.m_UIDockItemList=c.gf.stl.DLink.Allocate(),e.m_isTouchStart=!1,e.m_DragDockItem=null,e.m_Game=null,e.__HE_m_PreLoseSchduler=null,e.__HE_m_TickCount=0,e}return i(e,t),e.prototype.RestartGame=function(){this.m_UIDockItemList.For(function(t){return t.RemoveBlock(!0)})},e.prototype.TopZOrder=function(t){this.m_UIDockItemList.For(function(e){return e.node.zIndex=e==t?1:0})},e.prototype.HandleStartEvent=function(t){var e=this;this.m_Game=t,t.docks.forEach(function(t,o){var n=c.gf.ReusableView.Allocate(a.BlockPuzzle.Prefabs.UIDockItem,t);n.node.x=210*(o-1),e.m_DockItemContainer.addChild(n.node),e.m_UIDockItemList.push(n),n.Enter(t,e)})},e.prototype.HandleQuitEvent=function(){this.m_UIDockItemList.removeAll(function(t){return t.Release()}),this.__HE_StopPreLoseScheduler()},e.prototype.HandleCreateNewBlocksEvent=function(){this.m_UIDockItemList.For(function(t){return t.CreateNewBlock(!0)})},e.prototype.HandleDockStatusUpdatedEvent=function(){this.m_UIDockItemList.For(function(t){return t.UpdateDockStatus()})},e.prototype.HandlePreLoseEvent=function(){this.__HE_StartPreLoseScheduler()},e.prototype.__HE_StartPreLoseScheduler=function(){var t=this;this.__HE_StopPreLoseScheduler(),c.gf.audio.playEffect(l.HazelAudio.Audio.CD),this.__HE_m_PreLoseSchduler=function(){c.gf.audio.playEffect(l.HazelAudio.Audio.CD),2==t.__HE_m_TickCount&&t.m_Game.Lose(),++t.__HE_m_TickCount},this.schedule(this.__HE_m_PreLoseSchduler,1,2)},e.prototype.__HE_StopPreLoseScheduler=function(){this.__HE_m_PreLoseSchduler&&(this.unschedule(this.__HE_m_PreLoseSchduler),this.__HE_m_PreLoseSchduler=null,this.__HE_m_TickCount=0)},e.prototype.IsBombClickable=function(t){return!this.m_isTouchStart&&t.hasBlock()&&!t.IsPlayingAction},e.prototype.OnBombClick=function(t,e){this.__HE_StopPreLoseScheduler(),this.m_Game.WatchADToBombBlock(t.vm,e)},e.prototype.OnItemTouchStart=function(t,e){return!(this.m_isTouchStart||!t.hasBlock()||t.IsPlayingAction||(this.m_isTouchStart=!0,this.m_DragDockItem=t,this.TopZOrder(t),t.OnDragStart(e,this.m_UIBoardManager),0))},e.prototype.OnItemTouchMove=function(t,e){this.m_isTouchStart&&t===this.m_DragDockItem&&t.OnDragMove(e,this.m_UIBoardManager)},e.prototype.OnItemTouchEnd=function(t,e){this.m_isTouchStart&&t===this.m_DragDockItem&&(this.m_DragDockItem=null,this.m_isTouchStart=!1,t.OnDragEnd(e,this.m_UIBoardManager))},r([h(cc.Node)],e.prototype,"m_DockItemContainer",void 0),r([h(s.default)],e.prototype,"m_UIBoardManager",void 0),r([p],e)}(c.gf.View);o.default=f,cc._RF.pop()},{"../../../GF/core":"core","../../Base/AudioConfig":"AudioConfig","../BlockPuzzle":"BlockPuzzle","./UIBoardManager":"UIBoardManager"}],UIDockTile:[function(t,e,o){"use strict";cc._RF.push(e,"ef9bf5ZsfVMlrbgBVx78IdY","UIDockTile");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GF/core"),a=cc._decorator,s=a.ccclass,l=a.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.DockSprite=null,e.NormalSprite=null,e.HighlightSprite=null,e.m_SpriteFrames=[],e}return i(e,t),e.prototype.OnCreate=function(){},e.prototype.OnAllocate=function(){this.vm.ui=this},e.prototype.OnEnter=function(){},e.prototype.OnExit=function(){},e.prototype.SwitchToNormalSprite=function(){this.DockSprite.node.active=!1,this.NormalSprite.node.active=!0,this.NormalSprite.spriteFrame=this.m_SpriteFrames[0],this.HighlightSprite.node.active=!1},e.prototype.SwitchToDisableSprite=function(){this.NormalSprite.node.active=!0,this.NormalSprite.spriteFrame=this.m_SpriteFrames[1],this.DockSprite.node.active=!1,this.HighlightSprite.node.active=!1},e.prototype.SwitchToDockSprite=function(){this.DockSprite.node.active=!0,this.NormalSprite.node.active=!1,this.HighlightSprite.node.active=!1},e.prototype.SwitchToHighlightSprite=function(){this.DockSprite.node.active=!1,this.NormalSprite.node.active=!1,this.HighlightSprite.node.active=!0},r([l(cc.Sprite)],e.prototype,"DockSprite",void 0),r([l(cc.Sprite)],e.prototype,"NormalSprite",void 0),r([l(cc.Sprite)],e.prototype,"HighlightSprite",void 0),r([l([cc.SpriteFrame])],e.prototype,"m_SpriteFrames",void 0),r([s],e)}(c.gf.ReusableView);o.default=u,cc._RF.pop()},{"../../../GF/core":"core"}],UIGameOver:[function(t,e,o){"use strict";cc._RF.push(e,"96c0fM5YPJIpYlzV528nKPz","UIGameOver");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.UIGameOverModel=void 0;var c=t("../../BaseUIPop"),a=t("../../../GF/core");o.UIGameOverModel=function(t,e,o){this.onRestart=t,this.score=e,this.historyBestScore=o};var s=cc._decorator,l=s.ccclass,u=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_ScoreLabel=null,e.m_BestScoreLabel=null,e}return i(e,t),e.prototype.OnEnter=function(){t.prototype.OnEnter.call(this),this.m_ScoreLabel.string=""+this.vm.score,this.m_BestScoreLabel.string=""+this.vm.historyBestScore},e.prototype.EnterActionType=function(){return cc.easing.backOut},e.prototype.OnRestartButtonClick=function(){a.gf.audio.playDefaultEffect(),this.ExitWithAction(this.vm.onRestart)},r([u(cc.Label)],e.prototype,"m_ScoreLabel",void 0),r([u(cc.Label)],e.prototype,"m_BestScoreLabel",void 0),r([a.gf.decorator.BlockInput(1)],e.prototype,"OnRestartButtonClick",null),r([l],e)}(c.default);o.default=p,cc._RF.pop()},{"../../../GF/core":"core","../../BaseUIPop":"BaseUIPop"}],UILoadingCircle:[function(t,e,o){"use strict";cc._RF.push(e,"0096c+SFF1Nd5t4p2BUY3xI","UILoadingCircle");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../core"),a=cc._decorator,s=a.ccclass,l=a.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fadeOutNode=null,e.rotateNode=null,e.m_Lable=null,e._rotateScheduler=null,e}return i(e,t),e.prototype.onLoad=function(){this.Init()},e.prototype.ShowByRef=function(){var t=this;this.node.active=!0,cc.Tween.stopAllByTarget(this.fadeOutNode),this.fadeOutNode.opacity=0,cc.tween(this.fadeOutNode).to(.3,{opacity:255}).start(),this._rotateScheduler=function(){return t.rotateNode.angle=t.rotateNode.angle-30},this.schedule(this._rotateScheduler,.1)},e.prototype.HideByRef=function(){this.unscheduleRotate(),this.node.active=!1},e.prototype.RefreshByRef=function(t,e){this.m_Lable.string=e<=1?"Loading":"Loading "+t+" / "+e},e.prototype.unscheduleRotate=function(){this._rotateScheduler&&(this.unschedule(this._rotateScheduler),this._rotateScheduler=null)},r([l(cc.Node)],e.prototype,"fadeOutNode",void 0),r([l(cc.Node)],e.prototype,"rotateNode",void 0),r([l(cc.Label)],e.prototype,"m_Lable",void 0),r([s],e)}(c.gf.BaseLockView);o.default=u,cc._RF.pop()},{"../../core":"core"}],UIMessage:[function(t,e,o){"use strict";cc._RF.push(e,"bfb14z0Av5Nh6mJlJ2YckK1","UIMessage");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../core"),a=cc._decorator,s=a.ccclass,l=a.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.background=null,e.message=null,e.actionNode=null,e.m_InitPositionAction=null,e}return i(e,t),e.prototype.OnCreate=function(){this.ResizeToFullScreen(this.node),this.m_InitPositionAction=this.actionNode.position,this.actionNode.opacity=0},e.prototype.OnAllocate=function(){},e.prototype.OnEnter=function(){var t=this;this.message.string=this.vm,cc.tween(this.actionNode).to(.2,{opacity:255,position:cc.Vec3.ZERO}).delay(3).to(.2,{opacity:0,position:this.m_InitPositionAction}).call(function(){t.Release()}).start()},e.prototype.OnExit=function(){},r([l(cc.Sprite)],e.prototype,"background",void 0),r([l(cc.Label)],e.prototype,"message",void 0),r([l(cc.Node)],e.prototype,"actionNode",void 0),r([s],e)}(c.gf.ReusableView);o.default=u,cc._RF.pop()},{"../../core":"core"}],UINP321Go:[function(t,e,o){"use strict";cc._RF.push(e,"e6298DJDAFPCYtk6Yggv5Qw","UINP321Go");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GF/core"),a=t("../../../GF/Component/CountDownSprite"),s=t("../NumberPuzzle"),l=cc._decorator,u=l.ccclass,p=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_CountDownSprite=null,e}return i(e,t),e.prototype.OnCreate=function(){},e.prototype.OnAllocate=function(){this.m_CountDownSprite.Reset()},e.prototype.OnEnter=function(){this.StartCountDown()},e.prototype.OnExit=function(){},e.prototype.StartCountDown=function(){this.m_CountDownSprite.AddCountDownEventListener(this),this.m_CountDownSprite.StartCountDown()},e.prototype.StopCountDown=function(){this.m_CountDownSprite.StopCountDown()},e.prototype.OnCountDownEvent=function(t,e){var o=this;switch(t){case a.ECountDownEent.END:this.scheduleOnce(function(){return o.Release()},1);break;case a.ECountDownEent.TICK:c.gf.audio.playEffect(s.NumberPuzzle.Audio.CD[3-e])}},r([p(a.default)],e.prototype,"m_CountDownSprite",void 0),r([u],e)}(c.gf.ReusableView);o.default=h,cc._RF.pop()},{"../../../GF/Component/CountDownSprite":"CountDownSprite","../../../GF/core":"core","../NumberPuzzle":"NumberPuzzle"}],UINPBlock:[function(t,e,o){"use strict";cc._RF.push(e,"cb2f6JqWF1OuqF1bReMsZWI","UINPBlock");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.UINPBlockModel=void 0;var c=t("../../../GF/core");o.UINPBlockModel=function(t,e,o,n){this.block=t,this.Width=e,this.Height=o,this.OnClick=n,this.ui=null};var a=cc._decorator,s=a.ccclass,l=a.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_Sprite=null,e.m_Label=null,e.m_SwapButtonNode=null,e}return i(e,t),e.prototype.OnCreate=function(){this.m_SwapButtonNode.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this)},e.prototype.OnAllocate=function(){this.vm.ui=this,this.node.scaleX=this.vm.Width/200,this.node.scaleY=this.vm.Height/200,this.m_Label.string=""+(this.vm.block.Number+1)},e.prototype.OnEnter=function(){},e.prototype.OnExit=function(){},e.prototype.onTouchStart=function(){c.gf.audio.playDefaultEffect(),this.vm.OnClick(this)},e.prototype.SetBlock=function(t){this.vm.block=t,this.m_Label.string=""+(this.vm.block.Number+1)},e.prototype.ShowSwapStatus=function(t){t?cc.tween(this.m_Sprite.node).to(.1,{y:20},{easing:cc.easing.backOut}).to(.05,{y:10,scale:1}).start():(cc.Tween.stopAllByTarget(this.m_Sprite.node),this.m_Sprite.node.y=0),this.node.zIndex=t?1:0},r([l(cc.Sprite)],e.prototype,"m_Sprite",void 0),r([l(cc.Label)],e.prototype,"m_Label",void 0),r([l(cc.Node)],e.prototype,"m_SwapButtonNode",void 0),r([s],e)}(c.gf.ReusableView);o.default=u,cc._RF.pop()},{"../../../GF/core":"core"}],UINPDialog:[function(t,e,o){"use strict";cc._RF.push(e,"001eazhmtFIJYnq6plEksDJ","UINPDialog");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.UINPDialogModel=void 0;var c=t("../../BaseUIPop"),a=t("../../../GF/core");o.UINPDialogModel=function(t,e){this.onYes=t,this.onNo=e};var s=cc._decorator,l=s.ccclass,u=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.EnterActionType=function(){return cc.easing.backOut},e.prototype.OnEnter=function(e){t.prototype.OnEnter.call(this,e)},e.prototype.OnClickYes=function(){a.gf.audio.playDefaultEffect(),this.ExitWithAction(this.vm.onYes,!0)},e.prototype.OnClickNo=function(){a.gf.audio.playDefaultEffect(),this.ExitWithAction(this.vm.onNo,!0)},r([a.gf.decorator.BlockInput(1)],e.prototype,"OnClickYes",null),r([a.gf.decorator.BlockInput(1)],e.prototype,"OnClickNo",null),r([l],e)}(c.default));o.default=u,cc._RF.pop()},{"../../../GF/core":"core","../../BaseUIPop":"BaseUIPop"}],UINPWin:[function(t,e,o){"use strict";cc._RF.push(e,"fcae3ngyUFDJ6NT+7NcuSor","UINPWin");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.UINPWinModel=void 0;var c=t("../../BaseUIPop"),a=t("../../../GF/core"),s=t("../NumberPuzzle");o.UINPWinModel=function(t,e,o,n,i,r){this.stars=t,this.seconds=e,this.historyBestSeconds=o,this.onGoToLevelSelect=n,this.onReplay=i,this.onContinue=r};var l=cc._decorator,u=l.ccclass,p=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_SecondsLabel=null,e.m_HistoryBestSecondsLabel=null,e.m_NewRecordSignNode=null,e.m_StarSpriteNodeList=[],e.m_WordSprite=null,e.m_WorldSpriteFrameList=[],e}return i(e,t),e.prototype.EnterActionType=function(){return cc.easing.elasticOut},e.prototype.EnterSpeedFactor=function(){return.4},e.prototype.OnEnter=function(e){var o=this;t.prototype.OnEnter.call(this,e),this.m_SecondsLabel.string=""+a.gf.date.Format(this.vm.seconds,"mm:ss"),this.m_HistoryBestSecondsLabel.string=""+a.gf.date.Format(this.vm.historyBestSeconds,"mm:ss"),this.m_WordSprite.node.active=this.vm.stars>0,this.vm.stars>0&&(this.m_WordSprite.spriteFrame=this.m_WorldSpriteFrameList[this.vm.stars-1]);for(var n=0,i=function(t){var e=r.m_StarSpriteNodeList[t],o=t<r.vm.stars;if(e.active=!1,o){var i=e.getComponent(cc.Animation);r.scheduleOnce(function(){e.active=o,i.play("np_WinStar"),a.gf.audio.playEffect(s.NumberPuzzle.Audio.np_win_star)},r.EnterActionSeconds+.25*t),0==n&&(n=r.EnterActionSeconds+.25*(t+2))}},r=this,c=2;c>=0;--c)i(c);var l=this.vm.seconds<=this.vm.historyBestSeconds;if(this.m_NewRecordSignNode.active=!1,l){var u=this.m_NewRecordSignNode.getComponent(cc.Animation);this.scheduleOnce(function(){o.m_NewRecordSignNode.active=!0,u.play("np_WinStar"),a.gf.audio.playEffect(s.NumberPuzzle.Audio.np_win_star)},n)}},e.prototype.OnClickGoToLevelSelect=function(){a.gf.audio.playDefaultEffect(),this.ExitWithAction(this.vm.onGoToLevelSelect)},e.prototype.OnReplayClick=function(){a.gf.audio.playDefaultEffect(),this.ExitWithAction(this.vm.onReplay)},e.prototype.OnContinueClick=function(){a.gf.audio.playDefaultEffect(),this.ExitWithAction(this.vm.onContinue)},r([p(cc.Label)],e.prototype,"m_SecondsLabel",void 0),r([p(cc.Label)],e.prototype,"m_HistoryBestSecondsLabel",void 0),r([p(cc.Node)],e.prototype,"m_NewRecordSignNode",void 0),r([p([cc.Node])],e.prototype,"m_StarSpriteNodeList",void 0),r([p(cc.Sprite)],e.prototype,"m_WordSprite",void 0),r([p([cc.SpriteFrame])],e.prototype,"m_WorldSpriteFrameList",void 0),r([a.gf.decorator.BlockInput(1)],e.prototype,"OnClickGoToLevelSelect",null),r([a.gf.decorator.BlockInput(1)],e.prototype,"OnReplayClick",null),r([a.gf.decorator.BlockInput(1)],e.prototype,"OnContinueClick",null),r([u],e)}(c.default);o.default=h,cc._RF.pop()},{"../../../GF/core":"core","../../BaseUIPop":"BaseUIPop","../NumberPuzzle":"NumberPuzzle"}],UINewRecord:[function(t,e,o){"use strict";cc._RF.push(e,"fbcc70OYN5DwYHgnvMSwCM2","UINewRecord");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.UINewRecordModel=void 0;var c=t("../../BaseUIPop"),a=t("../../../GF/core");o.UINewRecordModel=function(t,e,o){this.onRestart=t,this.score=e,this.historyBestScore=o};var s=cc._decorator,l=s.ccclass,u=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_RecordLabel=null,e.m_LastRecordLabel=null,e}return i(e,t),e.prototype.EnterActionType=function(){return cc.easing.backOut},e.prototype.OnEnter=function(e){t.prototype.OnEnter.call(this,e),this.m_RecordLabel.string=""+this.vm.score,this.m_LastRecordLabel.string=""+this.vm.historyBestScore},e.prototype.OnRestartButtonClick=function(){a.gf.audio.playDefaultEffect(),this.ExitWithAction(this.vm.onRestart)},r([u(cc.Label)],e.prototype,"m_RecordLabel",void 0),r([u(cc.Label)],e.prototype,"m_LastRecordLabel",void 0),r([a.gf.decorator.BlockInput(1)],e.prototype,"OnRestartButtonClick",null),r([l],e)}(c.default);o.default=p,cc._RF.pop()},{"../../../GF/core":"core","../../BaseUIPop":"BaseUIPop"}],UIOK:[function(t,e,o){"use strict";cc._RF.push(e,"3136aCXfehHurEJKji00AQH","UIOK");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../core"),a=cc._decorator,s=a.ccclass,l=a.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.background=null,e.dialog=null,e.message=null,e._onClick=null,e}return i(e,t),e.prototype.OnCreate=function(){this.ResizeToFullScreen(this.node),this.ResizeToFullScreen(this.background)},e.prototype.OnAllocate=function(){},e.prototype.OnEnter=function(){this.message.string=this.vm.msg,this._onClick=this.vm.click,this.dialog.scale=.6,c.gf.action.In(this.dialog,.15,{scale:1}),c.gf.action.In(this.background,.3,{opacity:120,scale:1})},e.prototype.OnExit=function(){},e.prototype.OnClick=function(){c.gf.audio.playDefaultEffect(),c.gf.action.Out(this.dialog,.15,{scale:.6}),this.ReleaseWithAction(this.background,{opacity:0},.2,this._onClick)},r([l(cc.Node)],e.prototype,"background",void 0),r([l(cc.Node)],e.prototype,"dialog",void 0),r([l(cc.Label)],e.prototype,"message",void 0),r([c.gf.decorator.BlockInput(.3)],e.prototype,"OnClick",null),r([s],e)}(c.gf.ReusableView);o.default=u,cc._RF.pop()},{"../../core":"core"}],UIPause:[function(t,e,o){"use strict";cc._RF.push(e,"1f631RIdIpB7osQ/j7VH8Qf","UIPause");var n,i,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),c=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.UIPauseModel=void 0;var a,s=t("../../../GF/core"),l=t("../../BaseUIPop"),u=t("../../../GF/SDK/SDKMgr"),p=t("../GameSceneConfig");(function(t){t[t.Shake=0]="Shake",t[t.Sound=1]="Sound",t[t.Rank=2]="Rank"})(a||(a={}));var h=((i={})[p.default.Name.BlockPuzzle]=[a.Shake,a.Sound,a.Rank],i[p.default.Name.BlockPuzzle99]=[a.Shake,a.Sound,a.Rank],i[p.default.Name.NumberPuzzle]=[a.Sound,a.Rank],i);o.UIPauseModel=function(t,e,o){this.gameKey=t,this.onRestart=e,this.onClose=o};var f=cc._decorator,d=f.ccclass,_=f.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mv_ShakeRoot=null,e.mv_SoundRoot=null,e.mv_RankRoot=null,e.m_SoundOnButtonNode=null,e.m_SoundOffButtonNode=null,e.m_ShakeOffButtonNode=null,e.m_ShakeOnButtonNode=null,e}return r(e,t),e.prototype.OnEnter=function(){var e=this;t.prototype.OnEnter.call(this),this.mv_ShakeRoot.active=!1,this.mv_SoundRoot.active=!1,this.mv_RankRoot.active=!1,h[this.vm.gameKey].forEach(function(t){switch(t){case a.Shake:e.mv_ShakeRoot.active=!0;break;case a.Sound:e.mv_SoundRoot.active=!0;break;case a.Rank:e.mv_RankRoot.active=!0}}),this.mv_RankRoot.active=!1,this.bindCallback(s.gf.audio.EffectOffLS,function(t){e.m_SoundOffButtonNode.active=t,e.m_SoundOnButtonNode.active=!t},!0),this.bindCallback(s.gf.platform.Vibrate.EffectOff,function(t){e.m_ShakeOffButtonNode.active=t,e.m_ShakeOnButtonNode.active=!t},!0)},e.prototype.EnterActionType=function(){return cc.easing.bounceOut},e.prototype.OnClickShakeOffButton=function(){s.gf.audio.playDefaultEffect(),s.gf.platform.Vibrate.EffectOff.value=!1},e.prototype.OnClickShakeOnButton=function(){s.gf.audio.playDefaultEffect(),s.gf.platform.Vibrate.EffectOff.value=!0},e.prototype.OnClickSoundOffButton=function(){s.gf.audio.playDefaultEffect(),s.gf.audio.effectMute=!1},e.prototype.OnClickSoundOnButton=function(){s.gf.audio.playDefaultEffect(),s.gf.audio.effectMute=!0},e.prototype.OnClickRankButton=function(){s.gf.audio.playDefaultEffect(),u.default.Ins.Channel.UserProxy.Show()},e.prototype.OnClickRestartButton=function(){s.gf.audio.playDefaultEffect(),this.ExitWithAction(this.vm.onRestart)},e.prototype.OnClickCloseButton=function(){s.gf.audio.playDefaultEffect(),this.ExitWithAction(this.vm.onClose)},c([_(cc.Node)],e.prototype,"mv_ShakeRoot",void 0),c([_(cc.Node)],e.prototype,"mv_SoundRoot",void 0),c([_(cc.Node)],e.prototype,"mv_RankRoot",void 0),c([_(cc.Node)],e.prototype,"m_SoundOnButtonNode",void 0),c([_(cc.Node)],e.prototype,"m_SoundOffButtonNode",void 0),c([_(cc.Node)],e.prototype,"m_ShakeOffButtonNode",void 0),c([_(cc.Node)],e.prototype,"m_ShakeOnButtonNode",void 0),c([s.gf.decorator.BlockInput(.1)],e.prototype,"OnClickShakeOffButton",null),c([s.gf.decorator.BlockInput(.1)],e.prototype,"OnClickShakeOnButton",null),c([s.gf.decorator.BlockInput(.1)],e.prototype,"OnClickSoundOffButton",null),c([s.gf.decorator.BlockInput(.1)],e.prototype,"OnClickSoundOnButton",null),c([s.gf.decorator.BlockInput(1)],e.prototype,"OnClickRankButton",null),c([s.gf.decorator.BlockInput(1)],e.prototype,"OnClickRestartButton",null),c([s.gf.decorator.BlockInput(1)],e.prototype,"OnClickCloseButton",null),c([d],e)}(l.default);o.default=m,cc._RF.pop()},{"../../../GF/SDK/SDKMgr":"SDKMgr","../../../GF/core":"core","../../BaseUIPop":"BaseUIPop","../GameSceneConfig":"GameSceneConfig"}],UIRate:[function(t,e,o){"use strict";cc._RF.push(e,"5b4cbSmgipFc4gXGlve7w+n","UIRate");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.UIRateModel=void 0;var c=t("../../BaseUIPop"),a=t("../../../GF/core");o.UIRateModel=function(t,e){this.onRate=t,this.onClose=e};var s=cc._decorator,l=s.ccclass,u=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.EnterActionType=function(){return cc.easing.bounceOut},e.prototype.OnRateButtonClick=function(){this.ExitWithAction(this.vm.onRate)},e.prototype.OnClickCloseButton=function(){a.gf.audio.playDefaultEffect(),this.ExitWithAction(this.vm.onClose)},r([a.gf.decorator.BlockInput(1)],e.prototype,"OnRateButtonClick",null),r([a.gf.decorator.BlockInput(1)],e.prototype,"OnClickCloseButton",null),r([l],e)}(c.default));o.default=u,cc._RF.pop()},{"../../../GF/core":"core","../../BaseUIPop":"BaseUIPop"}],UIScoreEffect:[function(t,e,o){"use strict";cc._RF.push(e,"47e2fzgEqtIuZoYFTXvHZCj","UIScoreEffect");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.UIScoreEffectModel=void 0;var c=t("../../../GF/core"),a=t("../../../GF/StateMachine"),s=function(){function t(t){void 0===t&&(t=0),this.score=t,this.m_Level=-1,this.UpdateLevel()}return t.prototype.UpdateLevel=function(){this.m_Level=-1;for(var t=0;t<5;++t)this.score>=10*(2*t+3)&&(this.m_Level=t)},t.prototype.HasLevelEffect=function(){return this.m_Level>=0},t.prototype.HasScoreEffect=function(){return this.score>=10},Object.defineProperty(t.prototype,"Level",{get:function(){return this.m_Level},enumerable:!1,configurable:!0}),t}();o.UIScoreEffectModel=s;var l=cc._decorator,u=l.ccclass,p=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_LevelSprite=null,e.m_SpriteFrames=[],e.m_ScoreEffect=null,e.m_ScoreLabel=null,e.fsm=null,e.SM_STATUS={none:"none",flying:"flying",done:"done"},e.SM_EVENT={Fly:"Fly",Finish:"Finish",Reset:"Reset"},e.m_Radian=0,e.m_Power=0,e.m_ActionCallback=null,e.m_Velocity=null,e.m_RotationSpeed=0,e.m_Gravity=0,e.m_FlyingScheduler=null,e}return i(e,t),Object.defineProperty(e.prototype,"LEVEL",{get:function(){return this.m_SpriteFrames.length},enumerable:!1,configurable:!0}),e.prototype.OnCreate=function(){this.fsm=a.StateMachine.create({final:this.SM_STATUS.done,events:[{name:this.SM_EVENT.Fly,from:this.SM_STATUS.none,to:this.SM_STATUS.flying},{name:this.SM_EVENT.Finish,from:this.SM_STATUS.flying,to:this.SM_STATUS.done},{name:this.SM_EVENT.Reset,from:a.StateMachine.WILDCARD,to:this.SM_STATUS.none}],callbacks:{onenterstate:this.onEnterState.bind(this)}})},e.prototype.OnAllocate=function(){},e.prototype.OnEnter=function(){},e.prototype.OnExit=function(){this.fsm.Reset()},e.prototype.RunLevelEffect=function(){this.node.scale=.1,this.m_ScoreEffect.active=!1,this.m_LevelSprite.node.active=!0,this.m_LevelSprite.spriteFrame=this.m_SpriteFrames[this.vm.Level],this.m_Gravity=-2600,this.RunRemoveFromBoardAction(Math.PI*(.5+.2*(.5-Math.random())),1400,null),c.gf.platform.Vibrate.vibrateNormal()},e.prototype.RunScoreEffect=function(){this.m_ScoreLabel.string="+"+10*Math.floor(.1*this.vm.score),this.m_ScoreEffect.active=!0,this.m_LevelSprite.node.active=!1,this.node.scale=1,this.m_Gravity=-2500,this.RunRemoveFromBoardAction(Math.PI*(.5+.1*(.5-Math.random())),1200,null)},e.prototype.RunRemoveFromBoardAction=function(t,e,o){this.m_Radian=t,this.m_Power=e,this.m_ActionCallback=o,this.fsm.Fly()},e.prototype.onEnterState=function(t,e,o){var n=this;switch(o){case this.SM_STATUS.none:this.node.angle=0;break;case this.SM_STATUS.flying:this.m_Velocity=cc.v2(0,0),this.m_Velocity.x=30*Math.sin(this.m_Radian),this.m_Velocity.y=this.m_Power*(.8+.2*Math.cos(this.m_Radian)),this.m_RotationSpeed=20*(.3+.7*Math.random()),this.m_FlyingScheduler=function(t){return n.__updatePerFrameForFlying(t)},this.schedule(this.m_FlyingScheduler,0,cc.macro.REPEAT_FOREVER),cc.tween(this.node).to(.3,{scale:1},{easing:cc.easing.backOut}).start();break;case this.SM_STATUS.done:this.m_ActionCallback&&this.m_ActionCallback(),this.Release();break;default:console.error("state: "+o+" no handled")}},e.prototype.__updatePerFrameForFlying=function(t){this.node.angle+=this.m_RotationSpeed*t,this.m_Velocity.y+=this.m_Gravity*t,this.node.x+=this.m_Velocity.x*t,this.node.y+=this.m_Velocity.y*t,this.node.convertToWorldSpaceAR(cc.Vec2.ZERO).y<-cc.winSize.height/3&&(this.unschedule(this.m_FlyingScheduler),this.m_FlyingScheduler=null,this.fsm.Finish())},r([p(cc.Sprite)],e.prototype,"m_LevelSprite",void 0),r([p([cc.SpriteFrame])],e.prototype,"m_SpriteFrames",void 0),r([p(cc.Node)],e.prototype,"m_ScoreEffect",void 0),r([p(cc.Label)],e.prototype,"m_ScoreLabel",void 0),r([u],e)}(c.gf.ReusableView);o.default=h,cc._RF.pop()},{"../../../GF/StateMachine":"StateMachine","../../../GF/core":"core"}],UIService:[function(t,e,o){"use strict";cc._RF.push(e,"2eb91XIErxD0rdlzi/zRARR","UIService");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../GF/core"),c=t("../Base/PrefabConfig"),a=t("../Base/UI/UIPause"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.OpenUIPause=function(t,e,o){this.notifyGlobalShowUI(c.HazelPrefab.Prefab.UIPause,new a.UIPauseModel(t,e,o))},e}(r.gf.Service);o.default=s,cc._RF.pop()},{"../../GF/core":"core","../Base/PrefabConfig":"PrefabConfig","../Base/UI/UIPause":"UIPause"}],UIShadowTile:[function(t,e,o){"use strict";cc._RF.push(e,"9a9dbXdi2JPNKQ1GJ2kHh2V","UIShadowTile");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GF/core"),a=cc._decorator,s=a.ccclass,l=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.OnCreate=function(){},e.prototype.OnAllocate=function(){},e.prototype.OnEnter=function(){},e.prototype.OnExit=function(){},r([s],e)}(c.gf.ReusableView));o.default=l,cc._RF.pop()},{"../../../GF/core":"core"}],UITipTile:[function(t,e,o){"use strict";cc._RF.push(e,"14c687LcMdFSqb1ULf2gRF4","UITipTile");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../../GF/core"),a=cc._decorator,s=a.ccclass,l=a.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_SpriteNode=null,e}return i(e,t),e.prototype.OnCreate=function(){},e.prototype.OnAllocate=function(){},e.prototype.OnEnter=function(){},e.prototype.OnExit=function(){},e.prototype.RunTipAction=function(){this.m_SpriteNode.opacity=0;var t=cc.tween(this.m_SpriteNode).to(1,{opacity:255}).to(1,{opacity:0});cc.tween(this.m_SpriteNode).repeatForever(t).start()},e.prototype.StopTipAction=function(){cc.Tween.stopAllByTarget(this.m_SpriteNode)},r([l(cc.Node)],e.prototype,"m_SpriteNode",void 0),r([s],e)}(c.gf.ReusableView);o.default=u,cc._RF.pop()},{"../../../GF/core":"core"}],WoodBlockAd:[function(t,e,o){"use strict";cc._RF.push(e,"62c72GZo2ZHYaMCRsiRVwxL","WoodBlockAd");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var o;return i(e,t),o=e,e.prototype.onLoad=function(){console.log("[Adsgram] WoodBlockAd onLoad............................................."),o.instance=this},e.prototype.isAdsgramAvailable=function(){return"undefined"!=typeof window&&"object"==typeof window.Adsgram},e.prototype.showInterstitialAd=function(){this.isAdsgramAvailable()&&console.log("[Adsgram] \u5c55\u793a\u63d2\u9875\u5e7f\u544a")},e.prototype.showRewardAd=function(){this.isAdsgramAvailable()&&console.log("[Adsgram] \u5c55\u793a\u89c6\u9891\u5e7f\u544a")},e.instance=null,o=r([a],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],core:[function(t,e,o){"use strict";cc._RF.push(e,"be6f5hEflVDg7HjywHAMqK1","core");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c},c=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(i,r){function c(t){try{s(n.next(t))}catch(e){r(e)}}function a(t){try{s(n.throw(t))}catch(e){r(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(c,a)}s((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var o,n,i,r,c={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return s([t,e])}}function s(r){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,n&&(i=2&r[0]?n.return:r[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,r[1])).done)return i;switch(n=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,n=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(!(i=(i=c.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){c.label=r[1];break}if(6===r[0]&&c.label<i[1]){c.label=i[1],i=r;break}if(i&&c.label<i[2]){c.label=i[2],c.ops.push(r);break}i[2]&&c.ops.pop(),c.trys.pop();continue}r=e.call(t,c)}catch(a){r=[6,a],n=0}finally{o=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}},s=this&&this.__spreadArrays||function(){for(var t=0,e=0,o=arguments.length;e<o;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<o;e++)for(var r=arguments[e],c=0,a=r.length;c<a;c++,i++)n[i]=r[c];return n};Object.defineProperty(o,"__esModule",{value:!0}),o.gf=void 0;var l=t("./StateMachine"),u=cc._decorator,p=u.ccclass,h=u.property;(function(t){var e;t.events={OPEN_APP_STORE:"EVENT_OPEN_APP_STORE",EVENT_SHOW:cc.game.EVENT_SHOW,EVENT_HIDE:cc.game.EVENT_HIDE,ADD_LOADING_REF:"EVENT_ADD_LOADING_REF",DEC_LOADING_REF:"EVENT_DEC_LOADING_REF",EVENT_TEST:"EVENT_TEST"},function(t){t.FalseResultCompareFunc=function(){return!1},t.BooleanResultCompareFunc=function(t,e){return t===e},t.NumberResultCompareFunc=function(t,e){return t-e}}(e=t.constant||(t.constant={}));var o,n=function(){function t(t,e,o){this.m_PoolKey=t,this.m_Creator=e,this.m_WaterMark=o}return t.prototype.release=function(){this.m_WaterMark=null,this.m_Creator=null,this.m_PoolKey=null},t.prototype.put=function(t){this.isOverflow()?this.destroyObj(t):this.putToPool(t)},t.prototype.get=function(){return this.size()>0?this.getFromPool():this.m_Creator()},t.prototype.isOverflow=function(){return this.m_WaterMark>0&&this.size()>=this.m_WaterMark},Object.defineProperty(t.prototype,"waterMark",{set:function(t){for(this.m_WaterMark=t;this.isOverflow();){var e=this.getFromPool();this.destroyObj(e)}},enumerable:!1,configurable:!0}),t}(),u=function(t){function e(e,o,n){void 0===n&&(n=0);var i=t.call(this,e,o,n)||this;return i._objs_=[],i}return i(e,t),e.pool=function(t){return this.s_PoolMap.get(t)},e.cachePool=function(t,e){this.s_PoolMap.set(t,e)},e.hasPool=function(t){return this.s_PoolMap.has(t)},e.getOrCreatePool=function(t,o,n){return void 0===n&&(n=0),e.hasPool(t)||e.cachePool(t,new e(t,o,n)),this.pool(t)},e.destroyPool=function(t){this.hasPool(t)&&this.s_PoolMap.get(t).release()},e.prototype.size=function(){return this._objs_.length},e.prototype.putToPool=function(t){this._objs_.push(t)},e.prototype.getFromPool=function(){return this._objs_.pop()},e.prototype.destroyObj=function(){},e.prototype.release=function(){for(e.hasPool(this.m_PoolKey)&&e.s_PoolMap.delete(this.m_PoolKey);this._objs_.length>0;)this.destroyObj(this._objs_.pop());t.prototype.release.call(this)},e.s_PoolMap=new Map,e}(n),f=function(t){function e(e,o,n){var i=t.call(this,e,function(){return cc.instantiate(o)},n)||this;return i.m_PrefabKey=e,i.m_Prefab=o,i.m_CCNodePool=null,j.Cache.AddRef(i.m_PrefabKey,i.m_Prefab),i.m_CCNodePool=new cc.NodePool(i.m_PrefabKey),i}return i(e,t),e.pool=function(t){return this._pools_.get(t)},e.cachePool=function(t,e){this.hasPool(t)||this._pools_.set(t,e)},e.hasPool=function(t){return this._pools_.has(t)},e.ReleasePoolByRef=function(t){this.hasPool(t)&&this.pool(t).ReleaseByRef()},e.Allocate=function(t,o,n){return void 0===n&&(n=0),new e(t,o,n)},e.prototype.release=function(){for(e._pools_.delete(this.m_PrefabKey),j.Cache.DecRef(this.m_PrefabKey);this.size()>0;)this.destroyObj(this.get());this.m_CCNodePool=null,this.m_Prefab=null,this.m_PrefabKey=null,t.prototype.release.call(this)},e.prototype.ReleaseByRef=function(){this.m_Prefab.refCount===1+this.size()&&(console.warn("\u4ec5\u5bf9\u8c61\u6c60\u53ca\u6c60\u4e2d\u5bf9\u8c61\uff0c\u5378\u8f7d "+this.m_Prefab.name+" >> size: "+this.size()+" refCount:"+this.m_Prefab.refCount+" url:"+this.m_PrefabKey),this.release())},Object.defineProperty(e.prototype,"prefab",{get:function(){return this.m_Prefab},enumerable:!1,configurable:!0}),e.prototype.size=function(){return this.m_CCNodePool.size()},e.prototype.putToPool=function(t){this.m_CCNodePool.put(t)},e.prototype.getFromPool=function(){return this.m_CCNodePool.get()},e.prototype.destroyObj=function(t){t.removeFromParent(),t.destroy()},e._pools_=new Map,e}(n);(function(t){var e=function(){function t(t){void 0===t&&(t=null),this.elem=t,this.next=null,this.pre=null}return t.Allocate=function(){return this.s_pool.get()},t.prototype.release=function(){this.next=null,this.pre=null,this.elem=null,t.s_pool.put(this)},t.s_pool=u.getOrCreatePool("DLinkNode",function(){return new t},0),t}(),o=function(){function t(){this.m_head=null,this.m_tail=null,this.m_len=0,this.m_lock=!1}return t.Allocate=function(){var t=this.s_pool.get();return t.OnAllocate(),t},t.prototype.OnAllocate=function(){this.m_head=e.Allocate(),this.m_tail=e.Allocate(),this.m_head.next=this.m_tail,this.m_tail.pre=this.m_head},t.prototype.release=function(e){this.removeAll(e),this.m_head.release(),this.m_tail.release(),this.m_head=null,this.m_tail=null,this.m_lock=!1,t.s_pool.put(this)},t.prototype.size=function(){return this.m_len},t.prototype.empty=function(){return 0===this.m_len},Object.defineProperty(t.prototype,"top",{get:function(){return this.m_head.next.elem},enumerable:!1,configurable:!0}),t.prototype.push=function(t){this.addAfter(this.m_head,t)},t.prototype.pop=function(t){if(this.m_len>0){var e=this.removeAfter(this.m_head);t&&t(e)}},Object.defineProperty(t.prototype,"front",{get:function(){return this.m_head.next.elem},enumerable:!1,configurable:!0}),t.prototype.enqueue=function(t){this.addBefore(this.m_tail,t)},t.prototype.dequeue=function(t){if(this.m_len>0){var e=this.removeAfter(this.m_head);t&&t(e)}},t.prototype.addAfter=function(t,o){var n=e.Allocate();n.elem=o,n.next=t.next,n.pre=t,t.next.pre=n,t.next=n,++this.m_len},t.prototype.addBefore=function(t,o){var n=e.Allocate();n.elem=o,n.next=t,n.pre=t.pre,t.pre.next=n,t.pre=n,++this.m_len},t.prototype.removeAfter=function(t){var e=t.next.elem,o=t.next;return o.next.pre=t,t.next=o.next,--this.m_len,o.release(),e},t.prototype.removeBefore=function(t){var e=t.pre.elem,o=t.pre;return o.pre.next=t,t.pre=o.pre,--this.m_len,o.release(),e},t.prototype.removeElement=function(t,e){this.removeByFind(function(e){return e===t},e)},t.prototype.removeByFind=function(t,e){for(var o=this.m_head;o.next!==this.m_tail;)if(t(o.next.elem)){var n=this.removeAfter(o);e&&e(n)}else o=o.next},t.prototype.removeAll=function(t){this.removeByFind(function(){return!0},t)},t.prototype.hasElement=function(t,e){for(var o=this.m_head;o.next!==this.m_tail;){if(t(o.next.elem))return e&&e(o.next.elem),!0;o=o.next}return!1},t.prototype.findAnyElement=function(t,e){for(var o=this.m_head;o.next!==this.m_tail;){if(t(o.next.elem))return e&&e(o.next.elem),o.next.elem;o=o.next}return null},t.prototype.forEach=function(t){for(var e=this.m_head;e.next!==this.m_tail&&!t(e.next.elem);)e=e.next},t.prototype.For=function(t){for(var e=this.m_head;e.next!==this.m_tail;)t(e.next.elem),e=e.next},t.prototype.Count=function(t){for(var e=0,o=this.m_head;o.next!==this.m_tail;)t(o.next.elem)&&++e,o=o.next;return e},t.prototype.lock=function(){this.m_lock=!0},t.prototype.unlock=function(){this.m_lock=!1},t.prototype.isLocking=function(){return this.m_lock},t.prototype.log=function(){console.log("---- LinedList ----"),this.For(function(t){return console.log(t)}),console.log("-------------------")},t.s_pool=u.getOrCreatePool("DLink",function(){return new t},0),t}();t.DLink=o;var n=function(){function t(t){this.m_Compare=t,this.data=[]}return t.prototype.left=function(t){return 2*t+1},t.prototype.right=function(t){return 2*t+2},t.prototype.parent=function(t){return t%2==0?(t-2)/2:(t-1)/2},t.prototype.add=function(t){this.data.push(t),this.siftUp(this.data.length-1)},t.prototype.siftUp=function(t){for(var e,o=this.parent(t);t>0&&this.m_Compare(this.data[o],this.data[t])>0;)e=[this.data[t],this.data[o]],this.data[o]=e[0],this.data[t]=e[1],t=o,o=this.parent(t)},t.prototype.extractRoot=function(){if(this.data.length>0){var t=this.data[0],e=this.data.pop();return this.data.length>0&&(this.data[0]=e,this.siftDown(0)),t}},t.prototype.siftDown=function(t){for(var e,o=this,n=function(t,e){return e>=o.data.length?t>=o.data.length?-1:t:o.m_Compare(o.data[t],o.data[e])<=0?t:e},i=n(this.left(t),this.right(t));i>=0&&this.m_Compare(this.data[t],this.data[i])>0;)e=[this.data[t],this.data[i]],this.data[i]=e[0],this.data[t]=e[1],t=i,i=n(this.left(t),this.right(t))},t.prototype.size=function(){return this.data.length},t.prototype.peek=function(){return this.data.length>0?this.data[0]:void 0},t.prototype.release=function(){for(;this.size()>0;)this.extractRoot()},t}();t.Heap=n})(o=t.stl||(t.stl={}));var d=function(){function t(){}return t.BaseAction=function(t,e,o,n,i,r){if(void 0===i&&(i=void 0),void 0===r&&(r=0),cc.Tween.stopAllByTarget(t),0==o)return t.active=e,null===t.scale&&void 0===t.scale||(t.scale=n.scale),null===t.opacity&&void 0===t.opacity||(t.opacity=n.opacity),console.assert(0==r),void(i&&i(t));t.active=!0;var c=cc.tween(t);r>0&&c.delay(r),c.to(o,n).call(function(t){t.active=e,i&&i(t)}).start()},t.Out=function(t,e,o,n,i){return void 0===n&&(n=void 0),void 0===i&&(i=0),this.BaseAction(t,!1,e,o,n,i)},t.In=function(t,e,o,n,i){return void 0===n&&(n=void 0),void 0===i&&(i=0),this.BaseAction(t,!0,e,o,n,i)},t.MoveWithEasing=function(t,e,o,n,i,r,c){void 0===r&&(r=0),void 0===c&&(c=cc.easing.backOut);var a=cc.tween(t);r>0&&a.delay(r),a.to(o,{position:e?cc.Vec3.ZERO:n},{easing:e?c:cc.easing.backIn}),i&&a.call(i),a.start()},t.MoveWithBounce=function(t,e,o,n,i,r){void 0===r&&(r=0),this.MoveWithEasing(t,e,o,n,i,r,cc.easing.bounceOut)},t}();t.action=d,(t.util||(t.util={})).CallAfterCount=function(t,e){return function(){0==--e&&t&&t()}},(t.decorator||(t.decorator={})).BlockInput=function(t){return function(e,o,n){var i=n.value,r=!1;return n.value=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];r?console.log("gf:decorator:BlockInput:Blocking"):(r=!0,setTimeout(function(){r=!1},1e3*t),i.apply(this,e))},n}},function(t){t.moveNodeToTargetParent=function(t,e,o){if(void 0===o&&(o=!1),t.parent!==e){var n=e.convertToNodeSpaceAR(t.convertToWorldSpaceAR(cc.Vec3.ZERO));t.removeFromParent(o),t.position=n,e.addChild(t)}},t.positionInTargetNodeSpaceAR=function(t,e){var o=t.convertToWorldSpaceAR(cc.Vec3.ZERO);return e.convertToNodeSpaceAR(o)}}(t.ui||(t.ui={})),function(t){var e=function(t){function e(e,o){return void 0===o&&(o=!1),t.call(this,3125,34359738337,0,e,o)||this}return i(e,t),e}(function(){function t(t,e,o,n,i){void 0===i&&(i=!1),this.kMultiplier=3125,this.kModer=34359738337,this.kConstant=0,this.kOriginRandomSeed=null,this.kRandomSeed=null,this.bIsDebug=!1,this.kRandomCount=0,this.kMultiplier=t,this.kModer=e,this.kConstant=o,n&&0!==n||(n=1),this.kOriginRandomSeed=n,this.kRandomSeed=n,this.bIsDebug=i}return Object.defineProperty(t.prototype,"seed",{get:function(){return this.kOriginRandomSeed},enumerable:!1,configurable:!0}),t.prototype.random=function(){var t=(this.kRandomSeed*this.kMultiplier+this.kConstant)%this.kModer,e=t/this.kModer;return this.kRandomSeed=t,this.bIsDebug&&(++this.kRandomCount,console.log(">>Rand{"+this.kOriginRandomSeed+"}: Count{"+this.kRandomCount+"} Seed{"+this.kRandomSeed+"} Ret:{"+e+"}")),e},t.prototype.range=function(t,e){return console.assert(t<=e&&t>=0),Math.floor(this.random()*(e+1-t)+t)},t}());t.MCGRand=e}(t.rand||(t.rand={}));var _,m=function(){function t(){}return t.TimeStamp2Date=function(t){return new Date(1e3*t)},t.Date2TimeStamp=function(t){return Math.floor(t.getTime()/1e3)},t.getTimeStamp=function(){return Math.floor((new Date).getTime()/1e3)},t.getMilliTimeStamp=function(){return(new Date).getTime()},t.IsSameDay=function(t,e){return t.toDateString()===e.toDateString()},t.IsSameDayTimeStamp=function(t,e){return this.IsSameDay(this.TimeStamp2Date(t),this.TimeStamp2Date(e))},t.zeroHourOfTimeStamp=function(t){return this.zeroHourTimeStampOfDate(this.TimeStamp2Date(t))},t.zeroHourTimeStampOfDate=function(t){return this.Date2TimeStamp(t)-(3600*t.getHours()+60*t.getMinutes()+t.getSeconds())},t.tomorrowTimeStamp=function(t){return this.zeroHourOfTimeStamp(t+86400)},t.tomorrowTimeStampOfDate=function(t){return this.tomorrowTimeStamp(this.Date2TimeStamp(t))},t.IsToday=function(t){return this.IsSameDayTimeStamp(t,this.getTimeStamp())},t.IsBeforToday=function(t){return!this.IsToday(t)&&t<this.getTimeStamp()},t.Format=function(t,e,o){if(void 0===e&&(e="hh:mm:ss"),void 0===o&&(o=!1),-1!=e.indexOf("dd")){var n=Math.floor(t/86400);t-=86400*n;var i=o||n>9?""+n:"0"+n;e=e.replace("dd",i)}if(-1!=e.indexOf("hh")){var r=Math.floor(t/3600);t-=3600*r;var c=o||r>9?""+r:"0"+r;e=e.replace("hh",c)}if(-1!=e.indexOf("mm")){var a=Math.floor(t/60);t-=60*a;var s=o||a>9?""+a:"0"+a;e=e.replace("mm",s)}if(-1!=e.indexOf("ss")){var l=Math.floor(t),u=o||l>9?""+l:"0"+l;e=e.replace("ss",u)}return e},t}();t.date=m,function(t){var e=function(){function t(){}return t.encode=function(t){if(/([^\u0000-\u00ff])/.test(t))throw new Error("INVALID_CHARACTER_ERR");for(var e,o,n,i=0,r=[];i<t.length;){switch(o=t.charCodeAt(i),n=i%3){case 0:r.push(this.base64hash.charAt(o>>2));break;case 1:r.push(this.base64hash.charAt((3&e)<<4|o>>4));break;case 2:r.push(this.base64hash.charAt((15&e)<<2|o>>6)),r.push(this.base64hash.charAt(63&o))}e=o,i++}return 0==n?(r.push(this.base64hash.charAt((3&e)<<4)),r.push("==")):1==n&&(r.push(this.base64hash.charAt((15&e)<<2)),r.push("=")),r.join("")},t.decode=function(t){t=t.replace(/\s|=/g,"");for(var e,o,n=0,i=[];n<t.length;){switch(e=this.base64hash.indexOf(t.charAt(n)),n%4){case 0:break;case 1:i.push(String.fromCharCode(o<<2|e>>4));break;case 2:i.push(String.fromCharCode((15&o)<<4|e>>2));break;case 3:i.push(String.fromCharCode((3&o)<<6|e))}o=e,n++}return i.join("")},t.Test=function(){console.log(">>Test Base64:"),[{value:"Man",encode:"TWFu"},{value:"A",encode:"QQ=="},{value:"BC",encode:"QkM="}].forEach(function(e){var o=t.encode(e.value),n=t.decode(o);if(e.value!==n||o!==e.encode)throw"Error!";console.log(e.value," ----\x3e OK")})},t.base64hash="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t}();t.encodeBase64=function(t){return e.encode(t)},t.decodeBase64=function(t){return e.decode(t)}}(_||(_={}));var y=function(){function t(){}return t.getItem=function(t){return cc.sys.localStorage.getItem(t)},t.setItem=function(t,e){cc.sys.localStorage.setItem(t,e)},t.removeItem=function(t){cc.sys.localStorage.removeItem(t)},t}();t.LocalStorage=y;var S,v=function(t){function e(e){var o=t.call(this)||this;return o.m_Callback=null,o.m_Callback=e,o}return i(e,t),e.prototype.OnBindingValueChanged=function(t,e,o){return this.m_Callback(t,e,o)},e}(function(){});(function(t){var e=u.getOrCreatePool("BindableData",function(){return{binder:null,target:null}},0);t.CreateTargetBinderObj=function(t,o){var n=e.get();return n.binder=t,n.target=o,n},t.ReuseTargetBinderObj=function(t){t.binder=null,t.target=null,e.put(t)}})(S||(S={}));var g=function(){function t(t,e){this.m_CompareFunc=null,this.m_DefaultValue=null,this.m_OriginDefaultValue=null,this.m_TargetBinderObjLinkedList=null,this.m_DefaultValue=this.copyDefault(t),this.m_OriginDefaultValue=t,this.m_CompareFunc=e,this.m_TargetBinderObjLinkedList=o.DLink.Allocate()}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getStorageValue()},set:function(t){var e=this.getStorageValue();this.m_CompareFunc(t,e)||(this.setStorageValue(t),this.notifyBinders(t,e))},enumerable:!1,configurable:!0}),t.prototype.reset=function(t){var e=this.getStorageValue();this.m_DefaultValue=this.copyDefault(this.m_OriginDefaultValue),this.setStorageValue(this.m_DefaultValue),t&&this.notifyBinders(this.m_DefaultValue,e)},t.prototype.force=function(t){this.m_DefaultValue=this.copyDefault(this.m_OriginDefaultValue),this.setStorageValue(t)},t.prototype.commit=function(t){var e=this.value;t(e),this.value=e},t.prototype.bindBinder=function(t,e,o){var n=S.CreateTargetBinderObj(t,o);return this.m_TargetBinderObjLinkedList.enqueue(n),e&&t.OnBindingValueChanged(this.value,this.value,this),t},t.prototype.bind=function(t,e,o){return this.bindBinder(new v(t),e,o)},t.prototype.unbindBinder=function(t){this.m_TargetBinderObjLinkedList.removeByFind(function(e){return e.binder===t},S.ReuseTargetBinderObj)},t.prototype.targetUnbind=function(t){this.m_TargetBinderObjLinkedList.removeByFind(function(e){return e.target===t},S.ReuseTargetBinderObj)},t.prototype.unbindAll=function(){this.m_TargetBinderObjLinkedList.removeAll(S.ReuseTargetBinderObj)},t.prototype.hasBinder=function(t){return this.m_TargetBinderObjLinkedList.hasElement(function(e){return e.binder===t})},t.prototype.notifyBinders=function(t,e){var o=this;this.m_TargetBinderObjLinkedList.For(function(n){return n.binder.OnBindingValueChanged(t,e,o)})},t.prototype.release=function(){this.unbindAll(),this.m_TargetBinderObjLinkedList.release(),this.m_TargetBinderObjLinkedList=null,this.m_DefaultValue=null,this.m_OriginDefaultValue=null,this.m_CompareFunc=null},t}(),b=function(t){function e(e,o){var n=t.call(this,e,o)||this;return n.m_CacheValue=null,n.m_CacheValue=n.m_DefaultValue,n}return i(e,t),e.prototype.getStorageValue=function(){return this.m_CacheValue},e.prototype.setStorageValue=function(t){this.m_CacheValue=t},e.prototype.release=function(){t.prototype.release.call(this),this.m_CacheValue=null},e}(g),P=function(t){function o(o){return t.call(this,o,e.BooleanResultCompareFunc)||this}return i(o,t),o.prototype.copyDefault=function(t){return t},o}(b),w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(P);t.BindableBoolean=w;var O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(P);t.BindableNumber=O;var k=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(P);t.BindableString=k;var C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(P);t.BindableIntegerEnum=C;var R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.copyDefault=function(t){return JSON.parse(JSON.stringify(t))},e}(b);t.BindableObject=R;var E=function(t){function e(e){var o=t.call(this,e)||this;return o.m_MaxValue=null,o.m_MaxValue=e,o}return i(e,t),e.prototype.release=function(){t.prototype.release.call(this),this.m_MaxValue=null},e.prototype.setStorageValue=function(e){var o=this.getStorageValue();t.prototype.setStorageValue.call(this,e),e>this.m_MaxValue?this.m_MaxValue=e:0==o&&e>0&&(this.m_MaxValue=e)},e.prototype.reset=function(e){t.prototype.reset.call(this,e),this.m_MaxValue=this.m_DefaultValue},Object.defineProperty(e.prototype,"MaxReference",{get:function(){return this.m_MaxValue},enumerable:!1,configurable:!0}),e.prototype.AddReference=function(){this.value=this.value+1},e.prototype.RemoveReference=function(){this.value=this.value-1},e}(O);t.BindableRef=E;var I=function(t){function e(e,o,n,i){var r=t.call(this,e,o)||this;return r._k=null,r._crypt=!1,r.m_CacheValue=null,r._k=n,r._crypt=i,r}return i(e,t),e.prototype.release=function(){t.prototype.release.call(this),this._k=null,this._crypt=!1,this.m_CacheValue=null},e.prototype.hasLocalStorage=function(){return null!=this.getLocalStorageString()},e.prototype.removeLocalStorage=function(){y.removeItem(this._k)},e.prototype.getLocalStorageString=function(){return y.getItem(this._k)},e.prototype.setLocalStorageString=function(t){return y.setItem(this._k,t)},e.prototype.getStorageValue=function(){if(null!==this.m_CacheValue&&void 0!==this.m_CacheValue)return this.m_CacheValue;var t=this.getLocalStorageString();return t?(t=this.decrypt(t),this.decode(t)):this.m_DefaultValue},e.prototype.setStorageValue=function(t){this.m_CacheValue=t,this.setLocalStorageString(this.encrypt(this.encode(t)))},e.prototype.decrypt=function(t){return t.startsWith("_cp_z_")?(t=t.slice(6),_.decodeBase64(t)):t},e.prototype.encrypt=function(t){return this._crypt?"_cp_z_"+(t=_.encodeBase64(t)):t},e}(g),A=function(t){function o(o,n,i){return t.call(this,o,e.BooleanResultCompareFunc,n,i)||this}return i(o,t),o.prototype.copyDefault=function(t){return t},o}(I),T=function(t){function e(e,o){return t.call(this,e,o,!1)||this}return i(e,t),e.prototype.decode=function(t){return"T"===t},e.prototype.encode=function(t){return t?"T":"F"},e}(A);t.LocalStorageBoolean=T;var D=function(t){function e(e,o,n){void 0===n&&(n=0);var i=t.call(this,e,o,!1)||this;return i.m_Offset=0,i.m_Offset=n,i}return i(e,t),e.prototype.release=function(){t.prototype.release.call(this),this.m_Offset=null},e.prototype.decode=function(t){return parseInt(t)-this.m_Offset},e.prototype.encode=function(t){return""+(t+this.m_Offset)},e}(A);t.LocalStorageNumber=D;var B=function(t){function e(e,o){return t.call(this,e,o,!1)||this}return i(e,t),e.prototype.decode=function(t){return t},e.prototype.encode=function(t){return t},e}(A);t.LocalStorageString=B;var L=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.decode=function(t){return JSON.parse(t)},e.prototype.encode=function(t){return JSON.stringify(t)},e.prototype.copyDefault=function(t){return JSON.parse(JSON.stringify(t))},e}(I);t.LocalStorageObject=L;var N=function(t){function o(o,n){return void 0===n&&(n=!1),t.call(this,{list:[]},e.FalseResultCompareFunc,o,n)||this}return i(o,t),o.prototype.removeListItem=function(t,e){var o=this.indexOf(t,e);return-1!==o&&this.commit(function(t){return t.list.splice(o,1)}),-1!==o},o.prototype.indexOf=function(t,e){return this.indexOfList(this.value.list,t,e)},o.prototype.indexOfList=function(t,e,o){for(var n=t.length-1;n>=0;--n)if(o(e,t[n]))return n;return-1},o}(L);t.LocalStorageObjectList=N;var M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_ItemCompare=function(t,e){return t===e},e}return i(e,t),e.prototype.removeListItem=function(e){return t.prototype.removeListItem.call(this,e,this.m_ItemCompare)},e.prototype.indexOf=function(e){return t.prototype.indexOf.call(this,e,this.m_ItemCompare)},e.prototype.indexOfList=function(e,o){return t.prototype.indexOfList.call(this,e,o,this.m_ItemCompare)},e}(N);t.LocalStorageNumberList=M;var z=function(){function t(){}return t.Allocate=function(t,e,o,n,i){var r=this.s_pool.get();return r.handler=e,r.target=o,r.event=t,r.once=n,r.active=!0,r.id=i,r},t.prototype.release=function(){this.handler=null,this.target=null,this.event=null,this.once=!1,this.active=!0,this.id=null,t.s_pool.put(this)},t.s_pool=u.getOrCreatePool("EventListener",function(){return new t},0),t}(),U=function(){function t(){this._mid_=0,this._notifyRefCnt_=0,this._dirty_=!1,this._eListenersLinedListMap_=new Map}return t.prototype.notify=function(t){for(var e=this,o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];if(++this._notifyRefCnt_,this._eListenersLinedListMap_.has(t)){var i=this._eListenersLinedListMap_.get(t);i.For(function(t){t.active&&(t.once&&(t.active=!1,e._dirty_=!0),t.handler.apply(t.target,o))})}--this._notifyRefCnt_,this.cleanDirty()},t.prototype.cleanDirty=function(){this._dirty_&&0===this._notifyRefCnt_&&(this._eListenersLinedListMap_.forEach(function(t){return t.removeByFind(function(t){return!t.active},function(t){return t.release()})}),this._dirty_=!1)},t.prototype.once=function(t,e,o){return this._on(t,e,o,!0)},t.prototype.on=function(t,e,o){return this._on(t,e,o,!1)},t.prototype._on=function(t,e,n,i){++this._mid_;var r=z.Allocate(t,e,n,i,this._mid_);this._eListenersLinedListMap_.has(t)||this._eListenersLinedListMap_.set(t,o.DLink.Allocate()),this._eListenersLinedListMap_.get(t).enqueue(r)},t.prototype.off=function(t){var e=this;if(this._eListenersLinedListMap_.has(t)){var o=this._eListenersLinedListMap_.get(t);this._notifyRefCnt_>0?o.For(function(t){t.active=!1,e._dirty_=!0}):(o.release(function(t){return t.release()}),this._eListenersLinedListMap_.delete(t))}},t.prototype.targetOff=function(t){var e=this;this._notifyRefCnt_>0?this._eListenersLinedListMap_.forEach(function(o){o.For(function(o){o.target===t&&o.active&&(o.active=!1,e._dirty_=!0)})}):this._eListenersLinedListMap_.forEach(function(e){return e.removeByFind(function(e){return e.target===t},function(t){return t.release()})})},t.prototype.offAll=function(){var t=this;this._eListenersLinedListMap_.forEach(function(e,o){e.release(function(t){return t.release()}),t._eListenersLinedListMap_.delete(o)}),this._dirty_=!1},t.prototype.release=function(){this.offAll()},t}(),F=new U,G=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_BindableList=[],e._autorelease_parent_=null,e._autorelease_=[],e}return i(e,t),e.prototype.notifyGlobal=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return F.notify.apply(F,s([t],e))},e.prototype.onceGlobal=function(t,e){return F.once(t,e,this)},e.prototype.onGlobal=function(t,e){return F.on(t,e,this)},e.prototype.offGlobal=function(t){return F.off(t)},e.prototype.targetOffGlobal=function(){return F.targetOff(this)},e.prototype.notifyGlobalShowUI=function(t,e){void 0===e&&(e=null),this.notifyGlobal("_GF_SHOW_UI_",t,e)},e.prototype.onGlobalShowUI=function(t){this.onGlobal("_GF_SHOW_UI_",t)},e.prototype.bindCallback=function(t,e,o){t.bind(e,o,this),this.m_BindableList.push(t)},e.prototype.unbindAll=function(){for(;this.m_BindableList.length>0;)this.m_BindableList.pop().targetUnbind(this)},e.prototype.release=function(){this.release_autorelease_list(),null!=this._autorelease_parent_&&(this._autorelease_parent_.remove_autorelease_from_parent(this),this._autorelease_parent_=null),this.targetOffGlobal(),this.unbindAll(),t.prototype.release.call(this)},e.prototype.autorelease=function(t){this._autorelease_parent_=t,t._autorelease_.push(this)},e.prototype.release_autorelease_list=function(){for(;this._autorelease_.length>0;)this._autorelease_[this._autorelease_.length-1].release()},e.prototype.remove_autorelease_from_parent=function(t){var e=this._autorelease_.indexOf(t);-1!=e&&this._autorelease_.splice(e,1)},e}(U);t.EventEntity=G;var j,V=function(){function t(){}return t.notifyGlobal=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return F.notify.apply(F,s([t],e))},t.notifyGlobalShowUI=function(t,e){void 0===e&&(e=null),this.notifyGlobal("_GF_SHOW_UI_",t,e)},t}();t.Service=V,function(e){var n=function(){function t(){this.url=null,this.res=null}return t.Allocate=function(t,e){var o=this.s_pool.get();return o.url=t,o.res=e,o},t.prototype.release=function(){t.s_pool.put(this),console.log(">> \u56de\u6536 JavaScript \u5bf9\u8c61: CacheItem")},t.prototype.log=function(){console.log(">> ref: "+this.res.refCount+" url: "+this.url)},t.s_pool=u.getOrCreatePool("ResourceCacheItem",function(){return new t}),t}(),r=function(){function t(){this._resCache=new Map}return Object.defineProperty(t,"Ins",{get:function(){return this._ins||(this._ins=new t),this._ins},enumerable:!1,configurable:!0}),t.prototype.AddRef=function(t,e){if(e.addRef(),this._resCache.has(t)){var o=this._resCache.get(t);console.assert(o.res===e)}else o=n.Allocate(t,e),this._resCache.set(t,o)},t.prototype.DecRef=function(t){var e=this._resCache.get(t);e.res.decRef(),0===e.res.refCount&&(this._resCache.delete(t),console.warn(">> \u5f15\u7528\u8ba1\u6570\u4e3a 0, \u9500\u6bc1\u8d44\u6e90: "+t))},t.prototype.hasRes=function(t){return this._resCache.has(t)},t.prototype.res=function(t){return this._resCache.get(t).res},t._ins=null,t}();e.Cache=r.Ins;var s=function(){function t(){}return t.has=function(t){return this.m_ViewDependents.has(t)},t.RegisterViewDependents=function(t,e){this.m_ViewDependents.set(t,e)},t.Inject=function(t,e){if(this.has(t)){var o=this.m_ViewDependents.get(t);o.view.forEach(function(t){return e.AddView(t)}),null!=o.audio&&o.audio.forEach(function(t){return e.AddAudio(t)})}},t.m_ViewDependents=new Map,t}();e.ResDependent=s;var p,h,d=function(){function t(){}return t.Allocate=function(){return this.s_pool.get()},t.prototype.release=function(){t.s_pool.put(this)},t.s_pool=u.getOrCreatePool("ResItem",function(){return new t},0),t}(),_=function(){function t(){this.m_list=[]}return t.Allocate=function(){return this.s_pool.get()},t.prototype.release=function(){for(;this.m_list.length>0;)this.m_list.pop().release();t.s_pool.put(this)},Object.defineProperty(t.prototype,"length",{get:function(){return this.m_list.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resources",{get:function(){return this.m_list},enumerable:!1,configurable:!0}),t.prototype.AddJSON=function(t){return this.AddRes("json",t)},t.prototype.AddAudio=function(t){return this.AddRes("audio",t)},t.prototype.AddSpriteFrame=function(t){return this.AddRes("sp",t)},t.prototype.AddPrefab=function(t){return this.AddRes("view",t)},t.prototype.AddView=function(t){return this.IsExist("view",t)||this.AddRes("view",t),s.Inject(t,this),this},t.prototype.AddRes=function(t,e){if(e&&!this.IsExist(t,e)){var o=d.Allocate();o.typ=t,o.url=e,this.m_list.push(o)}return this},t.prototype.IsExist=function(t,e){for(var o=this.m_list.length-1;o>=0;--o)if(this.m_list[o].url===e&&this.m_list[o].typ===t)return!0;return!1},t.prototype.log=function(){console.log("-------- dump ResList --------"),this.m_list.forEach(function(t){console.log("typ: "+t.typ+" url: "+t.url)}),console.log("------------------------------")},t.s_pool=u.getOrCreatePool("ResList",function(){return new t},0),t}();function m(t,e,o,n){return c(this,void 0,Promise,function(){return a(this,function(){return[2,new Promise(function(i,r){return h.Load(t,e,!1,i,r,o,n)})]})})}e.ResList=_,function(e){var n;(function(t){t[t.NONE=0]="NONE",t[t.RUNNING=1]="RUNNING",t[t.SUCCESS=2]="SUCCESS"})(n||(n={}));var r=function(e){function o(){var t=e.call(this)||this;return t.m_State=n.NONE,t.m_TaskFunc=null,t.m_IsBlockInput=!1,t.m_IsBlock=!1,t.m_TaskMgr=null,t}return i(o,e),o.Allocate=function(t,e,o,n){return this.s_pool.get().Init(t,e,o,n)},o.prototype.Init=function(e,o,i,r){return this.m_State=n.NONE,this.m_TaskFunc=e,this.m_IsBlockInput=o,this.m_IsBlock=i,this.m_TaskMgr=r,this.m_IsBlockInput&&this.notifyGlobal(t.events.ADD_LOADING_REF),this},o.prototype.release=function(){console.assert(this.m_State===n.SUCCESS),this.m_TaskMgr=null,this.m_TaskFunc=null,o.s_pool.put(this)},o.prototype.RunTask=function(){console.assert(this.m_State===n.NONE),this.m_State=n.RUNNING,this.m_TaskFunc(this)},o.prototype.IsTaskNone=function(){return this.m_State===n.NONE},o.prototype.IsTaskRunning=function(){return this.m_State===n.RUNNING},o.prototype.IsTaskDone=function(){return this.m_State===n.SUCCESS},o.prototype.onTaskSuccess=function(){this.m_State=n.SUCCESS,this.m_IsBlockInput&&this.notifyGlobal(t.events.DEC_LOADING_REF),this.m_TaskMgr.OnTaskSuccess(this)},o.prototype.IsBlockTask=function(){return this.m_IsBlock},o.s_pool=u.getOrCreatePool("Task",function(){return new o},0),o}(G),c={none:"none",running:"running",done:"done"},a={Reset:"Reset",Start:"Start",Run:"Run",Finish:"Finish"},s=function(t){function e(){var e=t.call(this)||this;return e.m_interval=0,e.m_parallel=0,e.m_Tasks=o.DLink.Allocate(),e.m_AmountOfTasks=0,e.m_AmountOfDoneTasks=0,e.m_DoneCallback=null,e.m_Scheduler=null,e.fsm=null,e.fsm=l.StateMachine.create({initial:{event:a.Start,state:c.none,defer:!1},final:c.done,events:[{name:a.Reset,from:l.StateMachine.WILDCARD,to:c.none},{name:a.Run,from:l.StateMachine.WILDCARD,to:c.running},{name:a.Finish,from:c.running,to:c.done}],callbacks:{onenterrunning:e.onEnterRunning.bind(e),onenterdone:e.onEnterDone.bind(e)}}),e}return i(e,t),e.Allocate=function(t){return void 0===t&&(t=20),e.s_pool.get().Init(t)},e.prototype.Init=function(t){return this.m_parallel=t,this},e.prototype.release=function(){console.assert(this.IsDone()&&this.m_Tasks.empty()),this.fsm.Reset(),t.prototype.release.call(this),e.s_pool.put(this)},e.prototype.Start=function(t){return this.Run(t)},e.prototype.AddTask=function(t,e,o){void 0===e&&(e=!1),void 0===o&&(o=!1),this.__AddTask(r.Allocate(t,e,o,this))},e.prototype.Run=function(t){return this.m_DoneCallback=t,this.fsm.Run(),this},e.prototype.onEnterRunning=function(){var t=this;this.m_Tasks.empty()&&this.fsm.Finish(),this.m_Scheduler=function(){return t.FrameUpdate()},x.Ins.scheduler.schedule(this.m_Scheduler,this.m_interval),this.FrameUpdate()},e.prototype.onEnterDone=function(){this.m_AmountOfTasks=0,this.m_AmountOfDoneTasks=0,x.Ins.scheduler.unschedule(this.m_Scheduler),this.m_Scheduler=null;var t=this.m_DoneCallback;this.m_DoneCallback=null,t&&t(this)},e.prototype.IsNone=function(){return this.fsm.is(c.none)},e.prototype.IsRunning=function(){return this.fsm.is(c.running)},e.prototype.IsDone=function(){return this.fsm.is(c.done)},e.prototype.FrameUpdate=function(){this.IsRunning()&&this.TryNextTask()},e.prototype.TryNextTask=function(){var t=this;if(!this.m_Tasks.empty()){var e=this.m_Tasks.size(),o=0;for(this.m_Tasks.For(function(t){t.IsTaskDone()?--e:t.IsTaskRunning()&&++o});this.m_Tasks.front&&this.m_Tasks.front.IsTaskDone();)this.m_Tasks.dequeue(function(t){return t.release()}),this.m_AmountOfDoneTasks=this.m_AmountOfDoneTasks+1,--e,this.m_AmountOfTasks===this.m_AmountOfDoneTasks&&this.fsm.Finish();var n=!1;return this.m_Tasks.forEach(function(i){return i.IsBlockTask()?(i.IsTaskNone()&&(i.RunTask(),n=!0),!0):(o<t.m_parallel&&e>0&&i.IsTaskNone()&&(i.RunTask(),++o,n=!0),!1)}),n?this.FrameUpdate():void 0}},e.prototype.__AddTask=function(t){t&&(this.m_Tasks.enqueue(t),this.m_AmountOfTasks=this.m_AmountOfTasks+1)},e.prototype.OnTaskSuccess=function(){},e.s_pool=u.getOrCreatePool("TaskMgr",function(){return new e},0),e}(G);e.TaskMgr=s}(p||(p={})),e.ReleaseRef=function(t,o){t.resources.forEach(function(t){e.Cache.DecRef(t.url),f.ReleasePoolByRef(t.url)}),o(t)},e.LoadRef=function(t,e){if(0==t.length)return e(t);var o=p.TaskMgr.Allocate(20);t.resources.forEach(function(t){switch(t.typ){case"audio":o.AddTask(function(e){return h.Load(t.url,cc.AudioClip,!0,function(){return e.onTaskSuccess()})},!0);break;case"json":o.AddTask(function(e){return h.Load(t.url,cc.JsonAsset,!0,function(){return e.onTaskSuccess()})},!0);break;case"sp":o.AddTask(function(e){return h.Load(t.url,cc.SpriteFrame,!0,function(){return e.onTaskSuccess()})},!0);break;case"view":o.AddTask(function(e){return h.Load(t.url,cc.Prefab,!0,function(){return e.onTaskSuccess()},null,null,!0)},!0)}}),o.Start(function(o){e(t),o.release()})},e.AsyncLoadAudio=function(t,e){return void 0===e&&(e=null),c(this,void 0,Promise,function(){return a(this,function(){return[2,m(t,cc.AudioClip,e,!1)]})})},e.AsyncLoadSpriteFrame=function(t,e){return void 0===e&&(e=null),c(this,void 0,Promise,function(){return a(this,function(){return[2,m(t,cc.SpriteFrame,e,!1)]})})},e.AsyncLoadJson=function(t,e){return void 0===e&&(e=null),c(this,void 0,Promise,function(){return a(this,function(){return[2,m(t,cc.JsonAsset,e,!1)]})})},e.AsyncLoadPrefab=function(t,e){return void 0===e&&(e=null),c(this,void 0,Promise,function(){return a(this,function(){return[2,m(t,cc.Prefab,e,!1)]})})},e.LoadAudio=function(t,e,o){void 0===o&&(o=null),h.Load(t,cc.AudioClip,!1,e,null,o)},e.LoadSpriteFrame=function(t,e,o){void 0===o&&(o=null),h.Load(t,cc.SpriteFrame,!1,e,null,o)},e.LoadJson=function(t,e,o){void 0===o&&(o=null),h.Load(t,cc.JsonAsset,!1,e,null,o)},e.LoadPrefab=function(t,e,o){void 0===o&&(o=null),h.Load(t,cc.Prefab,!1,e,null,o,!1)},function(t){var n=function(){function t(){this.m_resolve=null,this.m_reject=null,this.m_groupKey=null,this.m_group=null,this.m_Resolved=!1,this.m_res=null,this.m_Rejected=!1,this.m_reason=null}return t.getOrCreateGroup=function(t){return this._groups_.has(t)||this._groups_.set(t,o.DLink.Allocate()),this._groups_.get(t)},t.ResolveOrReject=function(t){for(var e=this.getOrCreateGroup(t);e.size()>0;)if(e.front.m_Resolved)e.dequeue(function(t){return t.__resolve()});else{if(!e.front.m_Rejected)break;e.dequeue(function(t){return t.__reject()})}e.empty()&&(this._groups_.delete(t),e.release())},t.Allocate=function(e,o,n){return t.s_pool.get().Init(e,o,n)},t.prototype.Init=function(e,o,n){return this.m_resolve=o,this.m_reject=n,this.m_groupKey=e,this.m_group=t.getOrCreateGroup(this.m_groupKey),this.m_group.enqueue(this),this},t.prototype.release=function(){this.m_group=null,this.m_reason=null,this.m_Rejected=!1,this.m_res=null,this.m_Resolved=!1,this.m_groupKey=null,this.m_reject=null,this.m_resolve=null,t.s_pool.put(this)},t.prototype.resolve=function(e){this.m_Resolved=!0,this.m_res=e,this.m_group.front===this&&t.ResolveOrReject(this.m_groupKey)},t.prototype.reject=function(e){this.m_reason=e,this.m_Rejected=!0,this.m_group.front===this&&t.ResolveOrReject(this.m_groupKey)},t.prototype.__resolve=function(){this.m_resolve(this.m_res),this.release()},t.prototype.__reject=function(){this.m_reject&&this.m_reject(this.m_reason),this.release()},t._groups_=new Map,t.s_pool=u.getOrCreatePool("WrapPromise",function(){return new t},0),t}();t.Load=function(t,o,i,r,c,a,s){if(void 0===c&&(c=null),void 0===a&&(a=null),void 0===s&&(s=!1),null!=a){var l=n.Allocate(a,r,c);r=function(t){return l.resolve(t)},c=function(t){return l.reject(t)}}if(e.Cache.hasRes(t)){var u=e.Cache.res(t);return i&&e.Cache.AddRef(t,u),s&&!f.hasPool(t)&&f.cachePool(t,f.Allocate(t,u)),void r(u)}cc.resources.load(t,o,function(o,n){o?(cc.error(o),c&&c("Resource "+t+" not exist!")):(i&&e.Cache.AddRef(t,n),s&&!f.hasPool(t)&&f.cachePool(t,f.Allocate(t,n)),r(n))})}}(h||(h={}))}(j=t.resources||(t.resources={}));var H=function(){function t(t,e){this.m_AddTimer=null,this.m_RemoveTimer=null,this.m_Running=!1,this.m_Pause=!1,this.m_Ticks=0,this.m_Func=null,this.m_AddTimer=t,this.m_RemoveTimer=e}return t.Allocate=function(e,o){return new t(e,o)},t.prototype.getTick=function(){return this.m_Ticks},t.prototype.setTick=function(t){this.m_Ticks=t},t.prototype.Tick=function(){this.m_Running&&!this.m_Pause&&(++this.m_Ticks,this.DoFunc(this.m_Ticks))},t.prototype.Register=function(){return this.m_AddTimer(this),this},t.prototype.UnRegister=function(){return this.m_RemoveTimer(this),this},t.prototype.BindCB=function(t){return this.m_Func=t,this},t.prototype.Start=function(){return this.m_Running=!0,this.DoFunc(this.m_Ticks),this},t.prototype.Pause=function(){this.m_Pause=!0},t.prototype.Resume=function(){this.m_Pause=!1},t.prototype.DoFunc=function(t){this.m_Func&&this.m_Func(t)},t}(),x=function(t){function e(){var e=t.call(this)||this;return e.m_Ticks=0,e.m_TickScheduler=null,e.m_SchedulerClockHeap=null,e.m_HeapHead=void 0,e.m_TickFuncList=[],e.m_TimerList=[],e.m_SchedulerClockHeap=new o.Heap(function(t,e){return t.ts-e.ts}),e.m_TickScheduler=function(){return e.Tick()},e.scheduler.schedule(e.m_TickScheduler,1),e}return i(e,t),Object.defineProperty(e.prototype,"timeStamp",{get:function(){return m.getTimeStamp()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Ins",{get:function(){return this._ins||(this._ins=new e),this._ins},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scheduler",{get:function(){return Q.Ins.Scheduler},enumerable:!1,configurable:!0}),e.CreateTimer=function(){var t=this;return H.Allocate(function(e){return t.Ins.AddTimer(e)},function(e){return t.Ins.RemoveTimer(e)})},e.prototype.AddClock=function(t,e,o){void 0===o&&(o=!1),this.m_SchedulerClockHeap.add({t:t,f:e,ts:this.timeStamp+t,tick:this.m_Ticks,repeat:o})},e.prototype.TickClock=function(){this.m_HeapHead=this.m_SchedulerClockHeap.peek(),this.m_HeapHead&&this.m_HeapHead.ts<=this.timeStamp&&(this.m_SchedulerClockHeap.extractRoot(),this.m_HeapHead.f(this.m_Ticks-this.m_HeapHead.tick),this.m_HeapHead.repeat&&this.AddClock(this.m_HeapHead.t,this.m_HeapHead.f,!0))},e.prototype.AddFunction=function(t,e){void 0===e&&(e=0),this.m_TickFuncList.push({func:t,tick:0,count:e})},e.prototype.RemoveFunction=function(t){for(var e=this.m_TickFuncList.length-1;e>=0;--e)if(this.m_TickFuncList[e].func==t)return this.m_TickFuncList.splice(e,1),!0;return!1},e.prototype.TickFunction=function(){for(var t=this.m_TickFuncList.length-1;t>=0;--t){var e=this.m_TickFuncList[t];e.count>0?(e.func(e.tick,e.count),e.tick=e.tick+1,e.count==e.tick&&this.m_TickFuncList.splice(t,1)):(e.func(e.tick),e.tick=e.tick+1)}},e.prototype.AddTimer=function(t){this.m_TimerList.push(t)},e.prototype.RemoveTimer=function(t){for(var e=this.m_TimerList.length-1;e>=0;--e)t==this.m_TimerList[e]&&this.m_TimerList.splice(e,1)},e.prototype.TickTimer=function(){for(var t=this.m_TimerList.length-1;t>=0;--t)this.m_TimerList[t].Tick()},e.prototype.release=function(){this.scheduler.unschedule(this.m_TickScheduler),this.m_TickScheduler=null,t.prototype.release.call(this)},e.prototype.Tick=function(){this.m_Ticks=this.m_Ticks+1,this.TickFunction(),this.TickTimer(),this.TickClock()},e._ins=null,e}(G);t.SchedulerMgr=x;var W=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t._mid_=0,t._notifyRefCnt_=0,t._dirty_=!1,t._eListenersLinedListMap_=new Map,t.m_BindableList=[],t.m_StopCallLinkedList=o.DLink.Allocate(),t}return i(n,e),n.prototype.notify=function(t){for(var e=this,o=[],n=1;n<arguments.length;n++)o[n-1]=arguments[n];if(++this._notifyRefCnt_,this._eListenersLinedListMap_.has(t)){var i=this._eListenersLinedListMap_.get(t);i.For(function(t){t.active&&(t.once&&(t.active=!1,e._dirty_=!0),t.handler.apply(t.target,o))})}--this._notifyRefCnt_,this.cleanDirty()},n.prototype.cleanDirty=function(){this._dirty_&&0===this._notifyRefCnt_&&(this._eListenersLinedListMap_.forEach(function(t){return t.removeByFind(function(t){return!t.active},function(t){return t.release()})}),this._dirty_=!1)},n.prototype.once=function(t,e,o){return this._on(t,e,o,!0)},n.prototype.on=function(t,e,o){return this._on(t,e,o,!1)},n.prototype._on=function(t,e,n,i){++this._mid_;var r=z.Allocate(t,e,n,i,this._mid_);this._eListenersLinedListMap_.has(t)||this._eListenersLinedListMap_.set(t,o.DLink.Allocate()),this._eListenersLinedListMap_.get(t).enqueue(r)},n.prototype.off=function(t){var e=this;if(this._eListenersLinedListMap_.has(t)){var o=this._eListenersLinedListMap_.get(t);this._notifyRefCnt_>0?o.For(function(t){t.active=!1,e._dirty_=!0}):(o.release(function(t){return t.release()}),this._eListenersLinedListMap_.delete(t))}},n.prototype.targetOff=function(t){var e=this;this._notifyRefCnt_>0?this._eListenersLinedListMap_.forEach(function(o){o.For(function(o){o.target===t&&o.active&&(o.active=!1,e._dirty_=!0)})}):this._eListenersLinedListMap_.forEach(function(e){return e.removeByFind(function(e){return e.target===t},function(t){return t.release()})})},n.prototype.offAll=function(){var t=this;this._eListenersLinedListMap_.forEach(function(e,o){e.release(function(t){return t.release()}),t._eListenersLinedListMap_.delete(o)}),this._dirty_=!1},n.prototype.notifyGlobal=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return F.notify.apply(F,s([t],e))},n.prototype.onceGlobal=function(t,e){return F.once(t,e,this)},n.prototype.onGlobal=function(t,e){return F.on(t,e,this)},n.prototype.offGlobal=function(t){return F.off(t)},n.prototype.targetOffGlobal=function(){return F.targetOff(this)},n.prototype.notifyGlobalShowUI=function(t,e){void 0===e&&(e=null),this.notifyGlobal("_GF_SHOW_UI_",t,e)},n.prototype.onGlobalShowUI=function(t){this.onGlobal("_GF_SHOW_UI_",t)},n.prototype.bindCallback=function(t,e,o){t.bind(e,o,this),this.m_BindableList.push(t)},n.prototype.unbindAll=function(){for(;this.m_BindableList.length>0;)this.m_BindableList.pop().targetUnbind(this)},n.prototype.AddStopActionCall=function(t){this.m_StopCallLinkedList.enqueue(t)},n.prototype.RemoveStopCall=function(t){this.m_StopCallLinkedList.removeElement(t)},n.prototype.StopAllAction=function(){var t=this;this.m_StopCallLinkedList.removeAll(function(e){return e(t)}),this.node.stopAllActions()},n.prototype.InterrupteAction=function(){this.m_StopCallLinkedList.size()>0&&(this.m_StopCallLinkedList.removeAll(),this.node.stopAllActions())},n.prototype.release=function(){this.targetOffGlobal(),this.unbindAll(),this.offAll(),this.InterrupteAction()},n.prototype.onDestroy=function(){this.release(),this.m_StopCallLinkedList.release(),this.m_StopCallLinkedList=null,console.warn(">> "+this.name+".View:onDestroy")},n.prototype.ResizeToFullScreen=function(t){t.width=cc.winSize.width,t.height=cc.winSize.height},n.prototype.Test=function(e){this.onGlobal(t.events.EVENT_TEST,e)},r([p],n)}(cc.Component);t.View=W;var K=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.vm=null,e._inUse_=!1,e._prefabKey_=null,e._init_=!1,e.m_isEntered=!1,e.m_ExitLock=!1,e.m_OnExitParent=null,e.m_OnReleaseParent=null,e.m_AutoReleaseOnExit=o.DLink.Allocate(),e.m_AutoReleaseOnRelease=o.DLink.Allocate(),e}return i(e,t),e.prototype.onLoad=function(){if(!this._init_)throw"[Error] ReusableView \u5fc5\u987b\u901a\u8fc7 Allocate \u65b9\u6cd5\u521b\u5efa! "+this.name},e.prototype.onDestroy=function(){console.warn(">> "+this.name+".ReusableView:onDestroy"),this.Release(),t.prototype.onDestroy.call(this),j.Cache.DecRef(this._prefabKey_),this.vm=null},e.AutoReleaseAllocate=function(t,e,o){var n=this.Allocate(e,o);return t.AutoRelease(n),n},e.Allocate=function(t,o){null==f.pool(t)&&console.warn(t,null==f.pool(t));var n=f.pool(t).get().getComponent(e);return n._prefabKey_=t,n._inUse_=!0,null!==o&&(n.vm=o),n._init_||(j.Cache.AddRef(t,f.pool(t).prefab),n._init_=!0,n.OnCreate()),n.OnAllocate(),n},e.prototype.Release=function(){if(this._inUse_){for(this._inUse_=!1,this.Exit(),null!=this.m_OnReleaseParent&&(this.m_OnReleaseParent.RemoveViewByRelease(this),this.m_OnReleaseParent=null);this.m_AutoReleaseOnRelease.size()>0;)this.m_AutoReleaseOnRelease.top.Release();this.release(),f.pool(this._prefabKey_).put(this.node)}},e.prototype.ReleaseWithAction=function(t,e,o,n){var i=this;void 0===o&&(o=.2),d.Out(t,o,e,function(){n&&n(),i.Release()})},e.prototype.Enter=function(t,e){this.m_isEntered||(this.m_isEntered=!0,null!=t&&(this.vm=t),this.OnEnter(e))},e.prototype.Exit=function(){if(this.m_isEntered&&!this.m_ExitLock){for(this.m_ExitLock=!0,this.OnExit(),null!=this.m_OnExitParent&&(this.m_OnExitParent.RemoveViewByExit(this),this.m_OnExitParent=null);this.m_AutoReleaseOnExit.size()>0;)this.m_AutoReleaseOnExit.top.Release();this.m_ExitLock=!1,this.m_isEntered=!1}},e.prototype.AutoRelease=function(t){return this.m_isEntered?(this.m_AutoReleaseOnExit.push(t),t.m_OnExitParent=this):(this.m_AutoReleaseOnRelease.push(t),t.m_OnReleaseParent=this),t},e.prototype.RemoveViewByRelease=function(t){this.m_AutoReleaseOnRelease.removeElement(t)},e.prototype.RemoveViewByExit=function(t){this.m_AutoReleaseOnExit.removeElement(t)},e.RegisterViewDependents=function(t,e){j.ResDependent.RegisterViewDependents(t,e)},e}(W);t.ReusableView=K;var Z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.registerScene=function(t,e){e&&this.s_sceneName2LoadResFuncMap.set(t,e)},e.addAutoReleaseRes=function(t){this.s_AutoReleaseResStack.push(t)},e.loadScene=function(t,e,o){var n=this,i=j.ResList.Allocate();this.s_sceneName2LoadResFuncMap.has(t)&&this.s_sceneName2LoadResFuncMap.get(t)(i),j.LoadRef(i,function(i){o&&o(),cc.director.loadScene(t,function(){n.s_AutoReleaseResStack.removeAll(function(t){return j.ReleaseRef(t,function(t){return t.release()})}),n.addAutoReleaseRes(i),e&&e()})})},e.LoadView=function(t,e){var o=this;if(j.Cache.hasRes(t))e();else{var n=j.ResList.Allocate();n.AddView(t),j.LoadRef(n,function(t){o.addAutoReleaseRes(t),e()})}},e.s_sceneName2LoadResFuncMap=new Map,e.s_AutoReleaseResStack=o.DLink.Allocate(),e}(W);t.Scene=Z;var q=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_Reference=null,t.m_IsShow=!1,t}var n;return i(o,e),o.prototype.Init=function(){var t=this;this.node.active=!1,this.m_Reference=o.LoadingRef,this.bindCallback(this.m_Reference,function(e){0==e?t.m_IsShow&&(t.m_IsShow=!1,t.HideByRef()):t.m_IsShow||(t.m_IsShow=!0,t.ShowByRef()),t.UpdateReference()},!0)},o.prototype.UpdateReference=function(){this.RefreshByRef(this.m_Reference.MaxReference-this.m_Reference.value,this.m_Reference.MaxReference)},o.LoadingRef=(n=new E(0),F.on(t.events.ADD_LOADING_REF,function(){return n.AddReference()},n),F.on(t.events.DEC_LOADING_REF,function(){return n.RemoveReference()},n),n),o}(W);t.BaseLockView=q;var J,Y,Q=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_LoadingCirclePrefab=null,t.m_UIMessagePrefab=null,t.m_UIOKPrefab=null,t.m_UIDialogPrefab=null,t.SimulatorADPrefab=null,t}return i(o,e),Object.defineProperty(o,"Ins",{get:function(){return this._ins_},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"Scheduler",{get:function(){return this},enumerable:!1,configurable:!0}),o.prototype.AddNode=function(t){this.node.addChild(t)},o.prototype.onLoad=function(){var e=this;if(console.info(">> Application::onLoad"),o._ins_=this,cc.debug.setDisplayStats(!1),cc.game.setFrameRate(60),cc.game.addPersistRootNode(this.node),this.node.zIndex=9999,this.onGlobalShowUI(function(t,e){o.LoadToShowPrefabUI(t,e)}),this.node.x=cc.winSize.width/2,this.node.y=cc.winSize.height/2,this.node.width=cc.winSize.width,this.node.height=cc.winSize.height,cc.game.on(cc.game.EVENT_SHOW,function(){return e.notifyGlobal(t.events.EVENT_SHOW)},this),cc.game.on(cc.game.EVENT_HIDE,function(){return e.notifyGlobal(t.events.EVENT_HIDE)},this),f.cachePool("UIMessage",f.Allocate("UIMessage",this.m_UIMessagePrefab)),f.cachePool("UIOK",f.Allocate("UIOK",this.m_UIOKPrefab)),f.cachePool("UIDialog",f.Allocate("UIDialog",this.m_UIDialogPrefab)),this.m_LoadingCirclePrefab){var n=cc.instantiate(this.m_LoadingCirclePrefab);this.AddNode(n),n.zIndex=9999,n.setSiblingIndex(9999)}this.InitKeyEvents()},o.prototype.start=function(){var t=j.ResList.Allocate();this.getPersistResources(t),j.LoadRef(t,function(t){t.release(),Z.loadScene("SplashScene")})},o.prototype.onDestroy=function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this),e.prototype.onDestroy.call(this)},o.prototype.InitKeyEvents=function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this)},o.prototype.onKeyUp=function(e){e.keyCode==cc.macro.KEY.t&&this.notifyGlobal(t.events.EVENT_TEST)},o.LoadToShowPrefabUI=function(t,e){var o=this;Z.LoadView(t,function(){return o.ShowPrefabUI(t,e)})},o.ShowPrefabUI=function(t,e){var o=K.Allocate(t,e);this.Ins.AddNode(o.node),o.Enter()},o.ShowMessage=function(t){this.LoadToShowPrefabUI("UIMessage",t)},o.ShowUIOK=function(t,e){this.LoadToShowPrefabUI("UIOK",{msg:t,click:e})},o.ShowUIDialog=function(t,e,o){this.LoadToShowPrefabUI("UIDialog",{msg:t,confirm:e,cancel:o})},o._ins_=null,r([h(cc.Prefab)],o.prototype,"m_LoadingCirclePrefab",void 0),r([h(cc.Prefab)],o.prototype,"m_UIMessagePrefab",void 0),r([h(cc.Prefab)],o.prototype,"m_UIOKPrefab",void 0),r([h(cc.Prefab)],o.prototype,"m_UIDialogPrefab",void 0),r([h(cc.Prefab)],o.prototype,"SimulatorADPrefab",void 0),o}(Z);t.Application=Q,function(t){var e=function(){function t(){}return t.Allocate=function(){return this.s_pool.get()},t.prototype.release=function(){t.s_pool.put(this)},t.s_pool=u.getOrCreatePool("AudioEffectObject",function(){return new t},0),t}(),n=function(t){function n(){var e=t.call(this)||this;return e.DEFAULT_EFFECT="Base/Audio/default_effect",e.DEFAULT_MUSIC="Base/Audio/default_music",e.m_EffectLinkedList=o.DLink.Allocate(),e.EffectOffLS=new T(!1,"bAudioEnginEffectMute"),e.MusicMuteLS=new T(!1,"bAudioEnginMusicMute"),e.m_LastMusickAudioKey=null,e.m_CurMusicId=-1,e}return i(n,t),Object.defineProperty(n,"Ins",{get:function(){return this._instance||(this._instance=new n),this._instance},enumerable:!1,configurable:!0}),n.prototype.AddEffectItem=function(t,o,n){var i=e.Allocate();i.key=t,i.id=o,this.m_EffectLinkedList.push(i),j.Cache.AddRef(t,n)},n.prototype.RemoveEffectItem=function(t){j.Cache.DecRef(t.key),t.release()},Object.defineProperty(n.prototype,"effectMute",{get:function(){return this.EffectOffLS.value},set:function(t){this.EffectOffLS.value!==t&&(this.EffectOffLS.value=t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"effectVolume",{get:function(){return cc.audioEngine.getEffectsVolume()},set:function(t){t>=0&&t<=1&&cc.audioEngine.setEffectsVolume(t)},enumerable:!1,configurable:!0}),n.prototype.playDefaultEffect=function(){return this.playEffect(this.DEFAULT_EFFECT)},n.prototype.playEffect=function(t,e){var o=this;void 0===e&&(e=!1),t&&!this.effectMute&&j.LoadAudio(t,function(n){var i=cc.audioEngine.playEffect(n,e);cc.audioEngine.setVolume(i,o.effectVolume),o.AddEffectItem(t,i,n),o.__updateEffectStatus()})},n.prototype.stopEffect=function(t){var e=this;this.m_EffectLinkedList.removeByFind(function(e){return cc.audioEngine.getState(e.id)==cc.audioEngine.AudioState.STOPPED||e.key===t&&(cc.audioEngine.stopEffect(e.id),!0)},function(t){return e.RemoveEffectItem(t)})},n.prototype.stopAllEffect=function(){var t=this;cc.audioEngine.stopAllEffects(),this.m_EffectLinkedList.removeAll(function(e){return t.RemoveEffectItem(e)})},n.prototype.__updateEffectStatus=function(){var t=this;this.m_EffectLinkedList.removeByFind(function(t){return cc.audioEngine.getState(t.id)==cc.audioEngine.AudioState.STOPPED},function(e){return t.RemoveEffectItem(e)})},n.prototype.playLastMusic=function(){this.playMusic(this.m_LastMusickAudioKey,!0)},Object.defineProperty(n.prototype,"musicMute",{get:function(){return this.MusicMuteLS.value},set:function(t){this.MusicMuteLS.value!==t&&(this.MusicMuteLS.value=t,t?this.stopMusic():this.playLastMusic())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"musicVolume",{get:function(){return cc.audioEngine.getMusicVolume()},set:function(t){t>=0&&t<=1&&cc.audioEngine.setMusicVolume(t)},enumerable:!1,configurable:!0}),n.prototype.playDefaultMusic=function(){return this.playMusic(this.DEFAULT_MUSIC,!0)},n.prototype.playMusic=function(t,e){var o=this;if(void 0===e&&(e=!0),console.log("PlayMusic: "+t),this.musicMute)return console.assert(-1==this.m_CurMusicId),void(this.m_LastMusickAudioKey=t);-1!=this.m_CurMusicId&&this.stopMusic(),j.LoadAudio(t,function(n){-1==o.m_CurMusicId&&(o.stopMusic(),o.m_LastMusickAudioKey=t,o.m_CurMusicId=cc.audioEngine.playMusic(n,e),cc.audioEngine.setVolume(o.m_CurMusicId,o.musicVolume))})},n.prototype.pauseMusic=function(){cc.audioEngine.pauseMusic()},n.prototype.resumeMusic=function(){cc.audioEngine.resumeMusic()},n.prototype.stopMusic=function(){this.m_CurMusicId>=0&&(cc.audioEngine.stop(this.m_CurMusicId),this.m_CurMusicId=-1)},n.prototype.isMusicPlaying=function(){return cc.audioEngine.isMusicPlaying()},n._instance=null,n}(G);t.AudioEngine=n}(J||(J={})),function(e){var o;window._G_EventHandler=function(t,e){n.Platform.OnBridgeEvent(t,JSON.parse(e))},function(t){t[t.None=0]="None",t[t.WiFi=1]="WiFi",t[t.WWAN=2]="WWAN"}(o||(o={}));var n=function(){function t(){}return Object.defineProperty(t,"Platform",{get:function(){return this.m_p||(cc.sys.isNative&&cc.sys.os==cc.sys.OS_IOS?this.m_p=new c:(cc.sys.isNative&&(cc.sys.os,cc.sys.OS_ANDROID),this.m_p=new a),this.m_p.InitPlatform()),this.m_p},enumerable:!1,configurable:!0}),t.m_p=null,t}();e.adapter=n;var r=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.NetWork=new C(o.None),t.m_Vibrate=null,t.m_IsHairScreen=!1,t}return i(n,e),n.prototype.InitPlatform=function(){var e=this;this.NetWork.value=this.deviceNetworkType,this.m_IsHairScreen=this.__isHairScreen(),this.onGlobal(t.events.OPEN_APP_STORE,function(){return cc.sys.openURL(e.getAppStoreUrl())}),this.OnInitPlatform()},Object.defineProperty(n.prototype,"deviceNetworkType",{get:function(){return this.getNetWorkTypeByBridge()},set:function(t){this.NetWork.value!==t&&(this.NetWork.value=t)},enumerable:!1,configurable:!0}),n.prototype.IsNetworkAvailable=function(){return this.NetWork.value!=o.None},Object.defineProperty(n.prototype,"Vibrate",{get:function(){return this.m_Vibrate||(this.m_Vibrate=this.CreateVibrate()),this.m_Vibrate},enumerable:!1,configurable:!0}),n.prototype.IsHairScreen=function(){return this.m_IsHairScreen},n.prototype.OnBridgeEvent=function(t,e){this.notify(t,e)},n}(G),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getNetWorkTypeByBridge=function(){return jsb.reflection.callStaticMethod("NMReachability","getNetworkType")},e.prototype.CreateVibrate=function(){return new l},e.prototype.OnInitPlatform=function(){this.on("NMEventReachability",this.HandleReachabilityEvent,this)},e.prototype.HandleReachabilityEvent=function(t){switch(t.event){case"StatusChanged":this.deviceNetworkType=t.status}},e.prototype.__isHairScreen=function(){return jsb.reflection.callStaticMethod("NMUtilities","isHairScreen")},e.prototype.getAppStoreUrl=function(){return"https://apps.apple.com/app/id"+p.Ins.apple_id},e}(r),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.OnInitPlatform=function(){},e.prototype.getNetWorkTypeByBridge=function(){return window.navigator.onLine?o.WWAN:o.None},e.prototype.CreateVibrate=function(){return new u},e.prototype.__isHairScreen=function(){return!1},e.prototype.getAppStoreUrl=function(){return"https://numas.ltd"},e}(r),s=function(){this.EffectOff=new T(!1,"bVibrateOff")},l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.vibrateNormal=function(){this.__bridgeVibrate("NORMAL")},e.prototype.vibratePeek=function(){this.__bridgeVibrate("PEEK")},e.prototype.vibratePop=function(){this.__bridgeVibrate("POP")},e.prototype.vibrateContinue=function(){this.__bridgeVibrate("CONTINUE")},e.prototype.__bridgeVibrate=function(t){this.EffectOff.value||jsb.reflection.callStaticMethod("NMVibrate","vibrate:",t)},e.prototype.tap_notification=function(t){void 0===t&&(t=2),this.EffectOff.value||jsb.reflection.callStaticMethod("NMVibrate","tap_notification:",t)},e.prototype.tap_selection=function(){this.EffectOff.value||jsb.reflection.callStaticMethod("NMVibrate","tap_selection")},e.prototype.tap_impact=function(t){void 0===t&&(t=4),this.EffectOff.value||jsb.reflection.callStaticMethod("NMVibrate","tap_impact:",t)},e.prototype.isSupportTapEngine=function(){return jsb.reflection.callStaticMethod("NMVibrate","isSupportTapEngine")},e}(s),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.vibrateNormal=function(){},e.prototype.vibratePeek=function(){},e.prototype.vibratePop=function(){},e.prototype.vibrateContinue=function(){},e.prototype.tap_notification=function(t){void 0===t&&(t=2)},e.prototype.tap_selection=function(){},e.prototype.tap_impact=function(){},e.prototype.isSupportTapEngine=function(){return!1},e}(s),p=function(){function t(){this.m_NMConfig=null}return Object.defineProperty(t,"Ins",{get:function(){return this._ins||(this._ins=new t),this._ins},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"NMConfig",{get:function(){if(!this.m_NMConfig){var t=jsb.reflection.callStaticMethod("NMConfig","jsonConfig");this.m_NMConfig=JSON.parse(t)}return this.m_NMConfig},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apple_id",{get:function(){return this.m_NMConfig.apple_id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bundle_id",{get:function(){return this.m_NMConfig.bundle_id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"iap",{get:function(){return this.m_NMConfig.iap},enumerable:!1,configurable:!0}),t._ins=null,t}()}(Y||(Y={})),t.platform=Y.adapter.Platform,t.audio=J.AudioEngine.Ins})(o.gf||(o.gf={})),cc._RF.pop()},{"./StateMachine":"StateMachine"}],iOSADSDK:[function(t,e,o){"use strict";cc._RF.push(e,"36c93pzGjRO+4FfqsvH+RHn","iOSADSDK");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var r=t("../Base/BaseAD"),c=t("../SDKEnum"),a=t("../../core"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_LoadInterstitialCallback=null,e.m_ShowInterstitialCallback=null,e.m_ShowRewardedVideoCallback=null,e}return i(e,t),e.prototype.ADVersion=function(){return jsb.reflection.callStaticMethod("NMProxyAD","sdkVersion")},e.prototype.ShowBanner=function(t){if(t){if(this.IsADsRemoved())return;jsb.reflection.callStaticMethod("NMProxyAD","ShowBanner")}else jsb.reflection.callStaticMethod("NMProxyAD","HideBanner")},e.prototype.DestroyBanner=function(){jsb.reflection.callStaticMethod("NMProxyAD","DestroyBanner")},e.prototype.IsInterstitialAvailable=function(){return jsb.reflection.callStaticMethod("NMProxyAD","IsInterstitialAvailable")},e.prototype.LoadInterstitial=function(t){this.IsADsRemoved()?t&&t(c.EInterstitial.AD_REMOVED):this.isLoadingBV.value?t&&t(c.EInterstitial.LOADING):this.IsInterstitialAvailable()?t&&t(c.EInterstitial.LOADED):(this.m_LoadInterstitialCallback=t,this.isLoadingBV.value=!0,jsb.reflection.callStaticMethod("NMProxyAD","LoadInterstitial"))},e.prototype.ShowInterstitial=function(t){this.IsADsRemoved()?t&&t(c.EInterstitial.AD_REMOVED):this.IsInterstitialAvailable()?(this.m_ShowInterstitialCallback=t,jsb.reflection.callStaticMethod("NMProxyAD","ShowInterstitial")):t(c.EInterstitial.NOT_AVAILABLE)},e.prototype.IsRewardedVideoAvailable=function(){return jsb.reflection.callStaticMethod("NMProxyAD","IsRewardedVideoAvailable")},e.prototype.ShowRewardedVideo=function(t){this.IsRewardedVideoAvailable()?(this.m_ShowRewardedVideoCallback=t,jsb.reflection.callStaticMethod("NMProxyAD","ShowRewardedVideo")):t(c.ERewardedVideo.NOT_AVAILABLE)},e.prototype.OnInit=function(){var e=this;t.prototype.OnInit.call(this),a.gf.platform.on("NMEventAD",function(t){return e.iOSADCallbackHandler(t)},this),jsb.reflection.callStaticMethod("NMProxyAD","initByScript"),this.LoadInterstitial(function(t){console.log("EInterstitial."+c.EInterstitial[t])})},e.prototype.OnDestroy=function(){a.gf.platform.targetOff(this),t.prototype.OnDestroy.call(this)},e.prototype.LoadInterstitialCallback=function(t){this.m_LoadInterstitialCallback&&this.m_LoadInterstitialCallback(t)},e.prototype.ShowInterstitialCallback=function(t){this.m_ShowInterstitialCallback&&this.m_ShowInterstitialCallback(t)},e.prototype.ShowRewardedVideoCallback=function(t,e){this.m_ShowRewardedVideoCallback&&this.m_ShowRewardedVideoCallback(t,e)},e.prototype.iOSADCallbackHandler=function(t){switch(t.type){case"RewardedVideo":this.HandleRewardedVideo(t);break;case"Interstitial":this.HandleInterstitial(t);break;case"Banner":this.HandleBanner(t)}},e.prototype.HandleBanner=function(t){t.event},e.prototype.HandleInterstitial=function(t){switch(console.log("Interstitial >> "+JSON.stringify(t)),t.event){case"LOADED":this.isInterstitialAvailableBV.value=this.IsInterstitialAvailable(),this.isLoadingBV.value=!1,this.LoadInterstitialCallback(c.EInterstitial.LOADED);break;case"LOAD_ERROR":this.isInterstitialAvailableBV.value=this.IsInterstitialAvailable(),this.isLoadingBV.value=!1,this.LoadInterstitialCallback(c.EInterstitial.LOAD_ERROR);break;case"SHOW":this.ShowInterstitialCallback(c.EInterstitial.SHOW);break;case"SHOW_ERROR":this.isInterstitialAvailableBV.value=this.IsInterstitialAvailable(),this.ShowInterstitialCallback(c.EInterstitial.SHOW_ERROR);break;case"CLICK":this.ShowInterstitialCallback(c.EInterstitial.CLICK);break;case"CLOSE":this.isInterstitialAvailableBV.value=this.IsInterstitialAvailable(),this.ShowInterstitialCallback(c.EInterstitial.HIDE),this.m_AutoLoadInterstitial&&this.LoadInterstitial(null);break;default:this.ShowInterstitialCallback(c.EInterstitial.NOT_AVAILABLE)}},e.prototype.HandleRewardedVideo=function(t){switch(t.event){case"AVAILABLE_STATUS_CHANGED":this.isRewardedVideoAvailableBV.value=t.available,this.ShowRewardedVideoCallback(c.ERewardedVideo.AVAILABLE_STATUS_CHANGED,t.available);break;case"SHOW":this.ShowRewardedVideoCallback(c.ERewardedVideo.SHOW,t.rewarded);break;case"SHOW_ERROR":this.ShowRewardedVideoCallback(c.ERewardedVideo.SHOW_ERROR,t.rewarded);break;case"CLICK":this.ShowRewardedVideoCallback(c.ERewardedVideo.CLICK,t.rewarded);break;case"REWARDED":this.ShowRewardedVideoCallback(c.ERewardedVideo.REWARDED,t.rewarded);break;case"CLOSE":this.ShowRewardedVideoCallback(c.ERewardedVideo.HIDE,t.rewarded);break;default:this.ShowRewardedVideoCallback(c.ERewardedVideo.NOT_AVAILABLE,t.rewarded)}},e}(r.default);o.default=s,cc._RF.pop()},{"../../core":"core","../Base/BaseAD":"BaseAD","../SDKEnum":"SDKEnum"}],iOSGameCenter:[function(t,e,o){"use strict";cc._RF.push(e,"004d72y3QJJdrmKJLG06wwH","iOSGameCenter");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.IsAuthenticated=function(){return jsb.reflection.callStaticMethod("NMProxyUser","IsAuthenticated")},e.prototype.Login=function(){jsb.reflection.callStaticMethod("NMProxyUser","Login")},e.prototype.Show=function(){jsb.reflection.callStaticMethod("NMProxyUser","Show")},e.prototype.ShowLeaderboards=function(t,e){jsb.reflection.callStaticMethod("NMProxyUser","ShowLeaderboards:timeScope:",t,e)},e.prototype.ShowAchievement=function(){jsb.reflection.callStaticMethod("NMProxyUser","ShowAchievement")},e.prototype.ReportScore=function(t,e){jsb.reflection.callStaticMethod("NMProxyUser","ReportScore:withScore:",t,e)},e.prototype.ReportAchievement=function(t,e){jsb.reflection.callStaticMethod("NMProxyUser","ReportAchievement:percentComplete:",t,e)},e.prototype.FiveStar=function(){jsb.reflection.callStaticMethod("NMProxyUser","FiveStar")},e.prototype.RateUsByOpenUrl=function(){jsb.reflection.callStaticMethod("NMProxyUser","RateUsByOpenUrl")},e.prototype.RateUsWithinApp=function(){jsb.reflection.callStaticMethod("NMProxyUser","RateUsWithinApp")},e}(t("../Base/BaseGameCenter").default);o.default=r,cc._RF.pop()},{"../Base/BaseGameCenter":"BaseGameCenter"}],iOSIAP:[function(t,e,o){"use strict";cc._RF.push(e,"da9e0DPYwFJH7/6mZRfTLb+","iOSIAP");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../core"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.IsAuthorizedForPayments=function(){return jsb.reflection.callStaticMethod("NMProxyIAP","isAuthorizedForPayments")},e.prototype.Restore=function(){return this.IsRestored()?(console.log("iOSIAP >>>> \u5df2\u7ecf\u6062\u590d\u8d2d\u4e70"),void r.gf.Application.ShowUIOK("Already Restored!")):this.IsAuthorizedForPayments()?(this.notifyGlobal(r.gf.events.ADD_LOADING_REF),void jsb.reflection.callStaticMethod("NMProxyIAP","restore")):(console.log("iOSIAP >>>> \u5f53\u524d\u65e0\u6cd5\u6062\u590d\u8d2d\u4e70 isAuthorizedForPayments: false"),void r.gf.Application.ShowUIOK("Restore is currently not available."))},e.prototype.Purchase=function(t){return this.IsPurchased(t)?(console.log("iOSIAP >>>> AlreadyPurchased "+t),void r.gf.Application.ShowUIOK("Already Purchased!")):this.IsAuthorizedForPayments()?(this.notifyGlobal(r.gf.events.ADD_LOADING_REF),void jsb.reflection.callStaticMethod("NMProxyIAP","purchase:",t)):(console.log("iOSIAP >>>> \u5f53\u524d\u65e0\u6cd5\u8d2d\u4e70 isAuthorizedForPayments: false"),void r.gf.Application.ShowUIOK("Purchase is currently not available."))},e.prototype.OnInit=function(){var e=this;t.prototype.OnInit.call(this),r.gf.platform.on("NMEventIAP",function(t){return e.iOSADCallbackHandler(t)},this),jsb.reflection.callStaticMethod("NMProxyIAP","initByScript")},e.prototype.OnDestroy=function(){r.gf.platform.targetOff(this),t.prototype.OnDestroy.call(this)},e.prototype.iOSADCallbackHandler=function(t){switch(console.log("iOSIAP >>>> iOSADCallbackHandler "+JSON.stringify(t)),t.type){case"Purchase":this.HandleEventTypePurchase(t);break;case"Restore":this.HandleEventTypeRestore(t)}},e.prototype.HandleEventTypePurchase=function(t){switch(t.event){case"Failed":this.notifyGlobal(r.gf.events.DEC_LOADING_REF),r.gf.Application.ShowUIOK(t.error);break;case"Success":this.notifyGlobal(r.gf.events.DEC_LOADING_REF),this.SavePurchase(t.productKey,t.productConfig)}},e.prototype.HandleEventTypeRestore=function(t){switch(t.event){case"Cancelled":this.notifyGlobal(r.gf.events.DEC_LOADING_REF);break;case"Failed":this.notifyGlobal(r.gf.events.DEC_LOADING_REF),r.gf.Application.ShowUIOK(t.error);break;case"Purchase":this.SavePurchaseFromRestore(t.productKey,t.productConfig);break;case"Completed":this.notifyGlobal(r.gf.events.DEC_LOADING_REF),this.SaveRestore(),r.gf.Application.ShowUIOK("Restore purchases completed.")}},e}(t("../Base/BaseIAP").default);o.default=c,cc._RF.pop()},{"../../core":"core","../Base/BaseIAP":"BaseIAP"}]},{},["AppConfig","AudioConfig","GameSceneConfig","PrefabConfig","UIContinue","UIGameOver","UINewRecord","UIPause","UIRate","BaseUIPop","BlockPuzzle99","BlockPuzzle99DataConfig","BlockPuzzle99Scene","UIBP99Block","UIBP99BoardManager","UIBP99BoardTile","UIBP99Continue","UIBP99DockItem","UIBP99DockManager","UIBP99DockTile","UIBP99GameOver","UIBP99Goal","UIBP99LoseTile","UIBP99ScoreEffect","UIBP99ShadowTile","UIBP99TipTile","UIBP99Win","BlockPuzzle","BlockPuzzleDataConfig","BlockPuzzleScene","UIBlock","UIBoardManager","UIBoardTile","UIDockItem","UIDockManager","UIDockTile","UIScoreEffect","UIShadowTile","UITipTile","MenuItem","MenuScene","NumberPuzzleContent","NumberPuzzleContentItem","NumberPuzzle","NumberPuzzleScene","UINP321Go","UINPBlock","UINPDialog","UINPWin","SplashScene","WoodBlockAd","GameCenterRankService","UIService","ADService","AdapterCanvas","ClickOrDrag","CountDownSprite","ResizeToFullScreen","EntryPoint","UILoadingCircle","BaseAD","BaseChannel","BaseGameCenter","BaseIAP","BaseSDK","DefaultChannel","IAD","IIAP","ISDKLifeCycle","IUser","DevADBanner","DevADBase","DevADInterstitial","DevADRewardedVideo","DevADSDK","DevGameCenter","DevIAP","iOSADSDK","iOSGameCenter","iOSIAP","SDKConfig","SDKEnum","SDKMgr","SDKTypeDefine","SimulatorAD","StateMachine","UIDialog","UIMessage","UIOK","core"]);